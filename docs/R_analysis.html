<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Введение в анализ данных в R | Статистика для анализа данных</title>
  <meta name="description" content="Семинарские занятия по статистике для анализа данных" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Введение в анализ данных в R | Статистика для анализа данных" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Семинарские занятия по статистике для анализа данных" />
  <meta name="github-repo" content="elenary/StatsForDA" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Введение в анализ данных в R | Статистика для анализа данных" />
  
  <meta name="twitter:description" content="Семинарские занятия по статистике для анализа данных" />
  

<meta name="author" content="Елена Рыбина" />


<meta name="date" content="2023-03-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stats_criteria_categ.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Статистика для анализа данных</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Статистика и ее место в жизни</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#вероятности-формулировки-и-выводы"><i class="fa fa-check"></i><b>1.1</b> Вероятности, формулировки и выводы</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#определение-статистики"><i class="fa fa-check"></i><b>1.2</b> Определение статистики</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#применение-статистики"><i class="fa fa-check"></i><b>1.2.1</b> Применение статистики</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#виды-статистики"><i class="fa fa-check"></i><b>1.3</b> Виды статистики</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sample.html"><a href="sample.html"><i class="fa fa-check"></i><b>2</b> Выборка</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sample.html"><a href="sample.html#выборочные-оценки"><i class="fa fa-check"></i><b>2.1</b> Выборочные оценки</a></li>
<li class="chapter" data-level="2.2" data-path="sample.html"><a href="sample.html#репрезентативность-выборки"><i class="fa fa-check"></i><b>2.2</b> Репрезентативность выборки</a></li>
<li class="chapter" data-level="2.3" data-path="sample.html"><a href="sample.html#dependent_samples"><i class="fa fa-check"></i><b>2.3</b> Зависимые и независимые выборки</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scales.html"><a href="scales.html"><i class="fa fa-check"></i><b>3</b> Данные и типы шкал</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scales.html"><a href="scales.html#измерение-и-переменная"><i class="fa fa-check"></i><b>3.1</b> Измерение и переменная</a></li>
<li class="chapter" data-level="3.2" data-path="scales.html"><a href="scales.html#количественные-и-неколичественные-данные"><i class="fa fa-check"></i><b>3.2</b> Количественные и неколичественные данные</a></li>
<li class="chapter" data-level="3.3" data-path="scales.html"><a href="scales.html#типы-шкал"><i class="fa fa-check"></i><b>3.3</b> Типы шкал</a></li>
<li class="chapter" data-level="3.4" data-path="scales.html"><a href="scales.html#непрерывные-и-дискретные-данные"><i class="fa fa-check"></i><b>3.4</b> Непрерывные и дискретные данные</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Вероятность и случайные величины</a>
<ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#random-variable"><i class="fa fa-check"></i><b>4.1</b> Случайная величина</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#вероятность"><i class="fa fa-check"></i><b>4.2</b> Вероятность</a></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#дискретные-св-и-статистическое-определение-вероятности"><i class="fa fa-check"></i><b>4.3</b> Дискретные СВ и статистическое определение вероятности</a></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#столбчатая-диаграмма"><i class="fa fa-check"></i><b>4.4</b> Столбчатая диаграмма</a></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#непрерывные-св-и-геометрическое-определение-вероятности"><i class="fa fa-check"></i><b>4.5</b> Непрерывные СВ и геометрическое определение вероятности</a></li>
<li class="chapter" data-level="4.6" data-path="probability.html"><a href="probability.html#график-плотности-вероятности-и-гистограмма"><i class="fa fa-check"></i><b>4.6</b> График плотности вероятности и гистограмма</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>5</b> Распределения</a>
<ul>
<li class="chapter" data-level="5.1" data-path="distributions.html"><a href="distributions.html#виды-распределений"><i class="fa fa-check"></i><b>5.1</b> Виды распределений</a></li>
<li class="chapter" data-level="5.2" data-path="distributions.html"><a href="distributions.html#функции-распределения"><i class="fa fa-check"></i><b>5.2</b> Функции распределения</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>6</b> Описательная статистика</a>
<ul>
<li class="chapter" data-level="6.1" data-path="descriptives.html"><a href="descriptives.html#descriptive_vis"><i class="fa fa-check"></i><b>6.1</b> Описательные визуализации</a></li>
<li class="chapter" data-level="6.2" data-path="descriptives.html"><a href="descriptives.html#ctm"><i class="fa fa-check"></i><b>6.2</b> Меры центральной тенденции</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="descriptives.html"><a href="descriptives.html#среднее-медиана-мода"><i class="fa fa-check"></i><b>6.2.1</b> Среднее, медиана, мода</a></li>
<li class="chapter" data-level="6.2.2" data-path="descriptives.html"><a href="descriptives.html#особенности-использования"><i class="fa fa-check"></i><b>6.2.2</b> Особенности использования</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="descriptives.html"><a href="descriptives.html#квантили-квартили-и-перцентили"><i class="fa fa-check"></i><b>6.3</b> Квантили, квартили и перцентили</a></li>
<li class="chapter" data-level="6.4" data-path="descriptives.html"><a href="descriptives.html#varm"><i class="fa fa-check"></i><b>6.4</b> Меры вариативности</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="descriptives.html"><a href="descriptives.html#размах-стандартное-отклонение-и-дисперсия"><i class="fa fa-check"></i><b>6.4.1</b> Размах, стандартное отклонение и дисперсия</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="descriptives.html"><a href="descriptives.html#боксплот-и-вайолинплот"><i class="fa fa-check"></i><b>6.5</b> Боксплот и вайолинплот</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="normdist.html"><a href="normdist.html"><i class="fa fa-check"></i><b>7</b> Нормальное распределение и оценки</a>
<ul>
<li class="chapter" data-level="7.1" data-path="normdist.html"><a href="normdist.html#ctt"><i class="fa fa-check"></i><b>7.1</b> Центральная предельная теорема</a></li>
<li class="chapter" data-level="7.2" data-path="normdist.html"><a href="normdist.html#standart_error"><i class="fa fa-check"></i><b>7.2</b> Стандартная ошибка среднего</a></li>
<li class="chapter" data-level="7.3" data-path="normdist.html"><a href="normdist.html#нормальное-распределение-и-его-свойства"><i class="fa fa-check"></i><b>7.3</b> Нормальное распределение и его свойства</a></li>
<li class="chapter" data-level="7.4" data-path="normdist.html"><a href="normdist.html#стандартное-нормальное-распределение"><i class="fa fa-check"></i><b>7.4</b> Стандартное нормальное распределение</a></li>
<li class="chapter" data-level="7.5" data-path="normdist.html"><a href="normdist.html#z-преобразование-и-стандартизация"><i class="fa fa-check"></i><b>7.5</b> Z-преобразование и стандартизация</a></li>
<li class="chapter" data-level="7.6" data-path="normdist.html"><a href="normdist.html#доверительный-интервал"><i class="fa fa-check"></i><b>7.6</b> Доверительный интервал</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>8</b> Статистический вывод</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inference.html"><a href="inference.html#идея-статистического-вывода"><i class="fa fa-check"></i><b>8.1</b> Идея статистического вывода</a></li>
<li class="chapter" data-level="8.2" data-path="inference.html"><a href="inference.html#nhst"><i class="fa fa-check"></i><b>8.2</b> NHST: алгоритм проверки гипотезы и анализа данных</a></li>
<li class="chapter" data-level="8.3" data-path="inference.html"><a href="inference.html#эмпирические-гипотезы-и-переменные"><i class="fa fa-check"></i><b>8.3</b> Эмпирические гипотезы и переменные</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference.html"><a href="inference.html#variables"><i class="fa fa-check"></i><b>8.3.1</b> Зависимые и независимые переменные</a></li>
<li class="chapter" data-level="8.3.2" data-path="inference.html"><a href="inference.html#уровни-нп-в-категориальных-переменных"><i class="fa fa-check"></i><b>8.3.2</b> Уровни НП в категориальных переменных</a></li>
<li class="chapter" data-level="8.3.3" data-path="inference.html"><a href="inference.html#relationship"><i class="fa fa-check"></i><b>8.3.3</b> Связь между ЗП и НП</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="inference.html"><a href="inference.html#нулевая-и-альтернативные-статистические-гипотезы"><i class="fa fa-check"></i><b>8.4</b> Нулевая и альтернативные статистические гипотезы</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="inference.html"><a href="inference.html#направленные-и-ненаправленные-гипотезы"><i class="fa fa-check"></i><b>8.4.1</b> Направленные и ненаправленные гипотезы</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="inference.html"><a href="inference.html#уровень-значимости-и-статистическая-мощность"><i class="fa fa-check"></i><b>8.5</b> Уровень значимости и статистическая мощность</a></li>
<li class="chapter" data-level="8.6" data-path="inference.html"><a href="inference.html#выбор-статистического-критерия"><i class="fa fa-check"></i><b>8.6</b> Выбор статистического критерия</a></li>
<li class="chapter" data-level="8.7" data-path="inference.html"><a href="inference.html#sample_size"><i class="fa fa-check"></i><b>8.7</b> Размер выборки и размер эффекта</a></li>
<li class="chapter" data-level="8.8" data-path="inference.html"><a href="inference.html#stat_test_example"><i class="fa fa-check"></i><b>8.8</b> Расчет статического критерия и проверка значимости</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="stats_criteria.html"><a href="stats_criteria.html"><i class="fa fa-check"></i><b>9</b> Статистические критерии</a>
<ul>
<li class="chapter" data-level="9.1" data-path="stats_criteria.html"><a href="stats_criteria.html#степени-свободы"><i class="fa fa-check"></i><b>9.1</b> Степени свободы</a></li>
<li class="chapter" data-level="9.2" data-path="stats_criteria.html"><a href="stats_criteria.html#ключевые-распределения-и-статистики-критериев-z-t-f"><i class="fa fa-check"></i><b>9.2</b> Ключевые распределения и статистики критериев (Z, T, F)</a></li>
<li class="chapter" data-level="9.3" data-path="stats_criteria.html"><a href="stats_criteria.html#выбор-статистического-критерия-1"><i class="fa fa-check"></i><b>9.3</b> Выбор статистического критерия</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="stats_criteria.html"><a href="stats_criteria.html#param_nonparam"><i class="fa fa-check"></i><b>9.3.1</b> Параметрические и непараметрические критерии</a></li>
<li class="chapter" data-level="9.3.2" data-path="stats_criteria.html"><a href="stats_criteria.html#зависимые-и-независимые-выборки"><i class="fa fa-check"></i><b>9.3.2</b> Зависимые и независимые выборки</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html"><i class="fa fa-check"></i><b>10</b> Сравнение средних по группам</a>
<ul>
<li class="chapter" data-level="10.1" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#ttest"><i class="fa fa-check"></i><b>10.1</b> T-тест</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#допущения-для-т-теста"><i class="fa fa-check"></i><b>10.1.1</b> Допущения для т-теста</a></li>
<li class="chapter" data-level="10.1.2" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#непараметрические-аналоги"><i class="fa fa-check"></i><b>10.1.2</b> Непараметрические аналоги</a></li>
<li class="chapter" data-level="10.1.3" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#независимые-и-парные-тесты"><i class="fa fa-check"></i><b>10.1.3</b> Независимые и парные тесты</a></li>
<li class="chapter" data-level="10.1.4" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#вычисление-т-теста-и-непараметрических-аналогов"><i class="fa fa-check"></i><b>10.1.4</b> Вычисление т-теста и непараметрических аналогов</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#anova"><i class="fa fa-check"></i><b>10.2</b> ANOVA (дисперсионный анализ)</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#levels"><i class="fa fa-check"></i><b>10.2.1</b> Факторы и уровни</a></li>
<li class="chapter" data-level="10.2.2" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#почему-он-дисперсионный"><i class="fa fa-check"></i><b>10.2.2</b> Почему он дисперсионный</a></li>
<li class="chapter" data-level="10.2.3" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#f-распределение-фишера"><i class="fa fa-check"></i><b>10.2.3</b> F-распределение (Фишера)</a></li>
<li class="chapter" data-level="10.2.4" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#допущения-для-anova"><i class="fa fa-check"></i><b>10.2.4</b> Допущения для ANOVA</a></li>
<li class="chapter" data-level="10.2.5" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#непараметрические-аналоги-1"><i class="fa fa-check"></i><b>10.2.5</b> Непараметрические аналоги</a></li>
<li class="chapter" data-level="10.2.6" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#просто-anova-и-с-повторными-измерениями"><i class="fa fa-check"></i><b>10.2.6</b> Просто ANOVA и с повторными измерениями</a></li>
<li class="chapter" data-level="10.2.7" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#нелинейные-эффекты"><i class="fa fa-check"></i><b>10.2.7</b> Нелинейные эффекты</a></li>
<li class="chapter" data-level="10.2.8" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#multiple_anova"><i class="fa fa-check"></i><b>10.2.8</b> Многофакторый ANOVA и взаимодействие факторов</a></li>
<li class="chapter" data-level="10.2.9" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#пост-хоки-и-множественные-сравнения"><i class="fa fa-check"></i><b>10.2.9</b> Пост-хоки и множественные сравнения</a></li>
<li class="chapter" data-level="10.2.10" data-path="stats_criteria_ttest_anova.html"><a href="stats_criteria_ttest_anova.html#вычисление-anova-и-непараметрических-аналогов"><i class="fa fa-check"></i><b>10.2.10</b> Вычисление ANOVA и непараметрических аналогов</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html"><i class="fa fa-check"></i><b>11</b> Проверка линейной свзяи</a>
<ul>
<li class="chapter" data-level="11.1" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#corr_test"><i class="fa fa-check"></i><b>11.1</b> Корреляционный анализ</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#корреляционный-тест"><i class="fa fa-check"></i><b>11.1.1</b> Корреляционный тест</a></li>
<li class="chapter" data-level="11.1.2" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#допущения-для-корреляционного-теста"><i class="fa fa-check"></i><b>11.1.2</b> Допущения для корреляционного теста</a></li>
<li class="chapter" data-level="11.1.3" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#непараметрические-аналоги-2"><i class="fa fa-check"></i><b>11.1.3</b> Непараметрические аналоги</a></li>
<li class="chapter" data-level="11.1.4" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#расчет-корреляционного-теста"><i class="fa fa-check"></i><b>11.1.4</b> Расчет корреляционного теста</a></li>
<li class="chapter" data-level="11.1.5" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#интерпретация-результатов"><i class="fa fa-check"></i><b>11.1.5</b> Интерпретация результатов</a></li>
<li class="chapter" data-level="11.1.6" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#корреляционные-матрицы"><i class="fa fa-check"></i><b>11.1.6</b> Корреляционные матрицы</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#linreg"><i class="fa fa-check"></i><b>11.2</b> Линейный регрессионный анализ</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#linreg_coef"><i class="fa fa-check"></i><b>11.2.1</b> Коэффициенты регрессии</a></li>
<li class="chapter" data-level="11.2.2" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#rsquared"><i class="fa fa-check"></i><b>11.2.2</b> Коэффициент детерминации и доля объясненной изменчивости</a></li>
<li class="chapter" data-level="11.2.3" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#linreg_null"><i class="fa fa-check"></i><b>11.2.3</b> Регрессионный анализ (тестирование коэффициентов регрессии)</a></li>
<li class="chapter" data-level="11.2.4" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#множественный-регрессионный-анализ"><i class="fa fa-check"></i><b>11.2.4</b> Множественный регрессионный анализ</a></li>
<li class="chapter" data-level="11.2.5" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#assumptions_linreg"><i class="fa fa-check"></i><b>11.2.5</b> Допущения для регрессионного анализа</a></li>
<li class="chapter" data-level="11.2.6" data-path="stats_criteria_linear.html"><a href="stats_criteria_linear.html#linreg_example"><i class="fa fa-check"></i><b>11.2.6</b> Расчет регрессионного анализа</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="stats_criteria_categ.html"><a href="stats_criteria_categ.html"><i class="fa fa-check"></i><b>12</b> Анализ категориальных данных</a>
<ul>
<li class="chapter" data-level="12.1" data-path="stats_criteria_categ.html"><a href="stats_criteria_categ.html#логистическая-регрессия"><i class="fa fa-check"></i><b>12.1</b> Логистическая регрессия</a></li>
<li class="chapter" data-level="12.2" data-path="stats_criteria_categ.html"><a href="stats_criteria_categ.html#хи-квадрат"><i class="fa fa-check"></i><b>12.2</b> Хи-квадрат</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="R_analysis.html"><a href="R_analysis.html"><i class="fa fa-check"></i><b>13</b> Введение в анализ данных в R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="R_analysis.html"><a href="R_analysis.html#данные-и-переменные"><i class="fa fa-check"></i><b>13.1</b> Данные и переменные</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="R_analysis.html"><a href="R_analysis.html#data_types"><i class="fa fa-check"></i><b>13.1.1</b> Основные типы данных</a></li>
<li class="chapter" data-level="13.1.2" data-path="R_analysis.html"><a href="R_analysis.html#data_structures"><i class="fa fa-check"></i><b>13.1.2</b> Основные структуры данных</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="R_analysis.html"><a href="R_analysis.html#operarions"><i class="fa fa-check"></i><b>13.2</b> Операции с переменными и функции</a></li>
<li class="chapter" data-level="13.3" data-path="R_analysis.html"><a href="R_analysis.html#начало-работы-в-среде"><i class="fa fa-check"></i><b>13.3</b> Начало работы в среде</a></li>
<li class="chapter" data-level="13.4" data-path="R_analysis.html"><a href="R_analysis.html#начало-работы-с-данными"><i class="fa fa-check"></i><b>13.4</b> Начало работы с данными</a></li>
<li class="chapter" data-level="13.5" data-path="R_analysis.html"><a href="R_analysis.html#tasks_sem2"><i class="fa fa-check"></i><b>13.5</b> Задания после семинара 2</a></li>
<li class="chapter" data-level="13.6" data-path="R_analysis.html"><a href="R_analysis.html#preprocessing"><i class="fa fa-check"></i><b>13.6</b> Предобработка данных</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="R_analysis.html"><a href="R_analysis.html#columns"><i class="fa fa-check"></i><b>13.6.1</b> Отбор колонок</a></li>
<li class="chapter" data-level="13.6.2" data-path="R_analysis.html"><a href="R_analysis.html#filter"><i class="fa fa-check"></i><b>13.6.2</b> Фильтрация (отбор строк)</a></li>
<li class="chapter" data-level="13.6.3" data-path="R_analysis.html"><a href="R_analysis.html#mutate"><i class="fa fa-check"></i><b>13.6.3</b> Создание колонок</a></li>
<li class="chapter" data-level="13.6.4" data-path="R_analysis.html"><a href="R_analysis.html#NA"><i class="fa fa-check"></i><b>13.6.4</b> Работа с пропущенными значениями (NA)</a></li>
<li class="chapter" data-level="13.6.5" data-path="R_analysis.html"><a href="R_analysis.html#sorting"><i class="fa fa-check"></i><b>13.6.5</b> Сортировка</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="R_analysis.html"><a href="R_analysis.html#tasks_sem3"><i class="fa fa-check"></i><b>13.7</b> Задания после семинара 3</a></li>
<li class="chapter" data-level="13.8" data-path="R_analysis.html"><a href="R_analysis.html#descriptives_r"><i class="fa fa-check"></i><b>13.8</b> Описательные статистики и агрегация</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="R_analysis.html"><a href="R_analysis.html#описательные-статистики"><i class="fa fa-check"></i><b>13.8.1</b> Описательные статистики</a></li>
<li class="chapter" data-level="13.8.2" data-path="R_analysis.html"><a href="R_analysis.html#aggregate"><i class="fa fa-check"></i><b>13.8.2</b> Агрегация данных</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="R_analysis.html"><a href="R_analysis.html#visualization"><i class="fa fa-check"></i><b>13.9</b> Визуализации</a></li>
<li class="chapter" data-level="13.10" data-path="R_analysis.html"><a href="R_analysis.html#tasks_sem4"><i class="fa fa-check"></i><b>13.10</b> Задания после семинара 4</a></li>
<li class="chapter" data-level="13.11" data-path="R_analysis.html"><a href="R_analysis.html#проверка-гипотез"><i class="fa fa-check"></i><b>13.11</b> Проверка гипотез</a>
<ul>
<li class="chapter" data-level="13.11.1" data-path="R_analysis.html"><a href="R_analysis.html#корреляционный-тест-1"><i class="fa fa-check"></i><b>13.11.1</b> Корреляционный тест</a></li>
<li class="chapter" data-level="13.11.2" data-path="R_analysis.html"><a href="R_analysis.html#т-тест"><i class="fa fa-check"></i><b>13.11.2</b> Т-тест</a></li>
</ul></li>
<li class="chapter" data-level="13.12" data-path="R_analysis.html"><a href="R_analysis.html#tasks_sem5"><i class="fa fa-check"></i><b>13.12</b> Задания после семинара 5</a></li>
<li class="chapter" data-level="13.13" data-path="R_analysis.html"><a href="R_analysis.html#проверка-гипоте-2-anova-и-линейная-регрессия"><i class="fa fa-check"></i><b>13.13</b> Проверка гипоте-2: ANOVA и линейная регрессия</a>
<ul>
<li class="chapter" data-level="13.13.1" data-path="R_analysis.html"><a href="R_analysis.html#anova-дисперсионный-анализ"><i class="fa fa-check"></i><b>13.13.1</b> ANOVA (дисперсионный анализ)</a></li>
<li class="chapter" data-level="13.13.2" data-path="R_analysis.html"><a href="R_analysis.html#reshaping"><i class="fa fa-check"></i><b>13.13.2</b> Решейпинг</a></li>
</ul></li>
<li class="chapter" data-level="13.14" data-path="R_analysis.html"><a href="R_analysis.html#tasks_sem6"><i class="fa fa-check"></i><b>13.14</b> Задания после семинара 6</a></li>
<li class="chapter" data-level="13.15" data-path="R_analysis.html"><a href="R_analysis.html#lin_reg"><i class="fa fa-check"></i><b>13.15</b> Линейный регрессионный анализ</a>
<ul>
<li class="chapter" data-level="13.15.1" data-path="R_analysis.html"><a href="R_analysis.html#линейная-регрессия-с-одним-предиктором-фактором"><i class="fa fa-check"></i><b>13.15.1</b> Линейная регрессия с одним предиктором (фактором)</a></li>
<li class="chapter" data-level="13.15.2" data-path="R_analysis.html"><a href="R_analysis.html#линейная-регрессия-с-несколькими-предикторами-факторами"><i class="fa fa-check"></i><b>13.15.2</b> Линейная регрессия с несколькими предикторами (факторами)</a></li>
</ul></li>
<li class="chapter" data-level="13.16" data-path="R_analysis.html"><a href="R_analysis.html#tasks_sem7"><i class="fa fa-check"></i><b>13.16</b> Задания после семинара 7</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Статистика для анализа данных</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="R_analysis" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Введение в анализ данных в R<a href="R_analysis.html#R_analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Эта книжка написана с помощью языка программирования и обработки данных R и пакета Bookdown в среде работы с данными RStudio.</p>
<p>Чтобы начать в ней работать, нужно скачать и установить сам язык R <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a> и скачать и установить RStudio, среду для работы <a href="https://posit.co/downloads/" class="uri">https://posit.co/downloads/</a>.</p>
<div id="данные-и-переменные" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Данные и переменные<a href="R_analysis.html#данные-и-переменные" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Данные</strong> – это информация, представленная в форме, пригодной для хранения и обработки человеком или информационными системами (ISO/IEC/IEEE 24765-2010).
Если данные представлены в форме для обработки информационными системами, они формализованы.</p>
<p><strong>Переменная</strong> – это оболочка, которую мы задаем, чтобы хранить в ней данные и выполнять операции с ними.
У переменной есть <em>название</em> и те <em>данные</em>, которая она хранит.</p>
<p align="center">
<img src="docs/images/variable.png" width="80%" style="display: block; margin: auto;" />
</p>
<div id="data_types" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Основные типы данных<a href="R_analysis.html#data_types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Числовой</strong> (целые числа – <strong>integer</strong> или <strong>numeric</strong>, вещественные числа – <strong>real</strong>, числа с плавающей точкой (дробные) – <strong>float</strong>)</li>
<li><strong>Текстовый</strong> (<strong>character</strong>, если один символ, или <strong>string</strong> – много символов)</li>
<li><strong>Логический</strong> (<strong>logical</strong> или <strong>boolean</strong> – принимает только значения True / False)</li>
<li><strong>NA</strong> – пропущенные значения (not available)</li>
<li><strong>NaN</strong> – not a number, результат выполнения невозможной числовой операции (например, деление на 0)</li>
</ul>
</div>
<div id="data_structures" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Основные структуры данных<a href="R_analysis.html#data_structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Вектор (vector)</strong> – одномерный массив одного типа данных</li>
<li><strong>Массив (array)</strong> – многомерный массив одного типа данных, состоящий из векторов одной длины</li>
<li><strong>Матрица (matrix)</strong> – двумерный массив только числовых данных</li>
<li><strong>Список (list)</strong> – по сути, многомерный массив, но может состоять из векторов разной длины и иметь данные разных типв</li>
<li><strong>Данные, датафрейм (dataframe)</strong> – по сути, cписок, но все вектора одной длины</li>
</ul>
<p align="center">
<img src="docs/images/arrays.png" width="80%" style="display: block; margin: auto;" />
<a href="https://practicum.yandex.ru/blog/10-osnovnyh-struktur-dannyh/" class="uri">https://practicum.yandex.ru/blog/10-osnovnyh-struktur-dannyh/</a>
</p>
</div>
</div>
<div id="operarions" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Операции с переменными и функции<a href="R_analysis.html#operarions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>В зависимости от того, с переменными какого типа мы работаем, мы можем выполнять с ними разные операции.</p>
<p><strong>Операция</strong> – это выполнение каких-либо действий над данными. То, что выполняет это действие, называется <strong>оператором</strong> или <strong>функцией</strong>. Разница между ними в том, что оператор выполняет атомарные (единичные и простые действия), например, оператором может быть знак сложения, деления, больше или меньше и тд. Функция делает более сложные действия: например, создать вектор с помощью функции <code>c()</code>, прочитать данные с помощью функции <code>read_csv()</code>, отфильтровать данные с помощью функции <code>select()</code>. Обратите внимание, что при вызове функции после ее названия всегда ставятся круглые скобки.</p>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><strong>Тип данных</strong></th>
<th align="center"><strong>Возможные атомарные операции</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Числовой</td>
<td align="center">= (присвоение), +, -, /, *, %</td>
</tr>
<tr class="even">
<td align="center">Текстовый</td>
<td align="center">= (присвоение),+ (конкатенация), поиск по определенному символу</td>
</tr>
<tr class="odd">
<td align="center">Логический</td>
<td align="center">= (присвоение),&gt;, &lt;, == (равно), != (не равно)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="R_analysis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создание векторов</span></span>
<span id="cb1-2"><a href="R_analysis.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="co"># c() -- это  функция</span></span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="R_analysis.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">21</span>, <span class="dv">143</span>)</span></code></pre></div>
<pre><code>## [1]   1   2   3   4   5   7  21 143</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="R_analysis.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="co">#функция перечисления всех значений от 1 до 5</span></span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="R_analysis.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="co">#функция перечисления всех значений от 1 до 10</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="R_analysis.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">2</span>) <span class="co"># функция перечисления всех значений от 1 до 10 с шагом 2</span></span></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="R_analysis.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#пример приведения типов -- TRUE и FALSE превратились в 1 и 0</span></span>
<span id="cb11-2"><a href="R_analysis.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 1 0</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="R_analysis.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;1&quot; &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="R_analysis.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># логические выражения</span></span>
<span id="cb15-2"><a href="R_analysis.html#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="R_analysis.html#cb15-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb15-4"><a href="R_analysis.html#cb15-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-5"><a href="R_analysis.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="R_analysis.html#cb15-6" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&gt;</span> b</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="R_analysis.html#cb17-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&gt;=</span> b</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="R_analysis.html#cb19-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">==</span> b</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="R_analysis.html#cb21-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">!=</span> b</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="R_analysis.html#cb23-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;=</span> b</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="R_analysis.html#cb25-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="R_analysis.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#функция, которая выполняет действия в зависимости от условия ...если ... то:</span></span>
<span id="cb27-2"><a href="R_analysis.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ifelse() содержит 3 аргумента: ( условие; что делать, если условие верно;</span></span>
<span id="cb27-3"><a href="R_analysis.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># что делать, если условие ложно)</span></span>
<span id="cb27-4"><a href="R_analysis.html#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="R_analysis.html#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(a <span class="sc">&lt;</span> b, a<span class="sc">+</span>b, <span class="st">&quot;а не меньше b&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
</div>
<div id="начало-работы-в-среде" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Начало работы в среде<a href="R_analysis.html#начало-работы-в-среде" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>В этом учебнике я буду приводить задания для тренировки в любой среде работы с данными и код работы с данными в R.</p>
<p>Для большинства интересных операций в R нам понадобятся дополнительные пакеты – набор функций, которые уже кто-то написал за нас (то же самое, как, например, <code>import numpy as np</code> в питоне). Нам в основном понадобится пакет <code>tidyverse</code>, дословно – “вселенная чистых данных`. Сразу скажу, что все помеченной символом # – это комментарии, наши подсказки, которые не будут исполняться. Их важно всего оставлять для себя, чтобы не забыть, что вообще здесь происходит.</p>
<p>Чтобы пакет заработал, его нужно 1. установить и 2. подключить</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="R_analysis.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># устанавливаем пакет</span></span>
<span id="cb29-2"><a href="R_analysis.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="R_analysis.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># подключаем пакет</span></span>
<span id="cb30-2"><a href="R_analysis.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Установить пакет достаточно всего один раз после установки R, подключать через <code>library</code> нужно всегда, когда открываем RStudio. Ошибка вида “could not find function” в 99% случаев говорит о том, что пакет, из которого она используется, не подключен.</p>
</div>
<div id="начало-работы-с-данными" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Начало работы с данными<a href="R_analysis.html#начало-работы-с-данными" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Мы будем работать с данными World Happiness Report за 2016 год <a href="https://www.kaggle.com/datasets/unsdsn/world-happiness" class="uri">https://www.kaggle.com/datasets/unsdsn/world-happiness</a>. Это Всемирный доклад о счастье <a href="https://en.wikipedia.org/wiki/World_Happiness_Report" class="uri">https://en.wikipedia.org/wiki/World_Happiness_Report</a> , которой показывает, как жители разных стран оценивают свой уровень счастья. В данных за 2016 год, с которыми мы будем работать, участвую 157 стран. <em>Кстати, вы можете скачать данные за разные года и посмотреть, как менялось количество стран-участниц? Чуть позже мы научимся делать это с помощью кода</em>. Здесь есть следующие переменные:</p>
<ul>
<li>Happiness Rank - позиция в рейтинге</li>
<li>Happiness Score - абсолютное значение, набранное по уровню счастья</li>
<li>SE - стандартная ошибка</li>
<li>Economy - ВВП на душу населения</li>
<li>Family - Социальная поддержка, ощущение семье</li>
<li>Health - Продолжительность жизни</li>
<li>Freedom - Свободы</li>
<li>Trust (Goverment Corruption) - воспринимаемый уровень коррупции</li>
<li>Generosity - сколько жертвуют на благотворительность</li>
<li>Dystopia - страна-антиутопия, где самые низкие показатели по всем парметрам из существующих</li>
</ul>
<p>Economy, Family, Health, Freedom, Trust, Generosity – 6 показателей, по которым считается уровень счастья.</p>
<p>Чтобы совершать операции с данными, их сначала нужно <em>прочитать</em>, загрузить в среду работы с данными. В современных традициях R это проще всего сделать с помощью функции <code>read_csv()</code> из пакета <code>tidyverse</code>. Не забывайте, что любой вызов функции сопровождается круглыми скобками, в которые передаются аргументы. В функции <code>read_csv()</code>в скобках нужно передать путь к файлу, который мы хотим прочитать.Его можно скопировать через свойства файла. Но чтобы не заморачиваться с путем, проще всего положить файл с данными в ту же папку, где и лежит наш сам файл с кодом (для этого его нужно сохранить). А самое элегентное и используемое решение – создать проект File - New Project, и хранить все файл в папке проекта, это уберагает от большого числа ошибок. Про импорт файлов очень подробно расписано у Ивана Позднякова <a href="https://pozdniakov.github.io/tidy_stats/030-import_data.html" class="uri">https://pozdniakov.github.io/tidy_stats/030-import_data.html</a></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="R_analysis.html#cb31-1" aria-hidden="true" tabindex="-1"></a>whr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;2016.csv&quot;</span>) <span class="co"># читаем данные </span></span>
<span id="cb31-2"><a href="R_analysis.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="R_analysis.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(whr) <span class="co"># просматриваем, что получилось передать в объект с названием whr </span></span></code></pre></div>
<p>Теперь я хочу поизучать эти данные. Помните, с чего мы начинаем изучение данных? С <a href="descriptives">описательных статистик</a></p>
<p>Я могу отобрать все переменные по одной и посчитать для них среднее и стандартное отклонение – это то, что в Jamovi находится во вкладке Descriptives. Так как колонка существует не в вакууме, а внутри датасета, то нам необходимо как-то указать, что нас интересует конкретная колонка внутри конкретного датасета. Пока что проще всего это сделать – с помощью значка <code>$</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="R_analysis.html#cb32-1" aria-hidden="true" tabindex="-1"></a>whr<span class="sc">$</span>Family <span class="co"># отбираем всю колонку </span></span></code></pre></div>
<pre><code>##   [1] 1.16374 1.14524 1.18326 1.12690 1.13464 1.09610 1.02912 1.17278 1.10476
##  [10] 1.08764 0.99537 1.08383 1.04782 1.02152 1.08113 1.09774 1.03938 1.05249
##  [19] 1.16157 1.03999 0.71460 0.86758 1.08672 0.90587 0.98912 1.06612 1.00793
##  [28] 0.87114 1.03143 1.09879 1.02169 1.00508 1.04477 0.84829 0.92624 0.87964
##  [37] 1.12945 0.83309 0.87119 0.77866 0.87758 0.94397 0.98569 1.03302 1.08268
##  [46] 0.80975 0.88025 0.89521 1.16810 1.04167 0.85974 0.68655 1.06054 0.95544
##  [55] 0.83132 1.05261 1.04685 0.72194 0.83779 1.06411 1.04993 0.81826 1.05613
##  [64] 0.81255 1.03817 0.75695 0.95076 0.95025 0.70697 1.11111 0.72803 1.05163
##  [73] 0.96372 0.60809 0.87021 0.33613 0.66062 0.87717 0.87625 0.86216 0.76042
##  [82] 0.87877 0.79381 0.90836 0.95434 0.81329 0.64367 0.74173 0.99496 0.38595
##  [91] 0.93164 0.26135 0.64184 0.94367 0.78236 0.79117 0.75862 0.43165 0.75473
## [100] 0.75602 1.08983 0.54970 0.64498 0.75596 0.38857 0.63760 0.69699 0.71629
## [109] 0.50163 0.24749 0.62800 0.59205 0.70362 0.62542 0.37932 0.96053 0.84783
## [118] 0.29247 0.69981 0.49813 0.62477 0.76240 1.01413 0.49353 0.80676 0.19249
## [127] 0.47799 0.77416 0.92542 0.84142 0.71478 0.14700 0.81928 0.72368 0.86333
## [136] 0.29561 0.89186 0.60323 0.57576 0.53750 0.66366 0.60530 0.18519 0.63178
## [145] 0.63054 0.90981 0.47493 0.46115 0.77623 0.50353 0.31090 0.61586 0.10419
## [154] 0.11037 0.00000 0.14866 0.23442</code></pre>
<p>Или можем вспомнить, что датафрейм имеет два измерения, как и <a href="data_structures">двумерный массив</a>, и можем обратиться по индексу (в квадртных скобках): номер строки (первое число) и номер колонки (второе число). Если нас интересует не конкретная строка, а все строки, то на месте этого индекс ничего не ставится, как бы пропускаем его.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="R_analysis.html#cb34-1" aria-hidden="true" tabindex="-1"></a>whr[,<span class="dv">8</span>] <span class="co"># отбираем всю колонку другим способом</span></span></code></pre></div>
<pre><code>## # A tibble: 157 × 1
##    Family
##     &lt;dbl&gt;
##  1   1.16
##  2   1.15
##  3   1.18
##  4   1.13
##  5   1.13
##  6   1.10
##  7   1.03
##  8   1.17
##  9   1.10
## 10   1.09
## # … with 147 more rows</code></pre>
<p>Обратите внимание на выдачу: как вы думаете, какым структурам данных принадлежат результаты первого и второго способа?</p>
<p>Посчитаем среднее и стандартное отклонение для этой колонки</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="R_analysis.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(whr<span class="sc">$</span>Family) <span class="co"># среднее</span></span></code></pre></div>
<pre><code>## [1] 0.7936211</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="R_analysis.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(whr<span class="sc">$</span>Family) <span class="co"># стандартное отклонение</span></span></code></pre></div>
<pre><code>## [1] 0.2667057</code></pre>
</div>
<div id="tasks_sem2" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Задания после семинара 2<a href="R_analysis.html#tasks_sem2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Прочитайте в среде, в которой вы работаете, данные WHR за 2016 год.</li>
<li>Посчитайте среднее, стандартное отклонение, медиану и размах (разброс от максимального до минимального значения) по всем 6 показателям, составляющим уровень счастья. Что можно сказать про них? Где самый большой размах? Где среднее и медиана оказались близко друг к другу, а где не очень? <em>(для подсчета медианы и размаха в R нужно будет немножко поучиться гуглить или использовать другие материалы)</em></li>
</ol>
</div>
<div id="preprocessing" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Предобработка данных<a href="R_analysis.html#preprocessing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>После того, как мы считали данные данные в переменную (мы использовали функцию <code>read_csv()</code> для этого), часто нужно эти данные сначала <strong>предобработать</strong>. Во-первых, данные сами по себе могут быть не очень хорошего качества, и их нужно почистить. Во-вторых, мы никогда не работаем со всей табличкй сразу – мы отбираем данные, например, определенную колонку, и часто нам нужны не все данные, а только соответствующие определенным условиям (например, нам нужно отобрать время реакции в группе, где испытуемые употребляли кофеин, а не плацебо).</p>
<p>В предобработку данных чаще всего входит:</p>
<ul>
<li>Отбор определенных колонок</li>
<li>Фильтрация – отбор определенных строк, удовлетворяющих определенным условиям</li>
<li>Создание новых колонок и заполнение их в соответствии с определенными услвиями</li>
<li>Работа с пропущенными значениями – удаление или замена на какое-либо (например, среднее) значение</li>
</ul>
<p>Пойдем по порядку.</p>
<div id="columns" class="section level3 hasAnchor" number="13.6.1">
<h3><span class="header-section-number">13.6.1</span> Отбор колонок<a href="R_analysis.html#columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Любое почти всегда можно сделать разными способами. Чаще всего не существует правильного, если работает – значит, правильно. Но некоторые решения бывает более оптимальными в разных контекстах. Рассмотрим разные способы отбора колонок. Обратите внимание, чем они различаются?</p>
<p><em>Сразу комментарий – когда мы делаем операцию присвоения &lt;-, у нас ничего не выводится в консоль. Чтобы посмотреть, что мы присвоили переменной, можно вывести ее по названию или, если речь про данные – посмотреть с помощью функции View(). Если вы только пробуете написать операцию – не спешите присваивать ее в переменную! Так мы сразу будем видеть результат в консоли, и если он ошибочный, это будет понятно.</em></p>
<p><strong>Отбор в базовом R по названию колонки</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="R_analysis.html#cb40-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> whr<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span></span>
<span id="cb40-2"><a href="R_analysis.html#cb40-2" aria-hidden="true" tabindex="-1"></a>var1</span></code></pre></div>
<pre><code>##   [1] 7.526 7.509 7.501 7.498 7.413 7.404 7.339 7.334 7.313 7.291 7.267 7.119
##  [13] 7.104 7.087 7.039 6.994 6.952 6.929 6.907 6.871 6.778 6.739 6.725 6.705
##  [25] 6.701 6.650 6.596 6.573 6.545 6.488 6.481 6.478 6.474 6.379 6.379 6.375
##  [37] 6.361 6.355 6.324 6.269 6.239 6.218 6.168 6.084 6.078 6.068 6.005 5.992
##  [49] 5.987 5.977 5.976 5.956 5.921 5.919 5.897 5.856 5.835 5.835 5.822 5.813
##  [61] 5.802 5.771 5.768 5.743 5.658 5.648 5.615 5.560 5.546 5.538 5.528 5.517
##  [73] 5.510 5.488 5.458 5.440 5.401 5.389 5.314 5.303 5.291 5.279 5.245 5.196
##  [85] 5.185 5.177 5.163 5.161 5.155 5.151 5.145 5.132 5.129 5.123 5.121 5.061
##  [97] 5.057 5.045 5.033 4.996 4.907 4.876 4.875 4.871 4.813 4.795 4.793 4.754
## [109] 4.655 4.643 4.635 4.575 4.574 4.513 4.508 4.459 4.415 4.404 4.395 4.362
## [121] 4.360 4.356 4.324 4.276 4.272 4.252 4.236 4.219 4.217 4.201 4.193 4.156
## [133] 4.139 4.121 4.073 4.028 3.974 3.956 3.916 3.907 3.866 3.856 3.832 3.763
## [145] 3.739 3.739 3.724 3.695 3.666 3.622 3.607 3.515 3.484 3.360 3.303 3.069
## [157] 2.905</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="R_analysis.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(var1)</span></code></pre></div>
<pre><code>##  num [1:157] 7.53 7.51 7.5 7.5 7.41 ...</code></pre>
<p><strong>Отбор в базовом R по индексу</strong></p>
<p>Индекс – это номер элемента в структуре данных. Мы говорили про них, когда обсуждали многомерные массивы: в одномерной структуре, например, векторе, индекс будет состоять из одного числа, в двумернй (например, матрице или датафрейме) – индекс состоит из двух чисел, разделенных запятой, в трехмерной – из трех, и так далее. Индекс в R всегда пишется в квадратных скобках, например, чтобы узнать, что находится во второй строчке третьего столбца, индекс элемента будет <code>[2,3]</code>.
<strong>Сначала идет номер строки, затем – номер столбца.</strong> Если мы хотим вывести все строки или все столбцы – на месте этого индекса ничего не ставится. Например, если я хочу вывести все строки из третьей колонки, я напишу <code>[,3]</code></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="R_analysis.html#cb44-1" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> whr[,<span class="dv">4</span>]</span>
<span id="cb44-2"><a href="R_analysis.html#cb44-2" aria-hidden="true" tabindex="-1"></a>var2</span></code></pre></div>
<pre><code>## # A tibble: 157 × 1
##    `Happiness Score`
##                &lt;dbl&gt;
##  1              7.53
##  2              7.51
##  3              7.50
##  4              7.50
##  5              7.41
##  6              7.40
##  7              7.34
##  8              7.33
##  9              7.31
## 10              7.29
## # … with 147 more rows</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="R_analysis.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(var2)</span></code></pre></div>
<pre><code>## tibble [157 × 1] (S3: tbl_df/tbl/data.frame)
##  $ Happiness Score: num [1:157] 7.53 7.51 7.5 7.5 7.41 ...</code></pre>
<p><strong>Отбор с помощью пакета tidyverse по названию</strong></p>
<p>Сначала пара важных моментов отнсосительно работы с пакетом и кульурой написания кода <code>tidyverse</code>. Последовательность операций в рамках одной задачи пишется построчно с переносом на следующую строку в виде <a href="https://magrittr.tidyverse.org/reference/pipe.html">пайпа</a> <code>%&gt;%</code> – символа, который позволяет испльзовать в качестве аргумента функции следующей строки то, что получилось в результате выполнения предыдущей. На первой строке в пайп передаются сами данные, то есть название переменной, в которую мы их записали. Далее на каждой следующей строке в качестве первого аргумента функции в скобках будет применяться результат выполнения предыдущей. Подробнее про tidyverse <a href="https://pozdniakov.github.io/tidy_stats/110-tidyverse_basic.html" class="uri">https://pozdniakov.github.io/tidy_stats/110-tidyverse_basic.html</a> и про пайпы <a href="https://pozdniakov.github.io/tidy_stats/110-tidyverse_basic.html" class="uri">https://pozdniakov.github.io/tidy_stats/110-tidyverse_basic.html</a></p>
<p>Внутри <code>tidyverse</code> используется такая структура данных, как <code>tibble</code>(<a href="https://tibble.tidyverse.org/" class="uri">https://tibble.tidyverse.org/</a>). Тиббл – это модицифированный датафрейм, о чем мы уже говорили, когда обсуждали <a href="R_analysis.html#data_structures">структуры данных</a></p>
<p>Вывод в датафрейм (тиббл):</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="R_analysis.html#cb48-1" aria-hidden="true" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> whr <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="R_analysis.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span>
<span id="cb48-3"><a href="R_analysis.html#cb48-3" aria-hidden="true" tabindex="-1"></a>var3</span></code></pre></div>
<pre><code>## # A tibble: 157 × 1
##    `Happiness Score`
##                &lt;dbl&gt;
##  1              7.53
##  2              7.51
##  3              7.50
##  4              7.50
##  5              7.41
##  6              7.40
##  7              7.34
##  8              7.33
##  9              7.31
## 10              7.29
## # … with 147 more rows</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="R_analysis.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#смотрим структуру данных</span></span>
<span id="cb50-2"><a href="R_analysis.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(var3)</span></code></pre></div>
<pre><code>## tibble [157 × 1] (S3: tbl_df/tbl/data.frame)
##  $ Happiness Score: num [1:157] 7.53 7.51 7.5 7.5 7.41 ...</code></pre>
<p>С помощью функции <code>select()</code> мы можем вытаскивать даже не одну колонку, а несколько:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="R_analysis.html#cb52-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="R_analysis.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country,<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 157 × 2
##    Country     `Happiness Score`
##    &lt;chr&gt;                   &lt;dbl&gt;
##  1 Denmark                  7.53
##  2 Switzerland              7.51
##  3 Iceland                  7.50
##  4 Norway                   7.50
##  5 Finland                  7.41
##  6 Canada                   7.40
##  7 Netherlands              7.34
##  8 New Zealand              7.33
##  9 Australia                7.31
## 10 Sweden                   7.29
## # … with 147 more rows</code></pre>
<p><strong>Отбор с помощью пакета tidyverse по названию</strong></p>
<p>Обратите внимание – предыдущий вывод так же является тибблом, а не вектором. Чтобы вывести в вектор, надо выполнить еще один шаг с помощью функции <code>pull()</code>, которая как бы “вытягивает” значения из тиббла:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="R_analysis.html#cb54-1" aria-hidden="true" tabindex="-1"></a>var4 <span class="ot">&lt;-</span> whr <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="R_analysis.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="R_analysis.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb54-4"><a href="R_analysis.html#cb54-4" aria-hidden="true" tabindex="-1"></a>var4</span></code></pre></div>
<pre><code>##   [1] 7.526 7.509 7.501 7.498 7.413 7.404 7.339 7.334 7.313 7.291 7.267 7.119
##  [13] 7.104 7.087 7.039 6.994 6.952 6.929 6.907 6.871 6.778 6.739 6.725 6.705
##  [25] 6.701 6.650 6.596 6.573 6.545 6.488 6.481 6.478 6.474 6.379 6.379 6.375
##  [37] 6.361 6.355 6.324 6.269 6.239 6.218 6.168 6.084 6.078 6.068 6.005 5.992
##  [49] 5.987 5.977 5.976 5.956 5.921 5.919 5.897 5.856 5.835 5.835 5.822 5.813
##  [61] 5.802 5.771 5.768 5.743 5.658 5.648 5.615 5.560 5.546 5.538 5.528 5.517
##  [73] 5.510 5.488 5.458 5.440 5.401 5.389 5.314 5.303 5.291 5.279 5.245 5.196
##  [85] 5.185 5.177 5.163 5.161 5.155 5.151 5.145 5.132 5.129 5.123 5.121 5.061
##  [97] 5.057 5.045 5.033 4.996 4.907 4.876 4.875 4.871 4.813 4.795 4.793 4.754
## [109] 4.655 4.643 4.635 4.575 4.574 4.513 4.508 4.459 4.415 4.404 4.395 4.362
## [121] 4.360 4.356 4.324 4.276 4.272 4.252 4.236 4.219 4.217 4.201 4.193 4.156
## [133] 4.139 4.121 4.073 4.028 3.974 3.956 3.916 3.907 3.866 3.856 3.832 3.763
## [145] 3.739 3.739 3.724 3.695 3.666 3.622 3.607 3.515 3.484 3.360 3.303 3.069
## [157] 2.905</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="R_analysis.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#смотрим структуру данных</span></span>
<span id="cb56-2"><a href="R_analysis.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(var4)</span></code></pre></div>
<pre><code>##  num [1:157] 7.53 7.51 7.5 7.5 7.41 ...</code></pre>
<p>В этом случае мы можем даже в этом же пайпе посчитать медиану или среднее:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="R_analysis.html#cb58-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="R_analysis.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="co">#результат -- тиббл</span></span>
<span id="cb58-3"><a href="R_analysis.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> <span class="co">#результат -- вектор</span></span>
<span id="cb58-4"><a href="R_analysis.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>()</span></code></pre></div>
<pre><code>## [1] 5.314</code></pre>
<p>А так будет ошибка</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="R_analysis.html#cb60-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="R_analysis.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="co">#результат -- тиббл</span></span>
<span id="cb60-3"><a href="R_analysis.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>()</span></code></pre></div>
</div>
<div id="filter" class="section level3 hasAnchor" number="13.6.2">
<h3><span class="header-section-number">13.6.2</span> Фильтрация (отбор строк)<a href="R_analysis.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Очень часто встает задача фильтрации строк: когда нужны не все данные, а удовлетворяющие какому-либо условию</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="R_analysis.html#cb61-1" aria-hidden="true" tabindex="-1"></a>whr[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>## # A tibble: 10 × 13
##    Country Region Happi…¹ Happi…² Lower…³ Upper…⁴ Econo…⁵ Family Healt…⁶ Freedom
##    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Denmark Weste…       1    7.53    7.46    7.59    1.44   1.16   0.795   0.579
##  2 Switze… Weste…       2    7.51    7.43    7.59    1.53   1.15   0.863   0.586
##  3 Iceland Weste…       3    7.50    7.33    7.67    1.43   1.18   0.867   0.566
##  4 Norway  Weste…       4    7.50    7.42    7.58    1.58   1.13   0.796   0.596
##  5 Finland Weste…       5    7.41    7.35    7.48    1.41   1.13   0.811   0.571
##  6 Canada  North…       6    7.40    7.34    7.47    1.44   1.10   0.828   0.574
##  7 Nether… Weste…       7    7.34    7.28    7.39    1.46   1.03   0.812   0.552
##  8 New Ze… Austr…       8    7.33    7.26    7.40    1.36   1.17   0.831   0.581
##  9 Austra… Austr…       9    7.31    7.24    7.38    1.44   1.10   0.851   0.568
## 10 Sweden  Weste…      10    7.29    7.23    7.36    1.45   1.09   0.831   0.582
## # … with 3 more variables: `Trust (Government Corruption)` &lt;dbl&gt;,
## #   Generosity &lt;dbl&gt;, `Dystopia Residual` &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`Happiness Rank`, ²​`Happiness Score`, ³​`Lower Confidence Interval`,
## #   ⁴​`Upper Confidence Interval`, ⁵​`Economy (GDP per Capita)`,
## #   ⁶​`Health (Life Expectancy)`</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="R_analysis.html#cb63-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="R_analysis.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 13
##    Country Region Happi…¹ Happi…² Lower…³ Upper…⁴ Econo…⁵ Family Healt…⁶ Freedom
##    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Denmark Weste…       1    7.53    7.46    7.59    1.44   1.16   0.795   0.579
##  2 Switze… Weste…       2    7.51    7.43    7.59    1.53   1.15   0.863   0.586
##  3 Iceland Weste…       3    7.50    7.33    7.67    1.43   1.18   0.867   0.566
##  4 Norway  Weste…       4    7.50    7.42    7.58    1.58   1.13   0.796   0.596
##  5 Finland Weste…       5    7.41    7.35    7.48    1.41   1.13   0.811   0.571
##  6 Canada  North…       6    7.40    7.34    7.47    1.44   1.10   0.828   0.574
##  7 Nether… Weste…       7    7.34    7.28    7.39    1.46   1.03   0.812   0.552
##  8 New Ze… Austr…       8    7.33    7.26    7.40    1.36   1.17   0.831   0.581
##  9 Austra… Austr…       9    7.31    7.24    7.38    1.44   1.10   0.851   0.568
## 10 Sweden  Weste…      10    7.29    7.23    7.36    1.45   1.09   0.831   0.582
## # … with 3 more variables: `Trust (Government Corruption)` &lt;dbl&gt;,
## #   Generosity &lt;dbl&gt;, `Dystopia Residual` &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`Happiness Rank`, ²​`Happiness Score`, ³​`Lower Confidence Interval`,
## #   ⁴​`Upper Confidence Interval`, ⁵​`Economy (GDP per Capita)`,
## #   ⁶​`Health (Life Expectancy)`</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="R_analysis.html#cb65-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="R_analysis.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 29 × 13
##    Country Region Happi…¹ Happi…² Lower…³ Upper…⁴ Econo…⁵ Family Healt…⁶ Freedom
##    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Czech … Centr…      27    6.60    6.52    6.68   1.31   1.01    0.764   0.414
##  2 Slovak… Centr…      45    6.08    6.00    6.16   1.28   1.08    0.704   0.234
##  3 Uzbeki… Centr…      49    5.99    5.90    6.08   0.736  1.17    0.502   0.608
##  4 Kazakh… Centr…      54    5.92    5.84    6.00   1.23   0.955   0.574   0.405
##  5 Moldova Centr…      55    5.90    5.82    5.97   0.692  0.831   0.523   0.252
##  6 Russia  Centr…      56    5.86    5.79    5.92   1.23   1.05    0.590   0.327
##  7 Poland  Centr…      57    5.84    5.75    5.92   1.25   1.05    0.691   0.452
##  8 Lithua… Centr…      60    5.81    5.73    5.89   1.27   1.06    0.647   0.189
##  9 Belarus Centr…      61    5.80    5.72    5.88   1.13   1.05    0.631   0.291
## 10 Sloven… Centr…      63    5.77    5.68    5.85   1.30   1.06    0.792   0.532
## # … with 19 more rows, 3 more variables: `Trust (Government Corruption)` &lt;dbl&gt;,
## #   Generosity &lt;dbl&gt;, `Dystopia Residual` &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`Happiness Rank`, ²​`Happiness Score`, ³​`Lower Confidence Interval`,
## #   ⁴​`Upper Confidence Interval`, ⁵​`Economy (GDP per Capita)`,
## #   ⁶​`Health (Life Expectancy)`</code></pre>
<p>А теперь отфильтруем эти значения и возьмем только те значения <code>Happiness Score</code>, которые соответствуют Центральной и восточной Европе</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="R_analysis.html#cb67-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="R_analysis.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="R_analysis.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) </span></code></pre></div>
<pre><code>## # A tibble: 29 × 1
##    `Happiness Score`
##                &lt;dbl&gt;
##  1              6.60
##  2              6.08
##  3              5.99
##  4              5.92
##  5              5.90
##  6              5.86
##  7              5.84
##  8              5.81
##  9              5.80
## 10              5.77
## # … with 19 more rows</code></pre>
<p>.. и “вытащим” эти значения в числовой вектор, чтобы с ними было проще всего работать</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="R_analysis.html#cb69-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="R_analysis.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="R_analysis.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="R_analysis.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() </span></code></pre></div>
<pre><code>##  [1] 6.596 6.078 5.987 5.919 5.897 5.856 5.835 5.813 5.802 5.768 5.658 5.560
## [13] 5.528 5.517 5.488 5.401 5.291 5.185 5.177 5.163 5.161 5.145 5.121 4.996
## [25] 4.655 4.360 4.324 4.252 4.217</code></pre>
<p>И посчитаем среднее</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="R_analysis.html#cb71-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="R_analysis.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="R_analysis.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="R_analysis.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="R_analysis.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] 5.37069</code></pre>
<p>Теперь можем сравнить средний <code>Happiness Score</code> по всем странам (считали его ранее) и только по Центральной и восточной Европе. Что можно про них сказать?</p>
<p>Или посмотрим, какие страны находятся в топе-10 по <code>Happiness Rank</code></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="R_analysis.html#cb73-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="R_analysis.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Happiness Rank</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">10</span>) </span></code></pre></div>
<pre><code>## # A tibble: 10 × 13
##    Country Region Happi…¹ Happi…² Lower…³ Upper…⁴ Econo…⁵ Family Healt…⁶ Freedom
##    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Denmark Weste…       1    7.53    7.46    7.59    1.44   1.16   0.795   0.579
##  2 Switze… Weste…       2    7.51    7.43    7.59    1.53   1.15   0.863   0.586
##  3 Iceland Weste…       3    7.50    7.33    7.67    1.43   1.18   0.867   0.566
##  4 Norway  Weste…       4    7.50    7.42    7.58    1.58   1.13   0.796   0.596
##  5 Finland Weste…       5    7.41    7.35    7.48    1.41   1.13   0.811   0.571
##  6 Canada  North…       6    7.40    7.34    7.47    1.44   1.10   0.828   0.574
##  7 Nether… Weste…       7    7.34    7.28    7.39    1.46   1.03   0.812   0.552
##  8 New Ze… Austr…       8    7.33    7.26    7.40    1.36   1.17   0.831   0.581
##  9 Austra… Austr…       9    7.31    7.24    7.38    1.44   1.10   0.851   0.568
## 10 Sweden  Weste…      10    7.29    7.23    7.36    1.45   1.09   0.831   0.582
## # … with 3 more variables: `Trust (Government Corruption)` &lt;dbl&gt;,
## #   Generosity &lt;dbl&gt;, `Dystopia Residual` &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`Happiness Rank`, ²​`Happiness Score`, ³​`Lower Confidence Interval`,
## #   ⁴​`Upper Confidence Interval`, ⁵​`Economy (GDP per Capita)`,
## #   ⁶​`Health (Life Expectancy)`</code></pre>
</div>
<div id="mutate" class="section level3 hasAnchor" number="13.6.3">
<h3><span class="header-section-number">13.6.3</span> Создание колонок<a href="R_analysis.html#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Часто возникает задача перекодировать переменную – например, разбить непрерывные значения на группы, чтобы посмотреть различия между ними.</p>
<p>Например, продолжая предыдущий пример с фильтрацией первых 10 в рейтинге стран: для сравнения показателей, вклдывающихся в уровень счастья, нас может интересовать, отличаются ли “топовые” страны от всех остальных. Для этого нам проще создать отдельную колонку, которая служит индикатором, является ли страна “топовой”. Разберем, что это значит: нам нужно 1) создать новую колонку и 2) записать в нее значения, удовлятворяющие определенному условию. (1) достигается с помощью функции <code>mutate()</code> (как бы “измени” датафрейм, “примутируй” к нему колонку), а (2) достигается очень похожим на фильтрацию способом – с помощью функции <code>ifelse</code> (<a href="R_analysis.html#operarions">пример выше</a>)</p>
<p>На паре топовые и не топовые страны превратились в <code>hehe</code> и <code>not hehe</code>, так и оставим.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="R_analysis.html#cb75-1" aria-hidden="true" tabindex="-1"></a>whr_top <span class="ot">&lt;-</span> whr <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="R_analysis.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;Rank Category&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Happiness Rank</span><span class="st">`</span> <span class="sc">&lt;=</span><span class="dv">10</span>, <span class="st">&quot;hehe&quot;</span>, <span class="st">&quot;not hehe&quot;</span>))</span>
<span id="cb75-3"><a href="R_analysis.html#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="R_analysis.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(whr_top)</span></code></pre></div>
<p>Если выведем датафрейм, увидим, что на последнем месте появилась новая колонка <code>Rank Category</code>.</p>
<p>Новые значения могут соответствовать и какой-либо математической операции, например, создадим новую колонку, показывающую, во сколько раз уровень счастья в стране превышает значения страны-дистопии:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="R_analysis.html#cb76-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="R_analysis.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;Times&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Dystopia Residual</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="R_analysis.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">View</span>()</span></code></pre></div>
</div>
<div id="NA" class="section level3 hasAnchor" number="13.6.4">
<h3><span class="header-section-number">13.6.4</span> Работа с пропущенными значениями (NA)<a href="R_analysis.html#NA" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Как уже говорилось в разделе про <a href="R_analysis.html#data_types">типы данных</a>, есть отдельный тип данных, который кодирует пропущенные значения – NA, Not Available. Это особенный тип, потому что из-за пропущенных значений мы не можем оценить данные целиком. Такие ситуации встречаются крайне часто, поэтому придуманы специальные способы обращения с NA.</p>
<p>Для изучения этого раздела нам понадобятся данные <code>2016-2</code> по ссылке <a href="https://raw.githubusercontent.com/elenary/StatsForDA/main/2016-2.csv" class="uri">https://raw.githubusercontent.com/elenary/StatsForDA/main/2016-2.csv</a> (правая кнопка мыши – сохранить как)</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="R_analysis.html#cb77-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">&quot;2016-2.csv&quot;</span>)</span>
<span id="cb77-2"><a href="R_analysis.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(whr_new)</span></span></code></pre></div>
<p>Первая важная функция работы с промущенными значениями – это <code>is.na()</code>, проверка того, является ли каждый элемент вектора или датафрейма NA, и механизмы подсчета количества таких значений.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="R_analysis.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##   [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE
##  [13]  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [157] FALSE</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="R_analysis.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#помним, что TRUE -- это 1, а FALSE -- 0. Поэтому можем перевести результаты в числовой вектор</span></span>
<span id="cb80-2"><a href="R_analysis.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">is.na</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>##   [1] 0 0 0 0 0 0 1 1 1 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
## [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
## [149] 0 0 0 0 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="R_analysis.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#подсчет количества NA</span></span>
<span id="cb82-2"><a href="R_analysis.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">as.numeric</span>(<span class="fu">is.na</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="R_analysis.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Одна из больших проблем с этими значениями – они мешают производить вычисления. Когда часть данных отсутствует, невозможно сказать, каково среднее выборки.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="R_analysis.html#cb86-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="R_analysis.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="R_analysis.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="R_analysis.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="R_analysis.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Так происходит, потому что невозможно прибавить, вычесть или даже сравнить с чем-то значение, которое недоступно</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="R_analysis.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">==</span> <span class="cn">NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="R_analysis.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;NA&quot;</span> <span class="sc">==</span> <span class="cn">NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="R_analysis.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">==</span> <span class="cn">NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Для этого пропущенные значения обычно удаляют из рассмотрения. Например, с помощью функции <code>na.omit()</code> в базовом R или с помощью <code>drop_na()</code> в нотации <code>tifdyverse</code>. <strong>Важно!</strong> В зависимости от того, к чему мы применяем эту функции, мы либо удаляем NA из отобранной нами колонки, либо, если применяем ко всему датафрейму – удалятся <strong>все строки</strong>, в которых есть NA хотя бы в одной из колонок.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="R_analysis.html#cb96-1" aria-hidden="true" tabindex="-1"></a>whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span> </span></code></pre></div>
<pre><code>##   [1] 7.526 7.509 7.501 7.498 7.413 7.404    NA    NA    NA 7.291 7.267 7.119
##  [13]    NA 7.087    NA 6.994 6.952 6.929 6.907 6.871 6.778 6.739 6.725 6.705
##  [25] 6.701 6.650 6.596 6.573 6.545 6.488 6.481 6.478 6.474 6.379 6.379 6.375
##  [37] 6.361 6.355 6.324 6.269 6.239 6.218 6.168 6.084 6.078 6.068 6.005 5.992
##  [49] 5.987 5.977 5.976 5.956 5.921 5.919 5.897 5.856 5.835 5.835 5.822 5.813
##  [61] 5.802 5.771 5.768 5.743 5.658 5.648 5.615 5.560 5.546 5.538 5.528 5.517
##  [73] 5.510 5.488 5.458 5.440 5.401 5.389 5.314 5.303 5.291 5.279 5.245 5.196
##  [85] 5.185 5.177 5.163 5.161 5.155 5.151 5.145 5.132 5.129 5.123 5.121 5.061
##  [97] 5.057 5.045 5.033 4.996 4.907 4.876 4.875 4.871 4.813 4.795 4.793 4.754
## [109] 4.655 4.643 4.635 4.575 4.574 4.513 4.508 4.459 4.415 4.404 4.395 4.362
## [121] 4.360 4.356 4.324 4.276 4.272 4.252 4.236 4.219 4.217 4.201 4.193 4.156
## [133] 4.139 4.121 4.073 4.028 3.974 3.956 3.916 3.907 3.866 3.856 3.832 3.763
## [145] 3.739 3.739 3.724 3.695 3.666 3.622 3.607 3.515 3.484 3.360 3.303 3.069
## [157] 2.905</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="R_analysis.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="co"># выдает NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="R_analysis.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">na.omit</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="co"># выдает среднее</span></span></code></pre></div>
<pre><code>## [1] 5.321539</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="R_analysis.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выдает NA</span></span>
<span id="cb102-2"><a href="R_analysis.html#cb102-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="R_analysis.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="R_analysis.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb102-5"><a href="R_analysis.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="R_analysis.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выдает среднее</span></span>
<span id="cb104-2"><a href="R_analysis.html#cb104-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="R_analysis.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="R_analysis.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb104-5"><a href="R_analysis.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb104-6"><a href="R_analysis.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] 5.321539</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="R_analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># обратите внимание -- так тоже работает, но среднее другое! Почему?</span></span>
<span id="cb106-2"><a href="R_analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="R_analysis.html#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb106-4"><a href="R_analysis.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-5"><a href="R_analysis.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb106-6"><a href="R_analysis.html#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] 5.266447</code></pre>
<p>Для работы конкретно с описательным статистиками и аггрегирующими функциями вроде суммы еще есть один лайфхак работы с пропущенными значениями – аргумент <code>na.rm = TRUE</code> внутри функций <code>mean()</code>, <code>median()</code>, <code>sum()</code>. <code>na.rm = TRUE</code> буквально значит “na remove = true”</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="R_analysis.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  через базовый R</span></span>
<span id="cb108-2"><a href="R_analysis.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 5.321539</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="R_analysis.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  или с помощью тайдиверс</span></span>
<span id="cb110-2"><a href="R_analysis.html#cb110-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="R_analysis.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-4"><a href="R_analysis.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="R_analysis.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 5.321539</code></pre>
</div>
<div id="sorting" class="section level3 hasAnchor" number="13.6.5">
<h3><span class="header-section-number">13.6.5</span> Сортировка<a href="R_analysis.html#sorting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Еще одна часто встречающая задача – отсортировать датафрейм по возрастанию или убыванию одной переменной.</p>
<p>В базовом R когда у нас есть только один вектор, мы можем сделать это так</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="R_analysis.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##   [1] 2.905 3.069 3.303 3.360 3.484 3.515 3.607 3.622 3.666 3.695 3.724 3.739
##  [13] 3.739 3.763 3.832 3.856 3.866 3.907 3.916 3.956 3.974 4.028 4.073 4.121
##  [25] 4.139 4.156 4.193 4.201 4.217 4.219 4.236 4.252 4.272 4.276 4.324 4.356
##  [37] 4.360 4.362 4.395 4.404 4.415 4.459 4.508 4.513 4.574 4.575 4.635 4.643
##  [49] 4.655 4.754 4.793 4.795 4.813 4.871 4.875 4.876 4.907 4.996 5.033 5.045
##  [61] 5.057 5.061 5.121 5.123 5.129 5.132 5.145 5.151 5.155 5.161 5.163 5.177
##  [73] 5.185 5.196 5.245 5.279 5.291 5.303 5.314 5.389 5.401 5.440 5.458 5.488
##  [85] 5.510 5.517 5.528 5.538 5.546 5.560 5.615 5.648 5.658 5.743 5.768 5.771
##  [97] 5.802 5.813 5.822 5.835 5.835 5.856 5.897 5.919 5.921 5.956 5.976 5.977
## [109] 5.987 5.992 6.005 6.068 6.078 6.084 6.168 6.218 6.239 6.269 6.324 6.355
## [121] 6.361 6.375 6.379 6.379 6.474 6.478 6.481 6.488 6.545 6.573 6.596 6.650
## [133] 6.701 6.705 6.725 6.739 6.778 6.871 6.907 6.929 6.952 6.994 7.087 7.119
## [145] 7.267 7.291 7.404 7.413 7.498 7.501 7.509 7.526</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="R_analysis.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   [1] 7.526 7.509 7.501 7.498 7.413 7.404 7.291 7.267 7.119 7.087 6.994 6.952
##  [13] 6.929 6.907 6.871 6.778 6.739 6.725 6.705 6.701 6.650 6.596 6.573 6.545
##  [25] 6.488 6.481 6.478 6.474 6.379 6.379 6.375 6.361 6.355 6.324 6.269 6.239
##  [37] 6.218 6.168 6.084 6.078 6.068 6.005 5.992 5.987 5.977 5.976 5.956 5.921
##  [49] 5.919 5.897 5.856 5.835 5.835 5.822 5.813 5.802 5.771 5.768 5.743 5.658
##  [61] 5.648 5.615 5.560 5.546 5.538 5.528 5.517 5.510 5.488 5.458 5.440 5.401
##  [73] 5.389 5.314 5.303 5.291 5.279 5.245 5.196 5.185 5.177 5.163 5.161 5.155
##  [85] 5.151 5.145 5.132 5.129 5.123 5.121 5.061 5.057 5.045 5.033 4.996 4.907
##  [97] 4.876 4.875 4.871 4.813 4.795 4.793 4.754 4.655 4.643 4.635 4.575 4.574
## [109] 4.513 4.508 4.459 4.415 4.404 4.395 4.362 4.360 4.356 4.324 4.276 4.272
## [121] 4.252 4.236 4.219 4.217 4.201 4.193 4.156 4.139 4.121 4.073 4.028 3.974
## [133] 3.956 3.916 3.907 3.866 3.856 3.832 3.763 3.739 3.739 3.724 3.695 3.666
## [145] 3.622 3.607 3.515 3.484 3.360 3.303 3.069 2.905</code></pre>
<p>В тайдиверс – с помощью функции <code>arrange()</code>, где в качестве аргумента передается название колонки, по которой будем делать сортировку. А если нам нужно указать, что сортировка должна быть по убыванию, от большого к меньшего – необходимо вставить аргумент <code>desc()</code></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="R_analysis.html#cb116-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="R_analysis.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb116-3"><a href="R_analysis.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb116-4"><a href="R_analysis.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="co"># сортировка по возрастанию</span></span></code></pre></div>
<pre><code>## # A tibble: 132 × 1
##    `Happiness Score`
##                &lt;dbl&gt;
##  1              2.90
##  2              3.07
##  3              3.30
##  4              3.36
##  5              3.48
##  6              3.52
##  7              3.62
##  8              3.67
##  9              3.70
## 10              3.74
## # … with 122 more rows</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="R_analysis.html#cb118-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb118-2"><a href="R_analysis.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="R_analysis.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="R_analysis.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="co"># сортировка по убыванию</span></span></code></pre></div>
<pre><code>## # A tibble: 132 × 1
##    `Happiness Score`
##                &lt;dbl&gt;
##  1              7.53
##  2              7.51
##  3              7.50
##  4              7.29
##  5              7.12
##  6              6.99
##  7              6.95
##  8              6.91
##  9              6.87
## 10              6.78
## # … with 122 more rows</code></pre>
<p>Самое интересное здесь – что мы можем сортировать весь датафрейм по значениям одной переменной</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="R_analysis.html#cb120-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="R_analysis.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="R_analysis.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Freedom) <span class="co"># сорируем по значениям переменной Freedom</span></span></code></pre></div>
<pre><code>## # A tibble: 132 × 13
##    Country Region Happi…¹ Happi…² Lower…³ Upper…⁴ Econo…⁵ Family Healt…⁶ Freedom
##    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Sudan   Sub-S…     133    4.14    3.93    4.35   0.631  0.819   0.298 0      
##  2 Angola  Sub-S…     141    3.87    3.75    3.98   0.847  0.664   0.05  0.00589
##  3 Burundi Sub-S…     157    2.90    2.73    3.08   0.068  0.234   0.157 0.0432 
##  4 Greece  Weste…      99    5.03    4.93    5.13   1.25   0.755   0.8   0.0582 
##  5 Syria   Middl…     156    3.07    2.94    3.20   0.747  0.149   0.63  0.0691 
##  6 Bosnia… Centr…      87    5.16    5.06    5.26   0.934  0.644   0.708 0.0951 
##  7 Haiti   Latin…     136    4.03    3.89    4.16   0.341  0.296   0.275 0.121  
##  8 Maurit… Sub-S…     130    4.20    4.13    4.28   0.614  0.841   0.286 0.127  
##  9 Ukraine Centr…     123    4.32    4.24    4.41   0.873  1.01    0.586 0.129  
## 10 Madaga… Sub-S…     148    3.70    3.62    3.77   0.28   0.461   0.371 0.137  
## # … with 122 more rows, 3 more variables:
## #   `Trust (Government Corruption)` &lt;dbl&gt;, Generosity &lt;dbl&gt;,
## #   `Dystopia Residual` &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`Happiness Rank`, ²​`Happiness Score`, ³​`Lower Confidence Interval`,
## #   ⁴​`Upper Confidence Interval`, ⁵​`Economy (GDP per Capita)`,
## #   ⁶​`Health (Life Expectancy)`</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="R_analysis.html#cb122-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="R_analysis.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb122-3"><a href="R_analysis.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">Trust (Government Corruption)</span><span class="st">`</span>) <span class="co"># сорируем по значениям переменной Trust</span></span></code></pre></div>
<pre><code>## # A tibble: 132 × 13
##    Country Region Happi…¹ Happi…² Lower…³ Upper…⁴ Econo…⁵ Family Healt…⁶ Freedom
##    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Bosnia… Centr…      87    5.16    5.06    5.26   0.934  0.644   0.708  0.0951
##  2 Bulgar… Centr…     129    4.22    4.10    4.33   1.11   0.925   0.678  0.212 
##  3 Romania Centr…      71    5.53    5.43    5.63   1.17   0.728   0.676  0.367 
##  4 Trinid… Latin…      43    6.17    5.95    6.39   1.33   0.986   0.526  0.485 
##  5 Portug… Weste…      94    5.12    5.03    5.22   1.28   0.944   0.794  0.447 
##  6 Lithua… Centr…      60    5.81    5.73    5.89   1.27   1.06    0.647  0.189 
##  7 Ukraine Centr…     123    4.32    4.24    4.41   0.873  1.01    0.586  0.129 
##  8 Moldova Centr…      55    5.90    5.82    5.97   0.692  0.831   0.523  0.252 
##  9 Italy   Weste…      50    5.98    5.90    6.06   1.36   1.04    0.851  0.188 
## 10 China   Easte…      83    5.24    5.20    5.29   1.03   0.794   0.736  0.440 
## # … with 122 more rows, 3 more variables:
## #   `Trust (Government Corruption)` &lt;dbl&gt;, Generosity &lt;dbl&gt;,
## #   `Dystopia Residual` &lt;dbl&gt;, and abbreviated variable names
## #   ¹​`Happiness Rank`, ²​`Happiness Score`, ³​`Lower Confidence Interval`,
## #   ⁴​`Upper Confidence Interval`, ⁵​`Economy (GDP per Capita)`,
## #   ⁶​`Health (Life Expectancy)`</code></pre>
</div>
</div>
<div id="tasks_sem3" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Задания после семинара 3<a href="R_analysis.html#tasks_sem3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Выполните все примеры, которые есть в этом разделе, убедитесь, что все работает верно.</li>
<li>Посмотрите, какие страны находятся на местах с 1 по 10 и с 147 по 157 (в выводе должно быть по две колонки: <code>Region</code> и <code>Happiness Rank</code>)</li>
<li>Сравните средний показатель экономики <code>Economy (GDP per Capita)</code> и уровень счастья <code>Happiness Score</code> в странах Восточной и центральной (Central and Eastern Europe) и Западной Европы (Western Europe). Что можно сказать про них? Где показатель экономики выше? Где люди чувствуют себя счастливее?</li>
<li>Сравните средний показатель экономики<code>Economy (GDP per Capita)</code> и уровень счастья <code>Happiness Score</code> в странах Западной Европы (Western Europe) и Южной Азии (Southern Asia). Что можно сказать про них? Где показатель экономики выше? Где люди чувствуют себя счастливее?</li>
<li><em>(Только для тех, кто работает в R)</em> Посчитайте средний <code>Happiness Score</code> по всем странам и выведете страны, которые лежат в границах ± 1 от среднего <code>Happiness Score</code> (в выводе должно быть по две колонки: <code>Region</code> и <code>Happiness Score</code>) <em>Подсказка: возможно, будет проще посчитать среднее отдельно и сначала сохранить его в переменную</em></li>
<li>Создайте колонку, в которой будет содержаться информация, в текущей стране <code>Happiness Score</code> выше или ниже среднего значения (колонка может быть заполнена, например, значениями upper и lower или любыми другими обозначениями)</li>
</ol>
</div>
<div id="descriptives_r" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Описательные статистики и агрегация<a href="R_analysis.html#descriptives_r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="описательные-статистики" class="section level3 hasAnchor" number="13.8.1">
<h3><span class="header-section-number">13.8.1</span> Описательные статистики<a href="R_analysis.html#описательные-статистики" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Мы уже немножко считали описательные статистики в самом начале работы с данными, чтобы было пободрее продвигаться. Теперь давайте остановимся на них поподробнее.</p>
<p>Самые частые описательные статистики из мер центральной тенденции – среднее, медиана и мода. Среднее и медиану мы уже строили, а как построить моду?</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="R_analysis.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 5.321539</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="R_analysis.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 5.285</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="R_analysis.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   2.905   4.387   5.285   5.322   6.105   7.526       5</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="R_analysis.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mode(whr_new$`Happiness Score`, na.rm = TRUE) #выдаст ошибку</span></span>
<span id="cb130-2"><a href="R_analysis.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mode(whr_new$`Happiness Score`)</span></span></code></pre></div>
<p>Так получилось, что в R нет специальной функции для моды. У этого есть и логическая причина – жанные, с которыми мы в основном работаем – количественные непрерывные, и мы обсуждали, что для такого рода данных понятие моды немного искуственно. Но нам все равно бывает нужно посчитать моду. Поэтому можно либо написать функцию для ее расчета самостоятельно, либо воспользоваться готовой функцией из пакета. Я погуглила, что можно сделать, и вам рекомендую всегда так делать в таких ситуациях – и выбрала функцию <code>mlv()</code> (most likely value) из пакета <code>modeest</code></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="R_analysis.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;modeest&quot;)</span></span>
<span id="cb131-2"><a href="R_analysis.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modeest)</span>
<span id="cb131-3"><a href="R_analysis.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mlv</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning: argument &#39;method&#39; is missing. Data are supposed to be continuous. 
##             Default method &#39;shorth&#39; is used</code></pre>
<pre><code>## [1] 5.239092</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="R_analysis.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mlv</span>(whr_new<span class="sc">$</span>Region, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Sub-Saharan Africa&quot;</code></pre>
<p>Либо, можно воспользоваться простой функцией <code>table()</code>, которая считает количество значений указанной переменной.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="R_analysis.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(whr_new<span class="sc">$</span>Region)</span></code></pre></div>
<pre><code>## 
##       Australia and New Zealand      Central and Eastern Europe 
##                               2                              29 
##                    Eastern Asia     Latin America and Caribbean 
##                               6                              24 
## Middle East and Northern Africa                   North America 
##                              19                               2 
##               Southeastern Asia                   Southern Asia 
##                               9                               7 
##              Sub-Saharan Africa                  Western Europe 
##                              38                              21</code></pre>
<p>Помимо мер центральной тенденции можем посчитать меры изменчивости – минимальное и максимальное, размах, стандартное отклонение, дисперсию, межквартильный размах.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="R_analysis.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 2.905</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="R_analysis.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## [1] 7.526</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="R_analysis.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(whr<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="co">#размах</span></span></code></pre></div>
<pre><code>## [1] 2.905 7.526</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="R_analysis.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co">#стандартное отклонение</span></span></code></pre></div>
<pre><code>## [1] 1.108958</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="R_analysis.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co">#дисперсия</span></span></code></pre></div>
<pre><code>## [1] 1.229787</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="R_analysis.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co">#межквартильный размах</span></span></code></pre></div>
<pre><code>## [1] 1.71825</code></pre>
<p>Мы так же рассчитывали описательные статистики с помощью функции <code>summary()</code>. Есть более продвинутые функции, которые считают большое количество описательных статистик сразу. Например, часто используется функция skim() из пакета skimr – помимо мер центральной тенденции и всех четырех квартителей, она считает стандартное отклонение и даже строит маленькую гистограммку.
summary(whr_new$<code>Happiness Score</code>)</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="R_analysis.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   2.905   4.387   5.285   5.322   6.105   7.526       5</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="R_analysis.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;skimr&quot;)</span></span>
<span id="cb152-2"><a href="R_analysis.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb152-3"><a href="R_analysis.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-39">Table 13.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">whr_new$Happiness Score</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">157</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="18%" />
<col width="12%" />
<col width="18%" />
<col width="6%" />
<col width="6%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="5%" />
<col width="6%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">data</td>
<td align="right">5</td>
<td align="right">0.97</td>
<td align="right">5.32</td>
<td align="right">1.11</td>
<td align="right">2.9</td>
<td align="right">4.39</td>
<td align="right">5.28</td>
<td align="right">6.1</td>
<td align="right">7.53</td>
<td align="left">▂▆▇▇▃</td>
</tr>
</tbody>
</table>
</div>
<div id="aggregate" class="section level3 hasAnchor" number="13.8.2">
<h3><span class="header-section-number">13.8.2</span> Агрегация данных<a href="R_analysis.html#aggregate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Что произошло, когда мы смотрели частоту выпадения значений с помощью <code>table()</code>? Данные сгруппировались по значениям переменной <code>Region</code>, которую мы указали, и было посчитано количество значений в каждой группе. Когда мы группируем данные по значениям переменной и производим какой-либо расчет для группы, это называется <strong>агрегацией</strong> данных.</p>
<p>Это полезно, чтобы посчитать те же описательные статистики по группам, например, посчитаем среднее для переменных Freedom и Trust в зависимости от региона:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="R_analysis.html#cb153-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="R_analysis.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="R_analysis.html#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="R_analysis.html#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## # A tibble: 8 × 2
##   Region                          mean_score
##   &lt;chr&gt;                                &lt;dbl&gt;
## 1 Central and Eastern Europe            5.40
## 2 Eastern Asia                          5.62
## 3 Latin America and Caribbean           6.01
## 4 Middle East and Northern Africa       5.39
## 5 Southeastern Asia                     5.16
## 6 Southern Asia                         4.56
## 7 Sub-Saharan Africa                    4.16
## 8 Western Europe                        6.55</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="R_analysis.html#cb155-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="R_analysis.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="R_analysis.html#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="R_analysis.html#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>), <span class="at">mean_freedom =</span> <span class="fu">mean</span>(Freedom),</span>
<span id="cb155-5"><a href="R_analysis.html#cb155-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_trust =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Trust (Government Corruption)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb155-6"><a href="R_analysis.html#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_score))</span></code></pre></div>
<pre><code>## # A tibble: 8 × 4
##   Region                          mean_score mean_freedom mean_trust
##   &lt;chr&gt;                                &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1 Western Europe                        6.55        0.452     0.213 
## 2 Latin America and Caribbean           6.01        0.419     0.105 
## 3 Eastern Asia                          5.62        0.387     0.118 
## 4 Central and Eastern Europe            5.40        0.292     0.0770
## 5 Middle East and Northern Africa       5.39        0.316     0.178 
## 6 Southeastern Asia                     5.16        0.495     0.124 
## 7 Southern Asia                         4.56        0.350     0.105 
## 8 Sub-Saharan Africa                    4.16        0.324     0.125</code></pre>
</div>
</div>
<div id="visualization" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Визуализации<a href="R_analysis.html#visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Мы уже строили простенькие визуализации – простую гистограмму и простой график плотноти веростности средствами базового R.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="R_analysis.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="R_analysis.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(whr_new<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<p>Эти визуализации верны, но они стандартные и выглядят не очень красиво. А меж тем визуализации очень важны – от их качества зависит понятность представления данных, с помощью визуилизаций можно даже манипулировать данными. В скриптовых языках огромное количество инструментов для работы с визуализациями. В питоне это matplotlib. А теперь добро пожаловать в ggplot2 – вселенную графиков в R <a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a></p>
<p>Например, можно нарисовать такой <a href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fadrienne-marshall.github.io%2Fggplot2_workshop%2F&amp;psig=AOvVaw1y2l2bObt_HK2KcP7m_73h&amp;ust=1676402334991000&amp;source=images&amp;cd=vfe&amp;ved=0CBAQjRxqFwoTCNihzL-bk_0CFQAAAAAdAAAAABAJ">график</a>, или <a href="https://edaoud.com/assets/img/articles/maps-ggplot2/map_1.png">такой</a>. Все это достигается средствами пакета <code>ggplot2</code>, который уже интегрирован в <code>tidyverse</code>.</p>
<p>“gg” в названии пакета означает Grammar of graphics. Подробно можно почитать, например, у Ивана Позднякова <a href="https://pozdniakov.github.io/tidy_stats/230-ggplot2.html" class="uri">https://pozdniakov.github.io/tidy_stats/230-ggplot2.html</a></p>
<p>Принцип состоит из рисовки графиком по слоям.
Обязательные слои:</p>
<ul>
<li>данные (data)</li>
<li>эстетики (aes) или mapping – то, как наши данные “натягиваются” на график</li>
<li>геомы (geom) – геометрические объекты, которые будем рисовать (например, гистограмма или барплот)</li>
</ul>
<p>Вспомогательные слои:</p>
<ul>
<li>статистики (stats) – нужно ли посчитать какие-то агрегированные статистики прямо на графике</li>
<li>система координат (coord) – можно повернуть систему координат на 90 градусов или вообще заменить ее на полярную</li>
<li>темы (theme) – системы оформления, одно из самых приятных</li>
</ul>
<p align="center">
<img src="docs/images/gglayers.png" width="80%" style="display: block; margin: auto;" />
Изображение из <a href="https://link.springer.com/book/10.1007/0-387-28695-0">The Grammar of Graphics</a>
</p>
<p>ggplot отлично интегрируется с тайдиверс, но он появился, оформился и распространился раньше, поэтому вместо значка пайпа <code>%&gt;%</code> там <code>+</code>.
Нарисуем ту же гистограмму, но уже покрасивее:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="R_analysis.html#cb159-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb159-2"><a href="R_analysis.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb159-3"><a href="R_analysis.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb159-4"><a href="R_analysis.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="R_analysis.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Можем регулировать ширину &quot;кирпичика&quot;</span></span>
<span id="cb161-2"><a href="R_analysis.html#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="R_analysis.html#cb161-3" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb161-4"><a href="R_analysis.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb161-5"><a href="R_analysis.html#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb161-6"><a href="R_analysis.html#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-43-2.png" width="672" /></p>
<p>Можем менять цвета у двух вещей: заливки и контура, как и обычно у фигур в паверпоинте или ворде. Для заливки используется аругмент fill, для контура – color. У некоторых геомов есть только контур – как, например, диаграмма рассеяния, так как точки не имеют заливки.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="R_analysis.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># раскрасим заливку (fill) в розовый, а линии (color) в фиолетовый</span></span>
<span id="cb163-2"><a href="R_analysis.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co"># можем использовать не слова вроде pink и violet, а коды цветов в 16-ричной системе, например &quot;#355C7D&quot;</span></span>
<span id="cb163-3"><a href="R_analysis.html#cb163-3" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb163-4"><a href="R_analysis.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb163-5"><a href="R_analysis.html#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">color =</span> <span class="st">&quot;violet&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb163-6"><a href="R_analysis.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="R_analysis.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим 50% прозрачности</span></span>
<span id="cb165-2"><a href="R_analysis.html#cb165-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="R_analysis.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb165-4"><a href="R_analysis.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">color =</span> <span class="st">&quot;violet&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb165-5"><a href="R_analysis.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-44-2.png" width="672" /></p>
<p>Построим аналогичный график плотности вероятности</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="R_analysis.html#cb167-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span> </span>
<span id="cb167-2"><a href="R_analysis.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb167-3"><a href="R_analysis.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb167-4"><a href="R_analysis.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_density()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="R_analysis.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># раскрасим линию в фиолетовый</span></span>
<span id="cb169-2"><a href="R_analysis.html#cb169-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="R_analysis.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb169-4"><a href="R_analysis.html#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;violet&quot;</span>) <span class="sc">+</span></span>
<span id="cb169-5"><a href="R_analysis.html#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_density()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="R_analysis.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># поменяем тип линии на пунктир (соответствие типов линий и кодов</span></span>
<span id="cb171-2"><a href="R_analysis.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co"># можно погуглить или посмотреть в читшите)</span></span>
<span id="cb171-3"><a href="R_analysis.html#cb171-3" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb171-4"><a href="R_analysis.html#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb171-5"><a href="R_analysis.html#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;violet&quot;</span>, <span class="at">linetype =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb171-6"><a href="R_analysis.html#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_density()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-45-3.png" width="672" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="R_analysis.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#добавили заливку и прозрачность</span></span>
<span id="cb173-2"><a href="R_analysis.html#cb173-2" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="R_analysis.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb173-4"><a href="R_analysis.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;violet&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">linetype =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb173-5"><a href="R_analysis.html#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (`stat_density()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-45-4.png" width="672" /></p>
<p>Все эти графики были описательными – для исследования одной переменной. А теперь выведем диаграмму рассеяния, в которой показано распределение одной переменной в заивисимости от значений другой.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="R_analysis.html#cb175-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb175-2"><a href="R_analysis.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">y =</span> Freedom)) <span class="sc">+</span></span>
<span id="cb175-3"><a href="R_analysis.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb175-4"><a href="R_analysis.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>И можем даже раскрасить точки на этом графике в зависимости от третьей переменной! Например, региона. Все ровно так же, как и с цветами до этого: если хотим залить фигуру в зависимости от значений третьей переменной, то для раскраски используется аругмент fill, если покрасить контур – то color (как контур и заливка в ворде или паверпоинт). Но с той разницей, что теперь fill color задаются <strong>внутри аестетик</strong>, так как это все еще про “натягивание совы на глобус”, то есть наших данных на график.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="R_analysis.html#cb177-1" aria-hidden="true" tabindex="-1"></a>whr_new <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="R_analysis.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">y =</span> Freedom, <span class="at">color =</span> Region)) <span class="sc">+</span></span>
<span id="cb177-3"><a href="R_analysis.html#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb177-4"><a href="R_analysis.html#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="tasks_sem4" class="section level2 hasAnchor" number="13.10">
<h2><span class="header-section-number">13.10</span> Задания после семинара 4<a href="R_analysis.html#tasks_sem4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Для заданий используется датасет <a href="https://raw.githubusercontent.com/elenary/StatsForDA/main/2016-2.csv"><code>2016-2</code></a></p>
<ol style="list-style-type: decimal">
<li>Посчитайте, сколько всего суммарно NA в колонках <code>Economy (GDP per Capita)</code>, <code>Family</code>, <code>Health (Life Expectancy)</code>, <code>Freedom</code>, <code>Trust (Government Corruption)</code>, <code>Generosity</code> <em>(задание можно сделать разными способами, подойдет любой, дающий верный овтет)</em></li>
<li>Посчитайте описательные статистики для колонок <code>Economy (GDP per Capita)</code>, <code>Family</code>, <code>Freedom</code>: среднее, медиану, моду, стандартное отклонение, дисперсию и межквартильный размах, а также <em>(только для тех, кто работает в R)</em> вычислите значения для 1 и 3 квартилей. Ответы должны быть отличны от <code>NA</code> <em>(один из способов узнать значения по квартилям – например, с помощью отдельных общих функций для описательных статистик)</em>.</li>
<li>Используя созданную в <a href="R_analysis.html#tasks_sem3">прошлой домашке</a> колонку co значениями <code>upper</code> и <code>lower</code> в зависимости от значений <code>Happiness Score</code>, посчитайте среднее и стандартное отклонения внутри этих групп (<code>upper</code> и <code>lower</code>) для колонок <code>Economy (GDP per Capita)</code>, <code>Family</code>, <code>Freedom</code>. <em>(Только для тех, кто работает в R)</em> Сравните полученные средние значения со значениями для 1 и 3 квартилей из предыдущего задания. Что можно сказать про них?</li>
<li>Постройте графики плотности вероятности для переменных <code>Family</code> и <code>Freedom</code>, <em>(только для тех, кто работает в R)</em> используя как минимум 2 отличиные от дефолтных настройки (тему, цвет, тип линии, прозрачность и тд.) Примеры можно погуглить или посмотреть в <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf">читшите</a></li>
<li>Постройте диаграмму рассеяния для переменной <code>Family</code> по переменной <code>Freedom</code> и <em>(только для тех, кто работает в R)</em> раскрасьте точки в зависимости от значений переменной с upper и lower, созданной в прошлой домашке.</li>
<li>Посчитайте коэффициент корреляции между переменными <code>Family</code> и <code>Freedom</code>.</li>
</ol>
</div>
<div id="проверка-гипотез" class="section level2 hasAnchor" number="13.11">
<h2><span class="header-section-number">13.11</span> Проверка гипотез<a href="R_analysis.html#проверка-гипотез" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Пришло время перейти к тому, ради чего мы изучали статистику весь прошлый семестр – проверке гипотез.</p>
<p>Я собрала в один датасет все новые колонки, которые мы создавали, чтобы использовать их, если понадобятся.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="R_analysis.html#cb179-1" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="R_analysis.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;top20&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Happiness Rank</span><span class="st">`</span><span class="sc">&lt;=</span><span class="dv">20</span>, <span class="st">&quot;hehe&quot;</span>, <span class="st">&quot;not hehe&quot;</span>),</span>
<span id="cb179-3"><a href="R_analysis.html#cb179-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;mean_position&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span><span class="sc">&gt;=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;upper&quot;</span>, <span class="st">&quot;lower&quot;</span>)) <span class="ot">-&gt;</span> whr_tests</span></code></pre></div>
<p>Перед применением статистических тестов стоит повторить раздел про <a href="inference.html#inference">статистический вывод целиком</a> и <a href="inference.html#nhst">алгоритм тестирования гипотез в частности</a>. Мы не применяем тесты сразу! Сначала у нас должна быть осмысленная гипотеза, понимание о том, каковы <span class="math inline">\(H_0\)</span> и <span class="math inline">\(H_1\)</span>, выбранный уровень значимости <span class="math inline">\(\alpha\)</span> и рассчитанное на основании статистической мощности <span class="math inline">\(power\)</span> необходимое количество данных. Здесь мы работаем уже с готовыми данными, поэтому не можем влиять на количество данных, но все остальные пункты мы должны учитывать.</p>
<div id="корреляционный-тест-1" class="section level3 hasAnchor" number="13.11.1">
<h3><span class="header-section-number">13.11.1</span> Корреляционный тест<a href="R_analysis.html#корреляционный-тест-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Первое, с чем потренируемся – <a href="stats_criteria_linear.html#corr_test">корреляционный тест</a></p>
<p>Сначала проверяем допущения к применимости корреляционного теста</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="R_analysis.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Смотрим наличие линейной зависимости</span></span>
<span id="cb180-2"><a href="R_analysis.html#cb180-2" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="R_analysis.html#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Family, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb180-4"><a href="R_analysis.html#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb180-5"><a href="R_analysis.html#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="R_analysis.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># смотрим, как распределены переменные, которые хотим прокоррелировать</span></span>
<span id="cb181-2"><a href="R_analysis.html#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="R_analysis.html#cb181-3" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="R_analysis.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Family, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb181-5"><a href="R_analysis.html#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb181-6"><a href="R_analysis.html#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="R_analysis.html#cb182-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="R_analysis.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb182-3"><a href="R_analysis.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-4"><a href="R_analysis.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-3.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="R_analysis.html#cb183-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb183-2"><a href="R_analysis.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span>Family)) <span class="sc">+</span></span>
<span id="cb183-3"><a href="R_analysis.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-4"><a href="R_analysis.html#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-4.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="R_analysis.html#cb184-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="R_analysis.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> Family)) <span class="sc">+</span></span>
<span id="cb184-3"><a href="R_analysis.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb184-4"><a href="R_analysis.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb184-5"><a href="R_analysis.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-5.png" width="672" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="R_analysis.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Видим, что переменная Family распрееделена доволньо сильно отлично от нормального, на всякий случай делаем корреляцию Спирмена вместо Пирсона</span></span>
<span id="cb185-2"><a href="R_analysis.html#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="R_analysis.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(whr_tests<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, whr_tests<span class="sc">$</span>Family, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(whr_tests$`Happiness Score`, whr_tests$Family, :
## Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  whr_tests$`Happiness Score` and whr_tests$Family
## S = 153450, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##      rho 
## 0.762077</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="R_analysis.html#cb188-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="R_analysis.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Freedom, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb188-3"><a href="R_analysis.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-4"><a href="R_analysis.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-6.png" width="672" /></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="R_analysis.html#cb189-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb189-2"><a href="R_analysis.html#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Freedom)) <span class="sc">+</span></span>
<span id="cb189-3"><a href="R_analysis.html#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-4"><a href="R_analysis.html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-7.png" width="672" /></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="R_analysis.html#cb190-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="R_analysis.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> Freedom)) <span class="sc">+</span></span>
<span id="cb190-3"><a href="R_analysis.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb190-4"><a href="R_analysis.html#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb190-5"><a href="R_analysis.html#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-49-8.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="R_analysis.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># А здесь можно корреляцию Пирсона</span></span>
<span id="cb191-2"><a href="R_analysis.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(whr_tests<span class="sc">$</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, whr_tests<span class="sc">$</span>Family, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  whr_tests$`Happiness Score` and whr_tests$Family
## t = 13.667, df = 155, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.6589122 0.8029161
## sample estimates:
##       cor 
## 0.7392516</code></pre>
<p>Как это проинтепретировать? Вспоминаем все, что мы изучали про статистические критерии в прошлом семестре.</p>
<p>Кстати, в языках программирования числа часто записываются через экспоненциальную нотацию виде <span class="math inline">\(e^-10\)</span> – это удобно для математического вида, какая цифра идет первой после множества нулей, но неудобно для интерпретации. Чтобы ее убрать, можно в любом месте в Р выполнить операцию</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="R_analysis.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code></pre></div>
<p>Корреляционные матрицы</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="R_analysis.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># корреляция по простому</span></span>
<span id="cb194-2"><a href="R_analysis.html#cb194-2" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="R_analysis.html#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span><span class="sc">:</span>Generosity, <span class="sc">-</span><span class="st">`</span><span class="at">Upper Confidence Interval</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Lower Confidence Interval</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb194-4"><a href="R_analysis.html#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-5"><a href="R_analysis.html#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) </span></code></pre></div>
<pre><code>##                               Happiness Score Economy (GDP per Capita) Family
## Happiness Score                          1.00                     0.81   0.76
## Economy (GDP per Capita)                 0.81                     1.00   0.70
## Family                                   0.76                     0.70   1.00
## Health (Life Expectancy)                 0.77                     0.86   0.62
## Freedom                                  0.56                     0.40   0.51
## Trust (Government Corruption)            0.31                     0.22   0.18
## Generosity                               0.15                     0.00   0.12
##                               Health (Life Expectancy) Freedom
## Happiness Score                                   0.77    0.56
## Economy (GDP per Capita)                          0.86    0.40
## Family                                            0.62    0.51
## Health (Life Expectancy)                          1.00    0.35
## Freedom                                           0.35    1.00
## Trust (Government Corruption)                     0.17    0.47
## Generosity                                        0.08    0.40
##                               Trust (Government Corruption) Generosity
## Happiness Score                                        0.31       0.15
## Economy (GDP per Capita)                               0.22       0.00
## Family                                                 0.18       0.12
## Health (Life Expectancy)                               0.17       0.08
## Freedom                                                0.47       0.40
## Trust (Government Corruption)                          1.00       0.25
## Generosity                                             0.25       1.00</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="R_analysis.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Hmisc&quot;</span>)</span>
<span id="cb196-2"><a href="R_analysis.html#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="R_analysis.html#cb196-3" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb196-4"><a href="R_analysis.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span><span class="sc">:</span>Generosity, <span class="sc">-</span><span class="st">`</span><span class="at">Upper Confidence Interval</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Lower Confidence Interval</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb196-5"><a href="R_analysis.html#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb196-6"><a href="R_analysis.html#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rcorr</span>() <span class="ot">-&gt;</span> whr_cor</span>
<span id="cb196-7"><a href="R_analysis.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="R_analysis.html#cb196-8" aria-hidden="true" tabindex="-1"></a>whr_cor<span class="sc">$</span>r</span></code></pre></div>
<pre><code>##                               Happiness Score Economy (GDP per Capita)
## Happiness Score                     1.0000000               0.79032202
## Economy (GDP per Capita)            0.7903220               1.00000000
## Family                              0.7392516               0.66953969
## Health (Life Expectancy)            0.7653843               0.83706723
## Freedom                             0.5668267               0.36228285
## Trust (Government Corruption)       0.4020322               0.29418478
## Generosity                          0.1568478              -0.02553066
##                                   Family Health (Life Expectancy)   Freedom
## Happiness Score               0.73925158               0.76538433 0.5668267
## Economy (GDP per Capita)      0.66953969               0.83706723 0.3622828
## Family                        1.00000000               0.58837678 0.4502082
## Health (Life Expectancy)      0.58837678               1.00000000 0.3411993
## Freedom                       0.45020820               0.34119929 1.0000000
## Trust (Government Corruption) 0.21356094               0.24958329 0.5020540
## Generosity                    0.08962885               0.07598731 0.3617513
##                               Trust (Government Corruption)  Generosity
## Happiness Score                                   0.4020322  0.15684780
## Economy (GDP per Capita)                          0.2941848 -0.02553066
## Family                                            0.2135609  0.08962885
## Health (Life Expectancy)                          0.2495833  0.07598731
## Freedom                                           0.5020540  0.36175133
## Trust (Government Corruption)                     1.0000000  0.30592986
## Generosity                                        0.3059299  1.00000000</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="R_analysis.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb198-2"><a href="R_analysis.html#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="R_analysis.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(whr_cor<span class="sc">$</span>r, <span class="at">method=</span><span class="st">&quot;circle&quot;</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="R_analysis.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># corrplot(whr_cor$r, p.mat = whr_cor$P, sig.level = 0.05, insig = &quot;blank&quot;)</span></span>
<span id="cb199-2"><a href="R_analysis.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(whr_cor<span class="sc">$</span>r)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
</div>
<div id="т-тест" class="section level3 hasAnchor" number="13.11.2">
<h3><span class="header-section-number">13.11.2</span> Т-тест<a href="R_analysis.html#т-тест" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Теперь проверим гипотезу о том, что уровень счастья <code>Happiness Score</code> отличается в Восточной и Западной Европе. Для этого сначала нам нужно отфильтровать только те данные, которые соответствуют регионам <code>Central and Eastern Europe</code> и <code>Western Europe</code>. Это тот самый этап предобработки данных, когда прежде чем применять статистчиеские тесты, нам нужно подготовить данные.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="R_analysis.html#cb200-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb200-2"><a href="R_analysis.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span>) <span class="ot">-&gt;</span> whr_ttest</span></code></pre></div>
<p>Идем по <a href="inference.html#nhst">алгоритму NHST</a>: фомулируем нулевую и альтернативную гипотезы, выбираем уровень значимости, доходим до выбора статистического теста, и выбираем т-тест. Теперь <a href="stats_criteria_ttest_anova.html#ttest">проверяем допущения для т-теста</a></p>
<p>Для т-теста нам важно допущение, что ЗП распределена нормально или близко к нормальному (распределение в целом симметрично, нет особых выбросов). Проверим это.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="R_analysis.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skimr::skim(whr_tests$`Happiness Score`)</span></span>
<span id="cb201-2"><a href="R_analysis.html#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="R_analysis.html#cb201-3" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb201-4"><a href="R_analysis.html#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb201-5"><a href="R_analysis.html#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-6"><a href="R_analysis.html#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="R_analysis.html#cb202-1" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="R_analysis.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb202-3"><a href="R_analysis.html#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb202-4"><a href="R_analysis.html#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb202-5"><a href="R_analysis.html#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
<p>По этой картине в целом можем считать, что ЗП <code>Happiness Score</code> распределена близко к нормальному распределению. Значит, мы можем не использовать непараметрические аналоги т-теста и проводить самый обычный т-тест!</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="R_analysis.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span> <span class="sc">~</span> Region, <span class="at">data =</span> whr_ttest, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Happiness Score by Region
## t = -6.4412, df = 35.349, p-value = 0.00000009733
## alternative hypothesis: true difference in means between group Central and Eastern Europe and group Western Europe is less than 0
## 95 percent confidence interval:
##        -Inf -0.9701413
## sample estimates:
## mean in group Central and Eastern Europe 
##                                 5.370690 
##             mean in group Western Europe 
##                                 6.685667</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="R_analysis.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span> <span class="sc">~</span> Region, <span class="at">data =</span> whr_ttest, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Happiness Score by Region
## t = -6.4412, df = 35.349, p-value = 0.0000001947
## alternative hypothesis: true difference in means between group Central and Eastern Europe and group Western Europe is not equal to 0
## 95 percent confidence interval:
##  -1.7292798 -0.9006742
## sample estimates:
## mean in group Central and Eastern Europe 
##                                 5.370690 
##             mean in group Western Europe 
##                                 6.685667</code></pre>
<p>Аргумент <code>alternative</code> обозначает, какова наша альтернативная гипотеза (противоположная нулевой): что средние в группых просто <em>не равны</em> или что среднее в одной из групп <em>меньше или больше,</em> чем в другой. Аргумент <code>paired</code> указывает, нужно ли проводить зависимый т-тест (когда мы используем одну и ту же выборку и делаем на ней несколько измерений). В данном случае, у нас независимые выборки, и зависимый т-тест не нужен.</p>
<p>Как проинтерпретировать эти результаты? Первое, на что мы смотрим – это p-value (колонка Pr(F)). Если оно меньше установленного уровня <span class="math inline">\(\alpha\)</span>, то мы говорим, что <em>отвергаем нулевую гипотезу, и мы получили статистически значимые резличия</em>. Если p-value больше или равно <span class="math inline">\(\alpha\)</span> – <em>у нас недостаточно свидетельств в пользу альтернативной гипотезы, и мы говорим, что не отвергаем нулевую гипотезу</em>.</p>
<p>Чем хороша форма записи через %&gt;% – мы можем сразу внутри одного пайпа и отфильтровать данные, и сделать т-тест! На том же самом примере, только теперь сразу отфильтруем данные и сделаем т-тест на отфильтрованных данных, без создания отдельного датасета <code>whr_ttest</code>:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="R_analysis.html#cb207-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="R_analysis.html#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb207-3"><a href="R_analysis.html#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span> <span class="sc">~</span> Region, <span class="at">data =</span> ., <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)  <span class="co"># ставим точку вместо названия датасета</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Happiness Score by Region
## t = -6.4412, df = 35.349, p-value = 0.00000009733
## alternative hypothesis: true difference in means between group Central and Eastern Europe and group Western Europe is less than 0
## 95 percent confidence interval:
##        -Inf -0.9701413
## sample estimates:
## mean in group Central and Eastern Europe 
##                                 5.370690 
##             mean in group Western Europe 
##                                 6.685667</code></pre>
<p>Обратите внимание – в функции t.test данные стоят не на первом месте, как нам нужно для того, чтобы использовать нотацию пайпа. Но это довольно просто решается: в любой функции, чтобы использовать ее внутри пайпа, нужно поставить точку в том месте, куда мы хотим передать результат выполнения предыдущей строки пайпа.</p>
<p>Иногда бывает проще все-таки сделать больше действий, но последовательно, поэтому может пригодиться знать и другой вариант записи т-теста и его непараметрических аналогов – не через указание переменных из данных (обратите внимание – мы эксплицитно задавали аргумент <code>data</code>), а без указания данных, просто передав ему два вектора (я редко использую такой формат записи, но не потому, что он хуже – я это делаю для экономии времени, и чтобы не запутаться в созданных мной во время работы над учебником переменных):</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="R_analysis.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Фильтруем только те регионы, которые будем проверять</span></span>
<span id="cb209-2"><a href="R_analysis.html#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="R_analysis.html#cb209-3" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb209-4"><a href="R_analysis.html#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb209-5"><a href="R_analysis.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb209-6"><a href="R_analysis.html#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="ot">-&gt;</span> whr_tests_CEE</span>
<span id="cb209-7"><a href="R_analysis.html#cb209-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-8"><a href="R_analysis.html#cb209-8" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb209-9"><a href="R_analysis.html#cb209-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb209-10"><a href="R_analysis.html#cb209-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb209-11"><a href="R_analysis.html#cb209-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="ot">-&gt;</span> whr_tests_WE</span>
<span id="cb209-12"><a href="R_analysis.html#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="R_analysis.html#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(whr_tests_CEE)</span></code></pre></div>
<pre><code>## [1] 0.3485667</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="R_analysis.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(whr_tests_WE)</span></code></pre></div>
<pre><code>## [1] 0.6228212</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="R_analysis.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(whr_tests_CEE, whr_tests_WE, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  whr_tests_CEE and whr_tests_WE
## t = -6.4412, df = 35.349, p-value = 0.00000009733
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.9701413
## sample estimates:
## mean of x mean of y 
##  5.370690  6.685667</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="R_analysis.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(whr_tests_CEE, whr_tests_WE, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  whr_tests_CEE and whr_tests_WE
## t = -6.4412, df = 35.349, p-value = 0.00000009733
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.9701413
## sample estimates:
## mean of x mean of y 
##  5.370690  6.685667</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="R_analysis.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(whr_tests_CEE, whr_tests_WE, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  whr_tests_CEE and whr_tests_WE
## t = -6.4412, df = 35.349, p-value = 0.0000001947
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.7292798 -0.9006742
## sample estimates:
## mean of x mean of y 
##  5.370690  6.685667</code></pre>
<p>Построим визуализации</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="R_analysis.html#cb219-1" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="R_analysis.html#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb219-3"><a href="R_analysis.html#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb219-4"><a href="R_analysis.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="R_analysis.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;viridis&quot;)</span></span>
<span id="cb220-2"><a href="R_analysis.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;wesanderson&quot;)</span></span>
<span id="cb220-3"><a href="R_analysis.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb220-4"><a href="R_analysis.html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wesanderson)</span>
<span id="cb220-5"><a href="R_analysis.html#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="R_analysis.html#cb220-6" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb220-7"><a href="R_analysis.html#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb220-8"><a href="R_analysis.html#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb220-9"><a href="R_analysis.html#cb220-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb220-10"><a href="R_analysis.html#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-57-2.png" width="672" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="R_analysis.html#cb221-1" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb221-2"><a href="R_analysis.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb221-3"><a href="R_analysis.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb221-4"><a href="R_analysis.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb221-5"><a href="R_analysis.html#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">wes_palette</span>(<span class="st">&quot;Moonrise3&quot;</span>))</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-57-3.png" width="672" /></p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="R_analysis.html#cb222-1" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb222-2"><a href="R_analysis.html#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> <span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb222-3"><a href="R_analysis.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb222-4"><a href="R_analysis.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb222-5"><a href="R_analysis.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">wes_palette</span>(<span class="st">&quot;Moonrise3&quot;</span>))</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-57-4.png" width="672" /></p>
<p><strong>Непараметрические аналоги т-теста</strong></p>
<p>Что делать, если бы наши допущения о предположении нормальности ЗП не оправдались? Если бы в распределении были бы явные выбросы, они было бы сильно не симметричным и скошенным? Тогда нам нужно было бы проводить непараметрические аналоги т-теста – тест Уилкоксона или Манна-Уитни. Разберем их на примере проверки, что показатель социальной поддержки <code>Family</code> отличается в этих регионах <em>(на самом деле, в реальности тут скорее всего вполне можно было бы провести обычный т-тест – но более кривых переменных в этих данных не нашлось, поэтому смотреть использование непараметрических аналогов будем на них.</em></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="R_analysis.html#cb223-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb223-2"><a href="R_analysis.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span>Family)) <span class="sc">+</span></span>
<span id="cb223-3"><a href="R_analysis.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-4"><a href="R_analysis.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="R_analysis.html#cb224-1" aria-hidden="true" tabindex="-1"></a>whr_tests <span class="sc">%&gt;%</span></span>
<span id="cb224-2"><a href="R_analysis.html#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> Family)) <span class="sc">+</span></span>
<span id="cb224-3"><a href="R_analysis.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb224-4"><a href="R_analysis.html#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb224-5"><a href="R_analysis.html#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-58-2.png" width="672" /></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="R_analysis.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Все то же самое -- но функция называется не t.test(), a wilcox.test()</span></span>
<span id="cb225-2"><a href="R_analysis.html#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="R_analysis.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(whr_ttest<span class="sc">$</span>Family <span class="sc">~</span> whr_ttest<span class="sc">$</span>Region, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  whr_ttest$Family by whr_ttest$Region
## W = 127, p-value = 0.0001618
## alternative hypothesis: true location shift is less than 0</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="R_analysis.html#cb227-1" aria-hidden="true" tabindex="-1"></a>whr_ttest <span class="sc">%&gt;%</span></span>
<span id="cb227-2"><a href="R_analysis.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> Family, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb227-3"><a href="R_analysis.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb227-4"><a href="R_analysis.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb227-5"><a href="R_analysis.html#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">wes_palette</span>(<span class="st">&quot;Moonrise3&quot;</span>))</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-58-3.png" width="672" /></p>
</div>
</div>
<div id="tasks_sem5" class="section level2 hasAnchor" number="13.12">
<h2><span class="header-section-number">13.12</span> Задания после семинара 5<a href="R_analysis.html#tasks_sem5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Мы уже освоили предобработку данных, и теперь совсем взрослые – можем взять менее чистенький, расширенный датасет того же World Happiness Report за 2019 <a href="https://github.com/elenary/StatsForDA/blob/main/Chapter2OnlineData2019.xls?raw=true" class="uri">https://github.com/elenary/StatsForDA/blob/main/Chapter2OnlineData2019.xls?raw=true</a>, а здесь можно почитать пододробнее про данные <a href="https://s3.amazonaws.com/happiness-report/2019/WHR19_Ch2A_Appendix1.pdf" class="uri">https://s3.amazonaws.com/happiness-report/2019/WHR19_Ch2A_Appendix1.pdf</a> (кстати, этот док, судя по всему, тоже сверстан в R).</p>
<p><em>(Если вы работаете в R)</em> Чтобы было удобнее с ним работать для проверки гипотез, я сделала его предобработку – при повторении попробуйте ее разобрать, что делает каждая строчка? Показалось ли что-то новым?</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="R_analysis.html#cb228-1" aria-hidden="true" tabindex="-1"></a>whr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;2016.csv&quot;</span>)</span>
<span id="cb228-2"><a href="R_analysis.html#cb228-2" aria-hidden="true" tabindex="-1"></a>whr_2019 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xls</span>(<span class="st">&quot;Chapter2OnlineData2019.xls&quot;</span>)</span>
<span id="cb228-3"><a href="R_analysis.html#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="R_analysis.html#cb228-4" aria-hidden="true" tabindex="-1"></a>whr_2019 <span class="sc">%&gt;%</span></span>
<span id="cb228-5"><a href="R_analysis.html#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Country name</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Negative affect</span><span class="st">`</span>) <span class="ot">-&gt;</span> whr_2019</span>
<span id="cb228-6"><a href="R_analysis.html#cb228-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-7"><a href="R_analysis.html#cb228-7" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb228-8"><a href="R_analysis.html#cb228-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country<span class="sc">:</span><span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-9"><a href="R_analysis.html#cb228-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(whr_2019, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span> <span class="ot">=</span> <span class="st">&quot;Country name&quot;</span>), <span class="at">multiple =</span> <span class="st">&quot;last&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb228-10"><a href="R_analysis.html#cb228-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;top20&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Happiness Rank</span><span class="st">`</span><span class="sc">&lt;=</span><span class="dv">20</span>, <span class="st">&quot;hehe&quot;</span>, <span class="st">&quot;not hehe&quot;</span>),</span>
<span id="cb228-11"><a href="R_analysis.html#cb228-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;mean_position&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span><span class="sc">&gt;=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Happiness Score</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;upper&quot;</span>, <span class="st">&quot;lower&quot;</span>)) <span class="ot">-&gt;</span> whr_tests_hw</span>
<span id="cb228-12"><a href="R_analysis.html#cb228-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-13"><a href="R_analysis.html#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="co"># View(whr_tests)</span></span></code></pre></div>
<p><em>(Если вы работаете в Jamovi, ипользуйте любые данные – старые за 2016 год или новые за 2019)</em></p>
<ol style="list-style-type: decimal">
<li><p>На полученном датасете <code>whr_tests_hw</code> проведите полностью по всему алгоритму NHST хотя бы один корреляционные тест: выберете подходящие переменные, сформулируйте гипотезу, сформулируйте <span class="math inline">\(H_0\)</span> и <span class="math inline">\(H_1\)</span>, выберете уровень <span class="math inline">\(\alpha\)</span>, предобработайте данные, если нужно, и проведите корреляционный тест на выбранном уровне значимости. Проинтерпретируйте результаты: подтвердилась ли гипотеза?</p></li>
<li><p>На полученном датасете <code>whr_tests_hw</code> проведите полностью по всему алгоритму NHST хотя бы один т-тест или его непараметрический аналог: выберете подходящие переменные, сформулируйте гипотезу, сформулируйте <span class="math inline">\(H_0\)</span> и <span class="math inline">\(H_1\)</span>, выберете уровень <span class="math inline">\(\alpha\)</span>, определите, зависимые или независимые выборки, предобработайте данные, если нужно, и проведите тест сравнения средних на выбранном уровне значимости. Проинтерпретируйте результаты: подтвердилась ли гипотеза?</p></li>
</ol>
</div>
<div id="проверка-гипоте-2-anova-и-линейная-регрессия" class="section level2 hasAnchor" number="13.13">
<h2><span class="header-section-number">13.13</span> Проверка гипоте-2: ANOVA и линейная регрессия<a href="R_analysis.html#проверка-гипоте-2-anova-и-линейная-регрессия" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="anova-дисперсионный-анализ" class="section level3 hasAnchor" number="13.13.1">
<h3><span class="header-section-number">13.13.1</span> ANOVA (дисперсионный анализ)<a href="R_analysis.html#anova-дисперсионный-анализ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Я хочу внести чуть разнообразия в наши данные, поэтому нашла еще одну <a href="#https://github.com/elenary/StatsForDA/blob/main/Chapter2OnlineData2019.xls?raw=true">табличку</a>, касающуюся World Happiness Report, можно почитать пододробнее <a href="#https://s3.amazonaws.com/happiness-report/2019/WHR19_Ch2A_Appendix1.pdf">здесь</a> (кстати, этот док, судя по всему, тоже сверстан в R).</p>
<p>Примерно так может выглядеть предобработка реальных (не самых чистых и кривых) данных: я объединяю две таблички (табличка за 2016 год и новая табличка за 2019 год) с помощью функции <code>right_join</code> (это значит, что я к правой табличке присоединяю левую, а все то, что осталось в левой не подошедшее к правой – не берется) из семейства <code>join</code>, переименовые колонки и заменяю пробелы на них на нижнее подчеркивание с помощью функции <code>rename_with</code>, отбираю только интересующие меня колонки с помощью функции <code>select</code>, создаю новые переменные, которые мы уже создавали ранее в домашках, с помощью функции mutate и сохраняю результат в новую табличку в датасет <code>whr_tests_hw</code></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="R_analysis.html#cb229-1" aria-hidden="true" tabindex="-1"></a>whr_2019 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xls</span>(<span class="st">&quot;Chapter2OnlineData2019.xls&quot;</span>)</span>
<span id="cb229-2"><a href="R_analysis.html#cb229-2" aria-hidden="true" tabindex="-1"></a>whr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;2016.csv&quot;</span>)</span>
<span id="cb229-3"><a href="R_analysis.html#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="R_analysis.html#cb229-4" aria-hidden="true" tabindex="-1"></a>whr_2019 <span class="sc">%&gt;%</span></span>
<span id="cb229-5"><a href="R_analysis.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, .), <span class="at">.cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb229-6"><a href="R_analysis.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country_name<span class="sc">:</span>Negative_affect) <span class="sc">%&gt;%</span></span>
<span id="cb229-7"><a href="R_analysis.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2016</span>) <span class="ot">-&gt;</span> whr_2019</span>
<span id="cb229-8"><a href="R_analysis.html#cb229-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-9"><a href="R_analysis.html#cb229-9" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb229-10"><a href="R_analysis.html#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, .), <span class="at">.cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb229-11"><a href="R_analysis.html#cb229-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Happiness_Rank, Happiness_Score) <span class="sc">%&gt;%</span></span>
<span id="cb229-12"><a href="R_analysis.html#cb229-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(whr_2019, <span class="at">by =</span> <span class="fu">join_by</span>(Country <span class="sc">==</span> Country_name), <span class="at">multiple =</span> <span class="st">&quot;last&quot;</span>) <span class="ot">-&gt;</span> tmp</span>
<span id="cb229-13"><a href="R_analysis.html#cb229-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-14"><a href="R_analysis.html#cb229-14" aria-hidden="true" tabindex="-1"></a>whr <span class="sc">%&gt;%</span></span>
<span id="cb229-15"><a href="R_analysis.html#cb229-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country<span class="sc">:</span>Region) <span class="sc">%&gt;%</span></span>
<span id="cb229-16"><a href="R_analysis.html#cb229-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(tmp, <span class="at">by =</span> <span class="fu">join_by</span>(Country <span class="sc">==</span> Country), <span class="at">multiple =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb229-17"><a href="R_analysis.html#cb229-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;top20&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(Happiness_Rank<span class="sc">&lt;=</span><span class="dv">20</span>, <span class="st">&quot;hehe&quot;</span>, <span class="st">&quot;not hehe&quot;</span>),</span>
<span id="cb229-18"><a href="R_analysis.html#cb229-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;mean_position&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(Happiness_Score<span class="sc">&gt;=</span> <span class="fu">mean</span>(Happiness_Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;upper&quot;</span>, <span class="st">&quot;lower&quot;</span>)) <span class="ot">-&gt;</span> whr_tests_hw</span></code></pre></div>
<p>Результат этой предобраотк я так же с помощью <code>R</code> и функции <code>write_csv()</code> выгрузила в отдельный файл <a href="https://raw.githubusercontent.com/elenary/StatsForDA/main/whr_tests_hw.csv" class="uri">https://raw.githubusercontent.com/elenary/StatsForDA/main/whr_tests_hw.csv</a></p>
<p>До этого мы проверяли гипотезу о том, что Happiness Score различаеся в двух регионах: Западаной и Восточной и Центральной Европе. А если я хочу проверить, различаются ли статистически значимо уровень счастья в трех регионах – Западаной и Восточной и Центральной Европе и в Латинском Америке? Снова обращаемся к изученным нами в прошлом семестре <a href="stats_criteria.html#stats_criteria">статистическим критериям</a>, всопминаем каринку с деревом выбора статистических тестов <a href="https://miro.com/app/board/uXjVOxmKhr8=/" class="uri">https://miro.com/app/board/uXjVOxmKhr8=/</a>. Если у нас ЗП количественная, НП категориальная / категориальные, и нужно провести 3 сравнения и больше – то мы переходим от т-теста к <a href="stats_criteria_ttest_anova.html#anova">ANOVA (дисперсионному анализу)</a>.</p>
<p>Я буду периодически придерживаться формы записи кода, когда я внутри одного пайпа делаю сразу все – и фильрацию, и построение графиков или расчет теста, но не забывае, что прежде чем писать все вместе, нужно убедиться, что каждая строчка – работает. И может быть удобнее на первых порах создавать побольше переменных и записывать туда результаты фильтрации, а потом уже использовать эту переменную – так будет проще дебажить код. Например, можно сначала отфильтровать данные и записать их в новый датасет (иногда бывает, что без этой формы записи не обойтись)</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="R_analysis.html#cb230-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb230-2"><a href="R_analysis.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb230-3"><a href="R_analysis.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">&quot;2016&quot;</span>) <span class="ot">-&gt;</span> whr_anova</span></code></pre></div>
<p>Вспоминаем допущения для <a href="stats_criteria_ttest_anova.html#anova">АНОВЫ</a></p>
<p>Первое – ЗП должна быть распределена близко к нормальному распределению.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="R_analysis.html#cb231-1" aria-hidden="true" tabindex="-1"></a>whr_anova <span class="sc">%&gt;%</span></span>
<span id="cb231-2"><a href="R_analysis.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Happiness_Score)) <span class="sc">+</span></span>
<span id="cb231-3"><a href="R_analysis.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-4"><a href="R_analysis.html#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="R_analysis.html#cb232-1" aria-hidden="true" tabindex="-1"></a>whr_anova <span class="sc">%&gt;%</span></span>
<span id="cb232-2"><a href="R_analysis.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> Happiness_Score)) <span class="sc">+</span></span>
<span id="cb232-3"><a href="R_analysis.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb232-4"><a href="R_analysis.html#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb232-5"><a href="R_analysis.html#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-62-2.png" width="672" /></p>
<p>Допустим, это похоже на нормальное распредедление.</p>
<p>Второе допущение – гомогенность (гомоскедастичность) дисперсий. Дисперсии должны быть одинаковы в наших группах. Если они будут разными – это плохо, и нам придется использовать непараметрические аналоги ANOVA. Гомогенность дисперсий проверяется с помощью Levene’s Test. Обратите внимание: здесь мы заинтересованы в получении НЕзначимого результата – потому что если проверка дала значимый результат, то диперсии в группах различаются, а это не ок. Нам понадобится фунция <code>leveneTest</code> из пакета <code>car</code></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="R_analysis.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="co"># сначала отключим форму записи чисел с большим количество нулей через экспоненту</span></span>
<span id="cb233-2"><a href="R_analysis.html#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="R_analysis.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;car&quot;)</span></span>
<span id="cb233-4"><a href="R_analysis.html#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb233-5"><a href="R_analysis.html#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Happiness_Score <span class="sc">~</span> Region, <span class="at">data =</span> whr_anova)</span></code></pre></div>
<pre><code>## Warning in leveneTest.default(y = y, group = group, ...): group coerced to
## factor.</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  2  0.7143 0.4933
##       66</code></pre>
<p>Смотрми на p-value: оно не значимо, ура! Значит, мы соблюли все допущения, и можем спокойно использовать анову. Мы попробуем построить ее двумя способами: с помощью стандартной функции <code>aov</code> и с помощью более функции <code>ezANOVA</code> из пакета <code>ez</code> с более понятным синтаксисом, но более придирчивой и менее стабильной.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="R_analysis.html#cb236-1" aria-hidden="true" tabindex="-1"></a>aov_model1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Happiness_Score <span class="sc">~</span> Region, <span class="at">data =</span> whr_anova) <span class="co">#выполняем АНОВУ</span></span>
<span id="cb236-2"><a href="R_analysis.html#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_model1) <span class="co">#выводим табличку АНОВЫ</span></span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value       Pr(&gt;F)    
## Region       2  21.40  10.698   21.37 0.0000000697 ***
## Residuals   66  33.04   0.501                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Как проинтерпретировать эти результаты? Первое, на что мы смотрим – это p-value (колонка Pr(F)). Если оно меньше установленного уровня <span class="math inline">\(\alpha\)</span>, то мы говорим, что <em>отвергаем нулевую гипотезу, и мы получили статистически значимые резличия</em>. Если p-value больше или равно <span class="math inline">\(\alpha\)</span> – <em>у нас недостаточно свидетельств в пользу альтернативной гипотезы, и мы говорим, что не отвергаем нулевую гипотезу</em>.</p>
<p>Второй вариант построения этого же анализа с помощью функции <code>ezANOVA.</code> Она, кстати, сразу делает Levene’s test, поэтому у нас две выдачи.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="R_analysis.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;ez&quot;)</span></span>
<span id="cb238-2"><a href="R_analysis.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ez)</span>
<span id="cb238-3"><a href="R_analysis.html#cb238-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-4"><a href="R_analysis.html#cb238-4" aria-hidden="true" tabindex="-1"></a>whr_anova <span class="sc">%&gt;%</span> </span>
<span id="cb238-5"><a href="R_analysis.html#cb238-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ezANOVA</span>(., Happiness_Score, <span class="at">wid =</span> Country, <span class="at">between =</span> Region)</span></code></pre></div>
<pre><code>## Warning: Converting &quot;Country&quot; to factor for ANOVA.</code></pre>
<pre><code>## Warning: Converting &quot;Region&quot; to factor for ANOVA.</code></pre>
<pre><code>## Warning: Data is unbalanced (unequal N per group). Make sure you specified a
## well-considered value for the type argument to ezANOVA().</code></pre>
<pre><code>## $ANOVA
##   Effect DFn DFd        F              p p&lt;.05       ges
## 1 Region   2  66 21.37266 0.000000069727     * 0.3930773
## 
## $`Levene&#39;s Test for Homogeneity of Variance`
##   DFn DFd       SSn      SSd         F         p p&lt;.05
## 1   2  66 0.3066018 14.16483 0.7142945 0.4932823</code></pre>
<p>Если мы сравним результаты – они будут точно такими же, только вторая функция в колонке ges выдает еще размер эффекта! Это eta squared <span class="math inline">\(\eta^2\)</span>, <a href="inference.html#sample_size">метрика размера размера эффекта для ANOVA</a>, которую вы так или иначе использовали в домашнем задании в прошлом курсе. Мы видим, что эффект, который мы получили, довольно большой!</p>
<p>Можем посчитать его и отдельно для предыдущей таблички с помощью функции пакета effectsize</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="R_analysis.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;effectsize&quot;)</span></span>
<span id="cb243-2"><a href="R_analysis.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb243-3"><a href="R_analysis.html#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="R_analysis.html#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="fu">eta_squared</span>(aov_model1)</span></code></pre></div>
<pre><code>## # Effect Size for ANOVA
## 
## Parameter | Eta2 |       95% CI
## -------------------------------
## Region    | 0.39 | [0.24, 1.00]
## 
## - One-sided CIs: upper bound fixed at [1.00].</code></pre>
<p>Значение будет тем же самым, что и в колонке ges вывода ezANOVA.</p>
<p>Визуализируем результаты. Чаще всего для визуализации ANOVA используются боксплоты или вайолин плоты</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="R_analysis.html#cb245-1" aria-hidden="true" tabindex="-1"></a>whr_anova <span class="sc">%&gt;%</span></span>
<span id="cb245-2"><a href="R_analysis.html#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> Happiness_Score, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb245-3"><a href="R_analysis.html#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb245-4"><a href="R_analysis.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb245-5"><a href="R_analysis.html#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">wes_palette</span>(<span class="st">&quot;FantasticFox1&quot;</span>))</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-67-1.png" width="672" />
Или же часто можно встретить графики, на которых отображены только средние</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="R_analysis.html#cb246-1" aria-hidden="true" tabindex="-1"></a>whr_anova <span class="sc">%&gt;%</span></span>
<span id="cb246-2"><a href="R_analysis.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Region, <span class="at">y =</span> Happiness_Score, <span class="at">color =</span> Region, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb246-3"><a href="R_analysis.html#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&#39;point&#39;</span>) <span class="sc">+</span></span>
<span id="cb246-4"><a href="R_analysis.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&#39;line&#39;</span>) <span class="sc">+</span></span>
<span id="cb246-5"><a href="R_analysis.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">&#39;errorbar&#39;</span>) <span class="sc">+</span></span>
<span id="cb246-6"><a href="R_analysis.html#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb246-7"><a href="R_analysis.html#cb246-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">wes_palette</span>(<span class="st">&quot;FantasticFox1&quot;</span>))</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>Мы узнали, что ANOVA значима, то есть статистически значимые различия между этими тремя регионами. А как узнать, какие именно регионы вносят значимость? Может ли такое быть, чтоо значимость обеспечивается одним сильно отличающимся от других регионом, в то время как два других не отличаются? Может. Чтобы узнать это, нужно провести <a href="#id_%D0%BF%D0%BE%D1%81%D1%82-%D1%85%D0%BE%D0%BA%D0%B8-%D0%B8-%D0%BC%D0%BD%D0%BE%D0%B6%D0%B5%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5-%D1%81%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F">пост-хок тесты</a>.</p>
<div id="пост-хоки" class="section level4 hasAnchor" number="13.13.1.1">
<h4><span class="header-section-number">13.13.1.1</span> Пост-хоки<a href="R_analysis.html#пост-хоки" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Пост-хоки представляют собой попарное множественное сравнение всего со всем. Вспоминаем, что когда мы так делаем – мы рикуем получить статистчиески значимый результат чисто по случайности, потому что очень растет вероятность ошибки первого рода, и нужны поправи на множественные сравнения. Сделать пост=хок анализ можно например помощью встроенных функций <code>TukeyHSD</code> или <code>pairwise.t.test</code></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="R_analysis.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov_model1, <span class="at">conf.level=</span>.<span class="dv">95</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Happiness_Score ~ Region, data = whr_anova)
## 
## $Region
##                                                             diff        lwr
## Latin America and Caribbean-Central and Eastern Europe 0.7082577 0.20757381
## Western Europe-Central and Eastern Europe              1.3149770 0.82891110
## Western Europe-Latin America and Caribbean             0.6067193 0.06961039
##                                                             upr     p adj
## Latin America and Caribbean-Central and Eastern Europe 1.208942 0.0033334
## Western Europe-Central and Eastern Europe              1.801043 0.0000000
## Western Europe-Latin America and Caribbean             1.143828 0.0230915</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="R_analysis.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(whr_anova<span class="sc">$</span>Happiness_Score, whr_anova<span class="sc">$</span>Region, <span class="at">p.adj =</span> <span class="st">&quot;bonf&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  whr_anova$Happiness_Score and whr_anova$Region 
## 
##                             Central and Eastern Europe
## Latin America and Caribbean 0.0035                    
## Western Europe              0.000000039               
##                             Latin America and Caribbean
## Latin America and Caribbean -                          
## Western Europe              0.0258                     
## 
## P value adjustment method: bonferroni</code></pre>
</div>
<div id="непераметрические-аналоги-anova" class="section level4 hasAnchor" number="13.13.1.2">
<h4><span class="header-section-number">13.13.1.2</span> Непераметрические аналоги ANOVA<a href="R_analysis.html#непераметрические-аналоги-anova" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Если наша переменная имеет значительные выбросы, не прошла проверку на нормальность, и дисперсии в группах оказались статистически значимо разные – значит, мы не можем применять ANOVA. Что делаеть? Проводить аналог ANOVA, тест Краскелла-Уоллиса. Покажу его на тех же данных, которые мы брали для ANOVA, где смотрели разный уровень счастья по регионам.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="R_analysis.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(Happiness_Score <span class="sc">~</span> Region, <span class="at">data =</span> whr_anova)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  Happiness_Score by Region
## Kruskal-Wallis chi-squared = 26.36, df = 2, p-value = 0.000001888</code></pre>
</div>
<div id="многофакторная-anova" class="section level4 hasAnchor" number="13.13.1.3">
<h4><span class="header-section-number">13.13.1.3</span> Многофакторная ANOVA<a href="R_analysis.html#многофакторная-anova" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Мы проверили гипотезу с только одной НП – регион. А если моя гипотеза касается нескольких факторов? Например, хочу проверить гипотезу, что на переменную <code>Life_Ladder</code> (аналог <code>Happiness Score</code>, показывает результаты опроса, где находятся респонденты по уровню счастья в виде лестницы, у которой 10 ступенек) влияет и регион, и год.</p>
<p>Я вернусь к изначальному датасету и уберу фильтрацию по году.</p>
<p>Все то же самое – сначала проверим допущения.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="R_analysis.html#cb253-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb253-2"><a href="R_analysis.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb253-3"><a href="R_analysis.html#cb253-3" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb253-4"><a href="R_analysis.html#cb253-4" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb253-5"><a href="R_analysis.html#cb253-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb253-6"><a href="R_analysis.html#cb253-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb253-7"><a href="R_analysis.html#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="R_analysis.html#cb254-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb254-2"><a href="R_analysis.html#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb254-3"><a href="R_analysis.html#cb254-3" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb254-4"><a href="R_analysis.html#cb254-4" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb254-5"><a href="R_analysis.html#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb254-6"><a href="R_analysis.html#cb254-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb254-7"><a href="R_analysis.html#cb254-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb254-8"><a href="R_analysis.html#cb254-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-71-2.png" width="672" /></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="R_analysis.html#cb255-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb255-2"><a href="R_analysis.html#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb255-3"><a href="R_analysis.html#cb255-3" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb255-4"><a href="R_analysis.html#cb255-4" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-5"><a href="R_analysis.html#cb255-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(Life_Ladder <span class="sc">~</span> Region <span class="sc">+</span> <span class="fu">as.factor</span>(Year), <span class="at">data =</span> .) <span class="ot">-&gt;</span> aov_model3</span>
<span id="cb255-6"><a href="R_analysis.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="co">#на всякий случай сделала as.factor(), он просто превращает число в строку. функции бывают не очень умными и думают, что нужнобрать числовую переменную </span></span>
<span id="cb255-7"><a href="R_analysis.html#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="co"># как число, даже если задаем ее как группирующую переменную (фактор)</span></span>
<span id="cb255-8"><a href="R_analysis.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_model3)</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq F value              Pr(&gt;F)    
## Region            2  273.0  136.51 271.048 &lt;0.0000000000000002 ***
## as.factor(Year)  11    6.8    0.62   1.229               0.263    
## Residuals       681  343.0    0.50                                
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Формула записи
<code>dependent var ~ independen var 1 + independent var 2</code>
означает, что я учитываю два фактора независимо друг от друга. Но бывает, что меня интересует взаимодействие факторов: может, в некоторых регионах за эти годы особо ничего не менялось, уровень счастья измеренный как <code>Life_Ladder</code> был постоянным, а в каких-то регионах произошел огромный рост (или огромный отрицательный рост) уровня счастья? Тогда мне нужно будет проверить взаимодействие факторов, и формула будет такая:
<code>dependent var ~ independen var 1 * independent var 2</code>
Везде, где меня интересует взаимодействие, вместо плюсика ставлю звездочку.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="R_analysis.html#cb257-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb257-2"><a href="R_analysis.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb257-3"><a href="R_analysis.html#cb257-3" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb257-4"><a href="R_analysis.html#cb257-4" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb257-5"><a href="R_analysis.html#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(Life_Ladder <span class="sc">~</span> Region <span class="sc">*</span> <span class="fu">as.factor</span>(Year), <span class="at">data =</span> .) <span class="ot">-&gt;</span> aov_model4</span>
<span id="cb257-6"><a href="R_analysis.html#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_model4)</span></code></pre></div>
<pre><code>##                         Df Sum Sq Mean Sq F value              Pr(&gt;F)    
## Region                   2  273.0  136.51 274.254 &lt;0.0000000000000002 ***
## as.factor(Year)         11    6.8    0.62   1.244               0.254    
## Region:as.factor(Year)  22   15.0    0.68   1.366               0.123    
## Residuals              659  328.0    0.50                                
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Видим, что во втором случае у нас появилась еще одна строчка – Region:Year. Это как раз взаимодействие двух факторов. И оно, между прочим, значимо! То есть предположение о том, что в разных регионах разная динамика изменения уровня счастья по годам – верное.</p>
<p>Далее, чтобы определить, что именно было значимо, делаем пост-хоки.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="R_analysis.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov_model3, <span class="at">conf.level=</span>.<span class="dv">95</span>)</span>
<span id="cb259-2"><a href="R_analysis.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov_model4, <span class="at">conf.level=</span>.<span class="dv">95</span>)</span></code></pre></div>
<p>Я не буду выводить табличку – она получается монструозной из-за того, что мы взяли года, а они начинаются с 2005 года: представьте, сколько там попарных сравнений…</p>
</div>
<div id="anova-с-повторными-измерениями" class="section level4 hasAnchor" number="13.13.1.4">
<h4><span class="header-section-number">13.13.1.4</span> ANOVA с повторными измерениями<a href="R_analysis.html#anova-с-повторными-измерениями" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Вообще-то переменная год – внутригрупповой фактор. И если быть честными, ее не очень хорошо учитывать так же, как и фактор Регион, иначе мы потеряем много информации. В R ANOVA с повторными измерениями можно сделать, задав дополнительные параметры в функции aov(), либо с уже знакомой нам функцией ezANOVA(), либо с помощью очень похожей функции anova_test()</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="R_analysis.html#cb260-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb260-2"><a href="R_analysis.html#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb260-3"><a href="R_analysis.html#cb260-3" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb260-4"><a href="R_analysis.html#cb260-4" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-5"><a href="R_analysis.html#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span> <span class="co">#возьму года после 2010, чтобы было поменьше</span></span>
<span id="cb260-6"><a href="R_analysis.html#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(Life_Ladder, Year) <span class="sc">%&gt;%</span> <span class="co">#удаляю пропущенные значения в интересующих меня колонках</span></span>
<span id="cb260-7"><a href="R_analysis.html#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(Life_Ladder <span class="sc">~</span> Year <span class="sc">+</span> <span class="fu">Error</span>(Country<span class="sc">/</span>Year), .) <span class="sc">%&gt;%</span></span>
<span id="cb260-8"><a href="R_analysis.html#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## Warning in aov(Life_Ladder ~ Year + Error(Country/Year), .): Error() model is
## singular</code></pre>
<pre><code>## 
## Error: Country
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Year       1   8.94   8.935   2.095  0.152
## Residuals 71 302.81   4.265               
## 
## Error: Country:Year
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Year       1  0.003  0.0027    0.01  0.919
## Residuals 70 18.106  0.2586               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals 270  12.92 0.04784</code></pre>
<p>Как задать эту формулу: если фактор появляется несколько раз для одного и того же испытуемого или страны в данном случае, то формула записи будет такой
<code>dependent var ~ independen var + Error(ID/independen var)</code></p>
<p>Более человеческий синтаксис у функции anova_test, но она очень чувствительна к данным, и на этих данных, например, не построилась. <em>Позже я поняла, почему: я забыла сделать проверку на идентичность дисперсий, вот модель и не сходится! Но мне уже лень переписывать..</em></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="R_analysis.html#cb263-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="R_analysis.html#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">&quot;Central and Eastern Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb263-3"><a href="R_analysis.html#cb263-3" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Western Europe&quot;</span> <span class="sc">|</span> </span>
<span id="cb263-4"><a href="R_analysis.html#cb263-4" aria-hidden="true" tabindex="-1"></a>           Region <span class="sc">==</span> <span class="st">&quot;Latin America and Caribbean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb263-5"><a href="R_analysis.html#cb263-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span></span>
<span id="cb263-6"><a href="R_analysis.html#cb263-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(Life_Ladder, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb263-7"><a href="R_analysis.html#cb263-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ezANOVA</span>(., <span class="at">dv =</span> Life_Ladder, <span class="at">wid =</span> Country, <span class="at">within =</span> <span class="fu">as.factor</span>(Year))</span></code></pre></div>
</div>
</div>
<div id="reshaping" class="section level3 hasAnchor" number="13.13.2">
<h3><span class="header-section-number">13.13.2</span> Решейпинг<a href="R_analysis.html#reshaping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Бывает так, что для тестов с повторными измерениями некоторые функции принимают на вход данные в другом формате. Например, ровно так произошло в Jamovi. Обратите внимание, как данные о повторных измерениях у нас выглядят сейчас: у нас есть колонка <code>Year</code>, в которой перечислены года, и колонка <code>Life_Ladder</code>, в которой перечислены соответствующие этим годам значения.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="R_analysis.html#cb264-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb264-2"><a href="R_analysis.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, Life_Ladder) <span class="sc">%&gt;%</span> </span>
<span id="cb264-3"><a href="R_analysis.html#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year<span class="sc">&gt;</span><span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-4"><a href="R_analysis.html#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="co">#выводит заголовок таблички, первые 10 строк</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   Country  Year Life_Ladder
##   &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;
## 1 Denmark  2016        7.56
## 2 Denmark  2011        7.79
## 3 Denmark  2012        7.52
## 4 Denmark  2013        7.59
## 5 Denmark  2014        7.51
## 6 Denmark  2015        7.51</code></pre>
<p>Такой формат данных называется <em>длинным</em> (без шуток, так и называется!), потому что данные вытянуты в длину, вместо того, чтобы каждая строка состояла из уникальных данных (обратите внимание на колонку <code>Country</code> – там повторяющие значения, потому что у нас много замеров в разные года для каждой страны). Иногда бывает нужно перевести данные в <em>широкий</em> формат – чтобы значения в строчках не повторялись, но вместо двух колонок у нас появилась по колонке с измерениями <code>Life_Ladder</code> за каждый год. Такое преобразование называется решейпинг данных, как бы изменение их формы. Преобразовать вид данных из длинного в широкий формат или обратно можно с помощью функций pivot_wider pivot_longer. В Jamovi решейпинг, к сожалению, не реализован.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="R_analysis.html#cb266-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb266-2"><a href="R_analysis.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, Life_Ladder) <span class="sc">%&gt;%</span> </span>
<span id="cb266-3"><a href="R_analysis.html#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year<span class="sc">&gt;</span><span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb266-4"><a href="R_analysis.html#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Year, <span class="at">values_from =</span> Life_Ladder) <span class="sc">%&gt;%</span> </span>
<span id="cb266-5"><a href="R_analysis.html#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   Country     `2016` `2011` `2012` `2013` `2014` `2015`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 Denmark       7.56   7.79   7.52   7.59   7.51   7.51
## 2 Switzerland   7.46  NA      7.78  NA      7.49   7.57
## 3 Iceland       7.51  NA      7.59   7.50  NA      7.50
## 4 Norway        7.60  NA      7.68  NA      7.44   7.60
## 5 Finland       7.66   7.35   7.42   7.44   7.38   7.45
## 6 Canada        7.24   7.43   7.42   7.59   7.30   7.41</code></pre>
</div>
</div>
<div id="tasks_sem6" class="section level2 hasAnchor" number="13.14">
<h2><span class="header-section-number">13.14</span> Задания после семинара 6<a href="R_analysis.html#tasks_sem6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Проверьте несколько гипотез на датасете <code>whr_tests_hw</code> с помощью ANOVA и линейного регресионного анализа: выберете подходящие для этих тестов переменные, сформулируйте гипотезу, сформулируйте <span class="math inline">\(H_0\)</span> и <span class="math inline">\(H_1\)</span>, выберете уровень <span class="math inline">\(\alpha\)</span>, (если нужно, предобработайте данные), проверьте допущения для тестов.</p>
<ol style="list-style-type: decimal">
<li>Выберете подходящие переменные, сформулируйте осмысленную гипотезу и проверьте ее с помощью однофакторной ANOVA. Проинтерпретируйте результаты: подвердилась ли гипотеза?</li>
<li>Выберете подходящие переменные, сформулируйте осмысленную гипотезу и проверьте ее и проверьте ее с многофакторной ANOVA. Проинтерпретируйте результаты: подвердилась ли гипотеза?</li>
<li>Выберете подходящие переменные, сформулируйте осмысленную гипотезу и проверьте ее с помощью ANOVA c повторными измерениями. Проинтерпретируйте результаты: подвердилась ли гипотеза?</li>
<li>Проведите те же самые проверки гипотез 1-3 с помощью линейного регрессионного анализа.</li>
</ol>
</div>
<div id="lin_reg" class="section level2 hasAnchor" number="13.15">
<h2><span class="header-section-number">13.15</span> Линейный регрессионный анализ<a href="R_analysis.html#lin_reg" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Теперь перейдем к однму из самых важных методов в анализе данных, в том числе, психологических – <a href="stats_criteria_linear.html#linreg">линейной регрессии</a>. Первым делом нужно вспомнить, когда используется этот метод – а используется он, когда и ЗП, и НП – количественные. Когда мы говорили про корреляции, мы обсуждали, что это упрощенный вариант линейной регрессии, когда у нас только одна НП. Для однй НП мы можем сделать и корреляционный тест, и регрессионный анализ, а вот когда количественных НП две и более – уже тольк регрессионный. Также мы обсуждали, что ANOVA – на самом деле тоже подвид линейной регрессии, если уходить от количественных НП к категориальным! Но обо всем по порядку, начнем с количественных НП, более классического случая линейной регрессии.</p>
<p>Прежде, чем строить регрессионную модель, нам нужно проверить <a href="stats_criteria_linear.html#assumptions_linreg">допущения для линейной регрессии</a></p>
<p>Обратите внимание – нас тут уже не очень интересует, насколько нормально распределена ЗП! В этом сила линейной реггрессии, что она устойчива к ЗП разных распределений. Но другое допущение, касающееся распределения данных по ЗП – это линейность между НП и ЗП, на которых мы хотим строить модель, нужно убедиться, что между ними есть линейная связь (а не дырка от бублика или сущность в виде гномика). Это первое допущение.</p>
<p>Я выбрала для анализа гипотезу о том, что уровень счастья по субъективному расположению на лестнице <code>Life_Ladder</code>, зависит от параметров <code>Log_GDP_per_capita</code> (покупательская способность, ВВП на душу населения), <code>Social_support</code>, <code>Freedom_to_make_life_choices</code>, <code>Perceptions_of_corruption.</code></p>
<p>Проверим допущение о линейной связи между ЗП Life_Ladder и нескольких потенциальных переменных, которые я выбрала для анализа.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="R_analysis.html#cb268-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb268-2"><a href="R_analysis.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Log_GDP_per_capita, <span class="at">y =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb268-3"><a href="R_analysis.html#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb268-4"><a href="R_analysis.html#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 15 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="R_analysis.html#cb270-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb270-2"><a href="R_analysis.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Social_support, <span class="at">y =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb270-3"><a href="R_analysis.html#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb270-4"><a href="R_analysis.html#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-79-2.png" width="672" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="R_analysis.html#cb272-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb272-2"><a href="R_analysis.html#cb272-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Freedom_to_make_life_choices, <span class="at">y =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb272-3"><a href="R_analysis.html#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb272-4"><a href="R_analysis.html#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 28 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-79-3.png" width="672" /></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="R_analysis.html#cb274-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb274-2"><a href="R_analysis.html#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Perceptions_of_corruption, <span class="at">y =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb274-3"><a href="R_analysis.html#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb274-4"><a href="R_analysis.html#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 78 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-79-4.png" width="672" /></p>
<p>Вижу, что переменная Log_GDP_per_capita показывает очень хорошую линейную связь, близко к этому переменная Freedom_to_make_life_choices. Переменная Social_support мне не очень нравится, но я могу попробовать ее преобразовать в процессе, а вот переменная Perceptions_of_corruption выглядит откровенно плохо, возьму ее в качестве антипримера.</p>
<div id="линейная-регрессия-с-одним-предиктором-фактором" class="section level3 hasAnchor" number="13.15.1">
<h3><span class="header-section-number">13.15.1</span> Линейная регрессия с одним предиктором (фактором)<a href="R_analysis.html#линейная-регрессия-с-одним-предиктором-фактором" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Построю для начала модель с одним факторов – Log_GDP_per_capita. Модель строится помощью функции lm(), чтобы вывести основную информацию о модели нужно вывести summary(). Еще, кстати, можно вывести эти результаты сразу в виде ANOVA – это все потому, что, по сути, это подвид той же линейной регрессии, и если нам мила сердцу табличка вида ANOVA, можно ее получить просто применив функции к модели anova()</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="R_analysis.html#cb276-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb276-2"><a href="R_analysis.html#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(Life_Ladder <span class="sc">~</span> Log_GDP_per_capita, .) <span class="ot">-&gt;</span> lm_model1</span>
<span id="cb276-3"><a href="R_analysis.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="co"># напомнию, что точка означает, что именно в этом месте нужно передать в функцию данные</span></span>
<span id="cb276-4"><a href="R_analysis.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="co"># полученные на предыдущей строчке пайпа. Посмотрите структуру функции lm() в справке, </span></span>
<span id="cb276-5"><a href="R_analysis.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co"># на этом находится аргумент `data = `</span></span>
<span id="cb276-6"><a href="R_analysis.html#cb276-6" aria-hidden="true" tabindex="-1"></a>lm_model1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Life_Ladder ~ Log_GDP_per_capita, data = .)
## 
## Coefficients:
##        (Intercept)  Log_GDP_per_capita  
##            -1.4066              0.7421</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="R_analysis.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Life_Ladder ~ Log_GDP_per_capita, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.26515 -0.47805 -0.04913  0.54993  2.01866 
## 
## Coefficients:
##                    Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)         -1.4066     0.1467  -9.587 &lt;0.0000000000000002 ***
## Log_GDP_per_capita   0.7421     0.0158  46.973 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7016 on 1404 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.6111, Adjusted R-squared:  0.6109 
## F-statistic:  2206 on 1 and 1404 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="R_analysis.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_model1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Life_Ladder
##                      Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
## Log_GDP_per_capita    1 1086.07 1086.07  2206.5 &lt; 0.00000000000000022 ***
## Residuals          1404  691.07    0.49                                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="R_analysis.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># options(scipen = 999) функция, которая отключает нотацию записи чисел через экспоненту</span></span></code></pre></div>
<p>В целом, мы можем уже начать интерпретировать результаты модели, но пока рановато – сначаоа нужно убедиться в равенстве дисперсий остатков, то есть выполнении допущения о <em>гомоскедастичности</em> (гомогенности) дисперсий. Это проще всего проверить, выведя первый из четырех график, которые выводятся, если передать линейную модель в базовую функцию plot()</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="R_analysis.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model1, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>Можем сделать график покрасивее через ggplot(). Для этого воспользуемся тем, что результат выполнения lm() – это список, в котором содержится много разныз данных, в том числе, и остатки модели, и предсказанные значения отдельно.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="R_analysis.html#cb284-1" aria-hidden="true" tabindex="-1"></a>lm_model1<span class="sc">$</span>residuals</span></code></pre></div>
<pre><code>##            1            2            3            4            5            6 
##  0.997407159  1.481886411  1.267715027  1.412543292  1.166313745  1.243010830 
##            7            8            9           10           11           12 
##  1.253929148  0.986719880  1.051617026  0.962411926  0.962691645  0.733428422 
##           13           14           15           16           17           18 
##  0.786475705  0.834029838  1.067738926  0.770346797  0.849082103  0.955495407 
##           19           20           21           22           23           24 
##  0.372055959  1.135125638  1.021579609  0.986770129  0.788905071  0.611797081 
##           25           26           27           28           29           30 
##  0.819942517  0.884344054  0.645655553  0.797758621  1.209389508  1.205583090 
##           31           32           33           34           35           36 
##  1.167533157  0.939283220  0.884847538  0.965022427  0.998514422  0.946220795 
##           37           38           39           40           41           42 
##  1.011018271  0.730274327  0.952553159  0.994999289  0.999494934  1.032427982 
##           43           44           45           46           47           48 
##  1.180679920  0.940764864  0.925773815  1.094812076  0.792422266  0.899726899 
##           49           50           51           52           53           54 
##  0.960156414  0.944804875  0.882899184  1.052418357  0.949067030  1.002206645 
##           55           56           57           58           59           60 
##  0.919755874  0.859192204  0.766039265  0.755987593  0.851688843  1.019177143 
##           61           62           63           64           65           66 
##  1.297862663  1.092716714  0.929780865  0.882580961  0.927321369  0.948718965 
##           67           68           69           70           71           72 
##  0.959816733  1.053866642  0.714272854  0.904042071  0.816074094  0.772653399 
##           73           74           75           76           77           78 
##  0.966567924  0.914478548  0.689364245  0.851663333  0.768695915  0.782825561 
##           79           80           81           82           83           84 
##  0.799117933  0.897085485  0.712964145  0.997525779  0.793334471  0.986539898 
##           85           86           87           88           89           90 
##  0.858844222  1.044376684  0.915373982  0.708795298  0.733597617  0.852000460 
##           91           92           93           94           95           96 
##  0.990293812  0.629518438  1.040997799  1.140270131  1.121976564  1.176138751 
##           97           98           99          100          101          102 
##  0.853268700  1.046927644  1.116295279  0.787630134  0.512750791  0.620454803 
##          103          104          105          106          107          108 
##  0.646009401  0.786428399  0.935385704  0.863912563  0.966211160  0.417083476 
##          109          110          111          112          113          114 
##  0.543790400  0.132397652  0.550565490  0.875434902  0.652319032  0.557358821 
##          115          116          117          118          119          120 
##  0.550570712  0.495814419  0.396152336  0.612144963  0.500732580  0.198236422 
##          121          122          123          124          125          126 
##  1.397071529  1.540661593  1.842442685  1.237391617  2.018656920  1.648283877 
##          127          128          129          130          131          132 
##  1.583783130  1.600978589  1.478368917  1.549841457  1.138088754  0.338984814 
##          133          134          135          136          137          138 
##  0.206613399 -0.048717404  0.046853486  0.207589469  0.259815828  0.116166351 
##          139          140          141          142          143          144 
##  0.194967932  0.456131572  0.464131260  0.510654096  0.692977112  1.055159240 
##          145          146          147          148          149          150 
##  0.682737235  1.024187105  1.341862535  1.131607138  1.310187177  0.925133918 
##          151          152          153          154          155          156 
##  1.390208831  1.233749592  0.832796535  0.454450637  0.809150850  0.732513508 
##          157          158          159          160          161          162 
##  0.630337732  0.376833192  0.631748086  0.459153656  0.629835595  0.373706929 
##          163          164          165          166          167          168 
##  0.416382799  0.244167269  0.554019931  1.006502975  0.527075220  0.729346380 
##          169          170          171          172          173          174 
##  0.460270598  0.420880842  0.208165119  0.412520355  0.062389005 -0.130733273 
##          175          176          177          178          179          180 
## -0.093181087  0.024445816  0.026479716 -0.090381953  0.066847258 -0.196985637 
##          181          182          183          184          185          186 
## -0.389966511  0.993366377  0.813536567  0.731480600  1.038715284  1.224735726 
##          187          188          189          190          191          192 
##  1.038826966  1.130375963  1.525251496  1.648045787  0.874649959  0.417131254 
##          193          194          195          196          197          198 
## -0.961613064 -0.358776415 -0.021519043 -0.186975772 -0.657384119 -0.362773070 
##          199          200          201          202          203          204 
## -0.363352029 -0.427653583  0.082863448 -0.367618540  0.380404830  0.581407744 
##          205          206          207          208          209          210 
##  0.375723911  0.569612242  0.527054119  0.643218853  0.478202136  0.483985183 
##          211          212          213          214          215          216 
##  0.511148241  0.334506107  0.080495412  0.545449198  0.203119814 -0.189563575 
##          217          218          219          220          221          222 
## -0.116173041  0.607196980  0.714210921  0.567828681  0.608903178  0.727042900 
##          223          224          225          226          227          228 
##  0.824513302  0.502357632  0.122473584  0.520468479  1.216048860  1.196360644 
##          229          230          231          232          233          234 
##  1.303231805  1.562042865  1.422155086  0.977603881  0.947487545  0.688063108 
##          235          236          237          238          239          240 
##  0.634480551  0.539248049  0.509099500  0.213006511  0.078983015  0.594978457 
##          241          242          243          244          245          246 
##  0.548021233  0.847246087  0.555278073  0.659284436  0.774685691  0.788200547 
##          247          248          249          250          251          252 
##  0.459903103  0.308394321  0.286027883  0.048195505  0.118526465  0.128182491 
##          253          254          255          256          257          258 
##  0.495532283  0.262508668  0.349866781 -0.016400710 -0.308399661  0.098914407 
##          259          260          261          262          263          264 
##  0.374809771  0.381533180  0.467299536 -0.157329054 -0.265065354 -0.266390500 
##          265          266          267          268          269          270 
##  0.225578384  0.135886080 -0.001121846 -0.080167329  0.523983266  0.236581920 
##          271          272          273          274          275          276 
##  0.693728339  0.566048099  0.529593476  0.625428176  0.691919662  0.231890057 
##          277          278          279          280          281          282 
##  0.148096514 -0.427857281 -0.053621362 -0.258657697  0.135361797  0.164477023 
##          283          284          285          286          287          288 
##  0.275292092  0.603278008  0.614881117  0.687898089  0.700778817  0.800289206 
##          289          290          291          292          293          294 
##  0.916051449  0.932388558  0.821452417  1.025077439  0.842411475  0.765636266 
##          295          296          297          298          299          300 
##  0.055245733  0.704418948  0.181482572  0.596817655 -0.101777215  0.401846794 
##          301          302          303          304          305          306 
##  0.551448892  0.243866208  0.261178470  0.057486308 -0.056539190  0.310557983 
##          307          308          309          310          311          312 
##  0.320535028  0.183895523  0.027693843 -0.124250120  0.566665650  1.010903741 
##          313          314          315          316          317          318 
##  0.599082098  0.513456652  1.263600546  0.460427458 -0.154722409  0.526609602 
##          319          320          321          322          323          324 
##  0.720344326  0.239986733 -0.388016818 -0.244022613  0.099624050 -0.220949161 
##          325          326          327          328          329          330 
## -0.120363990 -0.343396840 -0.287563574 -0.895969770 -0.835849485 -0.453525458 
##          331          332          333          334          335          336 
## -0.736122413 -0.692835048 -0.002608077  0.840942522  0.651250743  0.954699665 
##          337          338          339          340          341          342 
## -0.107593920 -0.114620705  0.225451186  0.020424779 -0.109903234  0.184158277 
##          343          344          345          346          347          348 
##  0.082726287 -0.332720017 -0.151780153 -0.305024868 -0.027362926  0.705038796 
##          349          350          351          352          353          354 
##  1.157433299  0.797832029  1.197230587  1.274582151  1.324350250  1.157296795 
##          355          356          357          358          359          360 
##  0.596624283  0.703089717  0.820667945  1.357163499  1.271186522  0.533811811 
##          361          362          363          364          365          366 
## -0.912717219 -1.032801273 -0.403542794 -0.127140906 -0.569520384 -0.727641735 
##          367          368          369          370          371          372 
## -0.434130329 -0.700710984 -0.709714464 -0.351811541 -0.769467814 -0.530444139 
##          373          374          375          376          377          378 
## -1.635874631 -1.447222441  0.184779734 -0.359648168 -0.518914265 -0.109591720 
##          379          380          381          382          383          384 
## -0.405613081  0.406364431  0.250785209 -1.627184473  1.443230812  0.741392437 
##          385          386          387          388          389          390 
##  0.397769769  1.364612104  1.676746873  0.758763576  1.215682293  0.702470914 
##          391          392          393          394          395          396 
##  0.325470426 -0.189402608 -0.230418215 -0.738718415 -0.060512319 -0.187361030 
##          397          398          399          400          401          402 
## -0.232283117 -0.216998224 -0.034065784 -0.038263355  0.959224460  0.631632203 
##          403          404          405          406          407          408 
##  0.215857930  0.099461943  1.765947511  1.654603524 -0.368418161  0.807494087 
##          409          410          411          412          413          414 
##  1.184280404  0.704798356  0.853021130  0.214044355  0.097587296  0.293010882 
##          415          416          417          418          419          420 
## -0.160726155 -0.558080851 -0.402145752 -0.220665814 -0.118548390 -0.283152604 
##          421          422          423          424          425          426 
## -0.120808440  1.079893024 -0.262432990  0.194479116  0.338814956  0.622136434 
##          427          428          429          430          431          432 
##  0.933264711  0.595828192  0.620224890  0.917419535  1.394193345  1.016818798 
##          433          434          435          436          437          438 
##  0.838729425  0.637542886  0.604920290  0.508996542  0.304027558  0.908178228 
##          439          440          441          442          443          444 
##  1.141206167  1.016340298  1.082401559  0.961386470 -0.395845261  0.442809685 
##          445          446          447          448          449          450 
##  0.143815539  0.361929285 -0.038825900 -0.028515963 -0.328658235 -0.523210636 
##          451          452          453          454          455          456 
## -0.331612348 -0.308435775 -0.495082660  0.656525894 -0.312171332 -0.344026521 
##          457          458          459          460          461          462 
## -0.076583800  0.656927756  0.459660902  0.372454385  0.509107307  0.543319733 
##          463          464          465          466          467          468 
##  0.453727495  0.482389946  0.693195865  1.197228239 -0.469586607  0.144277965 
##          469          470          471          472          473          474 
## -0.154656373 -0.473655639 -0.498105530 -0.316690210 -0.111166674 -0.417941575 
##          475          476          477          478          479          480 
## -0.442563819 -0.483064567 -0.536767718 -0.526886100 -0.369153641 -0.181328748 
##          481          482          483          484          485          486 
## -0.028514419 -0.521654498 -0.431728799 -0.252705624 -0.253236580 -0.209781094 
##          487          488          489          490          491          492 
## -0.094768280 -0.112877212  0.669521232  0.458132130  0.107325026  0.778015520 
##          493          494          495          496          497          498 
##  0.874612400  0.858332943  1.011611456  1.220176857  0.913656282  1.039412518 
##          499          500          501          502          503          504 
##  1.142323055 -0.235561966 -1.013849802 -0.816771943 -0.459167414 -0.859038536 
##          505          506          507          508          509          510 
## -0.664850296 -0.698495154 -0.491922033 -0.587031772 -0.079451447 -0.097999252 
##          511          512          513          514          515          516 
##  0.023920652 -0.243031218 -0.039920917 -0.204949350 -0.118361029 -0.395114544 
##          517          518          519          520          521          522 
## -0.177226025 -0.317731833 -0.338108632 -0.109857865 -0.387582472 -0.824587652 
##          523          524          525          526          527          528 
## -0.425213773 -0.817933874 -0.561281203 -0.135958633  0.673492688 -0.282737690 
##          529          530          531          532          533          534 
## -0.345023038 -0.522236607 -0.559859519  0.637946680  0.484952822  0.718797801 
##          535          536          537          538          539          540 
##  0.356319882  1.131705816  0.808769018  0.781259082  0.995946106  0.707285432 
##          541          542          543          544          545          546 
##  0.776663761  0.722331677 -0.327471465  0.003916124 -0.229080858 -0.510322015 
##          547          548          549          550          551          552 
## -0.486586800 -0.915313794 -0.609001673 -0.308223175 -0.516598966 -0.018742472 
##          553          554          555          556          557          558 
## -0.455016758 -0.633974351  0.069326280 -0.035973887 -0.264256125 -0.166593532 
##          559          560          561          562          563          564 
## -0.261757301 -0.603774010 -0.093456327  0.026523686 -0.049552012 -0.112885994 
##          570          571          572          573          574          575 
## -0.304769917 -0.391109403 -0.373837453 -0.127335728 -0.177188762 -0.128623377 
##          576          577          578          579          580          581 
## -0.207170109 -0.524718184 -0.478489994  0.132191897 -0.457916472 -0.106418117 
##          582          583          584          585          586          587 
## -0.246855903  0.143929216  0.187937773  0.431780180  0.329545613  0.255280702 
##          588          589          590          591          592          593 
##  0.330944611  0.028249102  0.126688649  1.197577363  0.278748547 -0.113960462 
##          594          595          596          597          598          599 
## -0.244360622  0.092204673  0.062878844 -0.316214162 -0.325387508 -0.226950267 
##          600          601          602          603          604          605 
## -0.259833425 -0.352338826 -0.105958129 -0.129308889 -1.224964271 -1.344137853 
##          606          607          608          609          610          611 
## -0.846729216 -1.220049976 -0.967172896 -0.847515049 -0.928533513 -0.289839524 
##          612          613          614          615          616          617 
## -0.166163345 -0.480928542 -0.111205671  0.488867393  0.051628581  0.371244643 
##          618          619          620          621          622          623 
## -0.103501839 -0.801386317 -0.610892285 -0.817622102  0.462168278 -0.357339396 
##          624          625          626          627          628          629 
##  0.156302734  0.418155356  0.464107874  0.647700093  0.462021992  0.624256714 
##          630          631          632          633          634          635 
##  0.652968309 -0.188970870  0.240184874 -0.033106131 -0.659369429 -0.436406078 
##          636          637          638          639          640          641 
## -0.494797428 -0.936441408 -0.841411791 -0.709729292 -0.823529804 -0.203484730 
##          642          643          644          645          646          647 
## -0.185297941 -0.545356244 -0.745786196 -0.843560635 -0.684309501 -0.881740705 
##          648          649          650          651          652          653 
## -0.607520742 -0.764362046 -0.777718150 -0.612274911 -0.551183600  0.043310490 
##          654          655          656          657          658          659 
##  0.891253915  0.102814853  0.444037605 -0.589513160 -0.177286564 -0.524195744 
##          660          661          662          663          664          665 
## -0.353218384 -0.584402730  0.072437707 -0.066976277 -0.574055047 -0.772642705 
##          669          670          671          672          673          674 
##  0.373163660 -0.099735289  0.304607643  0.655948716 -0.077083767 -0.422688465 
##          675          676          677          678          679          680 
##  0.342077936  0.810941851 -0.324214984 -0.285099289 -0.743946615 -1.072345103 
##          681          682          683          684          685          686 
## -0.236711863 -0.739266135 -0.599485832 -0.372227505 -0.657807094 -0.643756205 
##          687          688          689          690          691          692 
## -1.113115746 -0.446806507 -0.544117600 -0.346548706 -0.227169580 -0.108480402 
##          693          694          695          696          697          698 
## -0.427691626  0.205710993  0.155650229 -0.163791136 -0.002545888 -0.108885141 
##          699          700          701          702          703          704 
##  0.169067920 -0.412074281 -0.026492640  0.961477748  0.208551842 -0.476547387 
##          705          706          707          708          709          710 
##  0.590634067  0.182057661  0.171979323 -0.214944429 -0.157604821  0.014952768 
##          711          712          713          714          715          716 
##  0.097897205 -0.473019438 -0.751189372 -1.068365744 -0.879673221 -1.174471069 
##          717          718          719          720          721          722 
## -1.555931487 -1.084892557 -0.860878775 -0.322688601 -0.557768958 -0.661803222 
##          723          724          725          726          727          728 
##  0.243113074 -0.235051114  0.133458129 -0.369210349 -0.074921556 -0.055879792 
##          729          730          731          732          733          734 
## -0.017927943 -0.045659325 -0.109084920  0.194400650  0.397504223 -0.373757819 
##          735          736          737          738          739          740 
## -0.537686512 -0.330180231 -0.411336388 -0.866245695 -0.739292394 -0.418858381 
##          741          742          743          744          745          746 
## -0.413655188 -0.319261889 -0.413244660 -0.350730440 -0.156163643  0.398224278 
##          747          748          749          750          751          752 
## -0.262684762  0.248946156  0.266923746  0.269531505  0.255544331  0.575853954 
##          753          754          755          756          757          758 
##  0.515570638  0.406305508  0.706053622  0.838545930  0.673922683  0.314167641 
##          759          760          761          762          763          764 
##  0.089934360 -0.825622480 -1.217131067 -1.143446473 -0.805750492 -0.462443482 
##          765          766          767          768          769          770 
## -0.537578581 -0.516459378 -0.320775734 -0.340369931 -0.472739320 -0.432275798 
##          771          772          773          774          775          776 
## -0.738512415 -0.426069962 -0.649698661 -0.325251085 -0.216514792 -0.377056682 
##          777          778          779          780          781          782 
## -0.460489120 -0.460078489 -0.859875545 -0.224564311 -0.479276883 -0.462552685 
##          783          784          785          786          787          788 
## -0.632090075 -0.436110755 -0.618236204 -0.445409929 -0.317341025 -0.366630746 
##          789          790          791          792          793          794 
## -0.618825276 -0.026466861 -0.772672418 -0.124436561 -0.778153749 -0.542097384 
##          795          796          797          798          799          800 
## -0.215950237 -0.583170729  0.193199791 -0.718653434 -0.044637632 -0.171287003 
##          801          802          803          804          805          806 
## -0.020809261 -0.031072154 -0.678583588 -0.834353150 -1.107935442 -1.125355295 
##          807          808          809          810          811          812 
## -1.301546295 -1.123410523 -1.349188043 -1.135516908 -0.902147533 -0.764667332 
##          813          814          815          816          817          818 
##  0.656300039  0.474043717  0.871682738 -0.383207196  0.405581791  0.987173014 
##          819          820          821          822          823          824 
##  0.463709168  0.318220748  0.308497334  0.587662908 -0.043924758 -0.367182919 
##          825          826          827          828          829          830 
## -0.088598170 -0.925194012 -1.113932492 -0.560975295 -0.765615897 -0.574937130 
##          831          832          833          834          835          836 
## -1.159222883 -0.715412964 -0.435745760 -0.470664216 -0.721906255 -0.758727584 
##          837          838          839          840          841          842 
## -0.464223944 -1.077138516 -0.939075899 -1.137609167 -0.969521808 -1.010898120 
##          843          844          845          846          847          848 
## -1.073415662 -0.283892025 -0.969314443 -1.070452520 -1.342197365 -0.640793511 
##          849          850          851          852          853          854 
## -0.895341729 -0.369585645 -0.377779643 -0.633341953  0.033615448  0.621723528 
##          855          856          857          858          859          860 
##  0.705546878  0.730452708  0.522583047  0.475550469  0.910237162  0.647886563 
##          861          862          863          864          865          866 
##  0.105365561  0.132909502  0.084508824 -0.961085947 -0.416981149 -0.329252055 
##          867          868          869          870          871          872 
## -0.560497521 -0.993953182 -0.224249664 -0.719324730 -0.351228980 -0.781635002 
##          873          874          875          876          877          878 
## -0.226031857  0.354031733 -0.215320616 -0.371565928 -0.769115933 -0.992560604 
##          879          880          881          882          883          884 
## -1.349592644 -1.324018970 -0.460464428  0.630254022  0.462437197  0.241133793 
##          885          886          887          888          889          890 
##  0.833236434  0.333122977  0.108429627 -0.045773549  0.151273106  0.585017305 
##          891          892          893          894          895          896 
##  0.483129643  0.684258947 -0.465767688 -0.560163509 -0.729117023 -0.649432503 
##          897          898          899          900          901          902 
## -0.308883158 -0.527088893 -0.566747193 -0.697125072 -0.543367257 -0.006426528 
##          903          904          905          906          907          908 
##  0.464504988  0.710431949  0.347432397 -0.130981142  0.243984328 -0.104758369 
##          909          910          911          912          913          914 
##  0.046427827  0.069096871  0.080751977 -0.175396608  0.530496370 -0.163742151 
##          915          916          917          918          919          920 
## -0.074199931  0.828159500  0.676328814  0.348618106  0.656727496  1.303001593 
##          921          922          923          924          925          926 
##  1.123369330  0.204405067 -0.170867720 -0.067002542  0.265879203  0.040290131 
##          927          928          929          930          931          932 
## -1.231764001 -0.450648219 -0.500083972 -0.700983254 -1.104627318 -1.196401957 
##          933          934          935          936          937          938 
## -0.654839900 -1.136300328 -1.049772648 -0.333071578  0.393965093 -0.471477683 
##          939          940          941          942          943          944 
##  0.225441819  0.711001769  0.380122670  0.362343868  0.578875289 -0.330775472 
##          945          946          947          948          949          950 
##  0.167636040  0.762820318  0.444382980  0.608982665  0.264604933  0.715445684 
##          951          952          953          954          955          956 
##  0.121131064 -0.435765595 -0.037909355  0.312345854  0.648528475  0.470367698 
##          957          958          959          960          961          962 
##  0.034005274 -0.065988703 -0.599433236 -0.276843289 -0.311885619 -0.075109652 
##          963          964          965          966          967          968 
## -0.060234351 -0.243250238  0.008777751 -0.083218216 -0.174913132 -1.011362295 
##          969          970          971          972          973          974 
## -0.695124074  0.093532053 -0.153717795  0.424084191  0.055097822 -0.913127138 
##          975          976          977          978          979          980 
## -0.664600095 -0.890157692 -0.053572147  0.073632030  0.320417926  0.730396197 
##          981          982          983          984          985          986 
##  0.732622131  0.476326372  0.565558952  0.266173064  0.167292169  0.107616015 
##          987          988          989          990          991          992 
##  0.066738962  0.783271809 -0.141664965 -0.221374369 -0.829994203  0.279265715 
##          993          994          995          996          997          998 
##  0.618882106  0.420980392  0.390244272  0.986420992 -1.375459086 -0.986855169 
##          999         1000         1001         1002         1003         1004 
## -0.806344078 -0.541010363 -0.912188900 -1.050714250 -1.014923287 -1.179420075 
##         1005         1006         1007         1008         1009         1010 
## -1.239179798 -0.825137325 -0.385897123  0.200403991 -0.645179899 -0.161550650 
##         1011         1012         1013         1014         1015         1016 
## -0.224780633  0.229033383  0.037172969 -0.093066200 -0.295240309 -0.287982305 
##         1017         1018         1019         1020         1021         1022 
## -0.341254198  0.435054109  0.225835798  0.687801376  0.516175593  0.524671615 
##         1023         1024         1025         1026         1027         1028 
##  0.536669931 -0.811154027 -0.432282585 -0.342749555 -0.216438800 -0.324633690 
##         1029         1030         1031         1032         1033         1034 
## -0.903973931 -0.640168062 -0.442678351 -1.923363037 -0.758633097 -0.699041889 
##         1035         1036         1037         1038         1039         1040 
## -0.892556259 -0.810393912 -0.783709511 -0.805517493 -1.045351318 -1.333149861 
##         1041         1042         1043         1044         1045         1046 
## -1.185098358 -1.202000988 -1.080890240 -1.206903915 -0.881578312  0.716394458 
##         1047         1048         1049         1050         1051         1052 
##  0.336764467  0.438384163 -0.235792247  0.169631727 -0.222734045 -0.167524459 
##         1053         1054         1055         1056         1057         1058 
## -0.496770827 -0.544401763 -0.676208544 -0.334541316 -0.336273622 -0.652884855 
##         1059         1060         1061         1062         1063         1064 
## -0.092524635 -0.698259557 -0.895006179 -0.094876938  0.204052405 -0.742916295 
##         1065         1066         1067         1068         1069         1070 
## -0.328665609 -0.748509067 -1.240729644 -1.210625188 -1.855641100 -0.534031938 
##         1071         1072         1073         1074         1075         1076 
## -0.672601099 -0.954458057 -0.773208233 -0.283011096 -0.568377759 -0.934579849 
##         1077         1078         1079         1080         1081         1082 
## -0.763400087 -0.905248920 -0.895987415 -0.959623345 -0.806722967 -0.932126312 
##         1083         1084         1085         1086         1087         1088 
## -0.120120816 -0.115478122  0.208196265 -0.333490186 -0.082116360 -0.136337809 
##         1089         1090         1091         1092         1093         1094 
## -0.010760313  0.118137348 -0.656405175  0.433628011 -0.135311149 -1.202352233 
##         1095         1096         1097         1098         1099         1100 
## -0.442414932 -0.055039840 -0.155732698 -0.046911886 -0.188467967 -0.205053126 
##         1101         1102         1103         1104         1105         1106 
## -0.261446628 -0.582477282 -0.987407384 -1.246578175 -0.230512525  0.097478032 
##         1107         1108         1109         1110         1111         1112 
##  0.770465434  0.469792387 -0.313723141  0.057059075  0.979700157  0.380661386 
##         1113         1114         1115         1116         1117         1118 
##  0.253556231 -0.862989698 -0.748487995  0.963439098  0.598789119  1.081101420 
##         1119         1120         1121         1122         1123         1124 
##  1.177331693  0.999895280  0.874203946  0.337511263 -0.923983181 -1.300111969 
##         1125         1126         1127         1128         1129         1130 
## -1.364151641 -0.941746275 -1.279241820 -1.032791576 -0.993042799 -0.996954487 
##         1131         1132         1133         1134         1135         1136 
## -0.936764772 -1.041409073 -1.230021754 -0.830550066 -1.052734235 -0.434983061 
##         1137         1138         1139         1140         1141         1142 
## -1.033565070 -1.004392760 -0.933545611 -0.299376257  0.231855277  0.146508395 
##         1143         1144         1145         1146         1147         1148 
##  0.393439694  0.390484249  0.045133729  0.073083443 -0.456047976 -0.631417119 
##         1149         1150         1151         1152         1153         1154 
## -0.655761483  0.084054926  0.281508987 -1.018176517 -1.858119559 -1.830569165 
##         1155         1156         1157         1158         1159         1160 
## -1.886296817 -1.543909863 -1.783709900 -1.352303598 -0.956447363 -0.192057375 
##         1161         1162         1163         1164         1165         1166 
## -0.489026475 -0.377011232 -0.095682500  0.163125349  0.163415087  0.032146511 
##         1167         1168         1169         1170         1171         1172 
## -0.463786130 -0.198467488 -0.747611041 -0.452301593 -0.233704151 -0.740571021 
##         1173         1174         1175         1176         1177         1178 
## -0.689663675  0.121432241  0.673819000  0.746962521  0.770667573  0.482951715 
##         1179         1180         1181         1182         1183         1184 
## -0.021004329 -0.497290723 -0.302626352  0.227445624  1.242998706  1.431629637 
##         1185         1186         1187         1188         1189         1190 
##  0.189617668  0.530935656  0.270929400  0.779479148  0.085171617 -0.643596054 
##         1191         1192         1193         1194         1195         1196 
## -0.159003553 -0.184930252 -0.361984156 -0.215421050 -0.979379153 -1.516499071 
##         1197         1198         1199         1200         1201         1202 
## -1.812164935 -1.999538955 -1.889605337 -1.153669184 -0.206929313 -0.134508007 
##         1203         1204         1205         1206         1207         1208 
## -0.044570450 -0.192384838 -0.422372804  0.481078345  0.155402624 -0.476710570 
##         1209         1210         1211         1212         1213         1214 
## -0.207253793  0.378925128 -0.740584343 -0.301061844 -0.216577464 -0.255290592 
##         1215         1216         1217         1218         1219         1220 
##  0.794101801  0.352366606  0.540292710 -0.203515493 -0.521800781 -2.265153694 
##         1221         1222         1223         1224         1225         1226 
## -0.846116737 -0.214234386 -2.088585606 -2.151949937 -0.854672463 -1.628256084 
##         1227         1228         1229         1230         1231         1232 
## -1.741687765 -1.984439619 -0.025136933 -0.501411462 -0.163493688 -0.138305925 
##         1233         1234         1235         1236         1237         1238 
## -0.090409980 -0.258883625 -0.764950544 -0.977647221 -0.147088105 -0.180347238 
##         1239         1240         1241         1242         1243         1244 
## -0.718110800 -0.191990783  0.077113722 -0.263940356 -0.265054059 -0.283801074 
##         1245         1246         1247         1248         1249         1250 
## -0.586597771 -0.851271111 -0.681472593 -0.441172054 -1.285314067  0.551048358 
##         1251         1252         1253         1254         1255         1256 
## -0.688748005 -1.134798436  0.579429566  0.203708037  0.748807085  0.666933993 
##         1257         1258         1259         1260         1261         1262 
##  0.731744701  0.534109114  1.000529451  0.188138846  0.096799612  0.536061284 
##         1263         1264         1265         1266         1267         1268 
##  0.023525956 -1.165965558 -0.377591242 -0.115251577 -0.157857897 -0.697162992 
##         1269         1270         1271         1272         1273         1274 
##  0.010270549  0.503360852 -0.496128133 -0.462605847  0.212037828 -0.186886367 
##         1275         1276         1277         1278         1279         1280 
## -0.728722684 -0.801489688  0.064422557  0.118084666 -0.115977400  0.081191430 
##         1281         1282         1283         1284         1285         1286 
## -0.119299555  0.054184651  0.778704989 -0.075815075 -0.724534890 -0.578589755 
##         1287         1288         1289         1290         1291         1292 
##  0.352455548  0.125757097 -0.185301410  0.502677343  0.579086083  0.599145740 
##         1293         1294         1295         1296         1297         1298 
##  0.164789586  0.756645294  0.237157469 -0.363594766 -0.315347048  0.139536542 
##         1299         1300         1301         1302         1303         1304 
## -0.184265041 -0.305822546  0.012171693 -0.481704090 -0.964830753 -0.648175725 
##         1305         1306         1307         1308         1309         1310 
## -0.506464760 -0.735595034 -1.357584723 -0.304233487  0.001561775  0.608493024 
##         1311         1312         1313         1314         1315         1316 
##  0.429734875 -0.402917626 -0.134336745 -0.278479467 -0.364371175 -1.521023845 
##         1317         1318         1319         1320         1321         1322 
## -0.252465024  0.105836850  0.155848423 -0.836796519 -1.037505853 -0.226236293 
##         1323         1324         1325         1326         1327         1328 
## -0.306921429 -0.490368663 -0.886429635 -0.736065750 -0.154756777  0.293866544 
##         1329         1330         1331         1332         1333         1334 
##  0.793633819  0.741706033  1.013240628 -0.838409581 -0.590672077 -0.035367792 
##         1335         1336         1337         1338         1339         1340 
## -0.454659774 -0.216464742 -0.715691780 -0.633499213 -0.818561185  0.415476204 
##         1341         1342         1343         1344         1345         1346 
##  0.470021771  0.112121639  0.109059505 -0.697859100 -0.579545289 -0.486223508 
##         1347         1348         1349         1350         1351         1352 
## -0.643483591 -0.229966852 -0.806126548 -0.505229054 -0.293864591 -0.984826696 
##         1353         1354         1355         1356         1357         1358 
## -0.729699159 -0.886744635 -0.604313977  0.063478569 -0.189443180  0.366229856 
##         1359         1360         1361         1362         1363         1364 
##  0.683622496 -0.264106518 -0.388658966 -0.603289320 -1.040574201 -0.176433000 
##         1365         1366         1367         1368         1369         1370 
## -0.084385863 -0.649628332 -1.037257561 -0.939109194 -1.083840133 -0.174376686 
##         1372         1373         1374         1375         1376         1377 
##  0.380370633  0.033940975 -0.537518785 -0.964710817 -1.717827664 -2.070367102 
##         1378         1379         1380         1381         1382         1383 
## -0.652215787  0.048122009  0.275870307  0.178990300  0.555173556 -0.057612339 
##         1384         1385         1386         1387         1388         1389 
##  0.032817876 -0.698488937 -0.356076345  0.607888861  0.480482488  0.567512019 
##         1390         1391         1392         1393         1394         1395 
## -0.088753172  1.034698238 -1.008211631 -1.433430357 -1.153562207 -0.950927613 
##         1396         1397         1398         1399         1400         1401 
## -1.149655566 -1.144220906 -1.204626597 -1.186734323  0.498158270 -0.658182833 
##         1402         1403         1404         1405         1406         1407 
##  1.048592011  1.254941708  1.048239597  1.286034078  0.747446816  0.357830280 
##         1412         1413         1414         1415         1416         1417 
## -0.329885222 -0.211856098 -0.846963059 -0.227567604 -0.157249561 -0.348108784 
##         1418         1419 
## -0.159193610 -0.169537029</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="R_analysis.html#cb286-1" aria-hidden="true" tabindex="-1"></a>lm_model1<span class="sc">$</span>fitted.values</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 6.560375 6.537048 6.566518 6.558349 6.517045 6.527505 6.534303 6.533190 
##        9       10       11       12       13       14       15       16 
## 6.536990 6.545147 6.551733 6.725092 6.686777 6.690491 6.708470 6.722457 
##       17       18       19       20       21       22       23       24 
## 6.723055 6.554539 6.516228 6.455534 6.479815 6.511301 6.807427 6.803885 
##       25       26       27       28       29       30       31       32 
## 6.812345 6.793933 6.798815 6.805675 6.450454 6.466866 6.503093 6.453981 
##       33       34       35       36       37       38       39       40 
## 6.469378 6.455187 6.446121 6.438350 6.436907 6.514572 6.465495 6.486754 
##       41       42       43       44       45       46       47       48 
## 6.486109 6.455396 6.469666 6.485289 6.489371 6.498982 6.511836 6.513046 
##       49       50       51       52       53       54       55       56 
## 6.580721 6.519174 6.568980 6.578594 6.552809 6.561591 6.550960 6.547358 
##       57       58       59       60       61       62       63       64 
## 6.555149 6.568450 6.373999 6.285837 6.306311 6.288454 6.293975 6.308057 
##       65       66       67       68       69       70       71       72 
## 6.322309 6.331433 6.346076 6.364254 6.535807 6.436646 6.469317 6.481104 
##       73       74       75       76       77       78       79       80 
## 6.483479 6.491138 6.506221 6.512506 6.519854 6.526235 6.569626 6.479230 
##       81       82       83       84       85       86       87       88 
## 6.528398 6.518472 6.472643 6.509479 6.523388 6.515771 6.518637 6.530352 
##       89       90       91       92       93       94       95       96 
## 6.555325 6.307010 6.183123 6.211597 6.220264 6.212709 6.236940 6.257009 
##       97       98       99      100      101      102      103      104 
## 6.257586 6.273636 6.284275 6.291781 6.535321 6.501757 6.534945 6.516250 
##      105      106      107      108      109      110      111      112 
## 6.535127 6.536776 6.532592 6.532916 6.532657 6.671202 6.631228 6.637253 
##      113      114      115      116      117      118      119      120 
## 6.628067 6.600674 6.613045 6.619324 6.630075 6.637140 6.650382 6.665710 
##      121      122      123      124      125      126      127      128 
## 5.738546 5.541804 5.589690 5.613288 5.596272 5.622770 5.645105 5.671272 
##      129      130      131      132      133      134      135      136 
## 5.679632 5.697245 5.715916 6.534778 6.412936 6.465537 6.474937 6.433904 
##      137      138      139      140      141      142      143      144 
## 6.464715 6.505146 6.507394 6.508994 6.520083 6.526483 5.681840 5.581612 
##      145      146      147      148      149      150      151      152 
## 5.637936 5.667238 5.658969 5.705724 5.727629 5.734870 5.750074 5.747249 
##      153      154      155      156      157      158      159      160 
## 5.714100 6.494486 6.453140 6.486326 6.486253 6.476681 6.479616 6.475968 
##      161      162      163      164      165      166      167      168 
## 6.473825 6.481622 6.487836 6.796564 6.590227 6.561527 6.518836 6.528043 
##      169      170      171      172      173      174      175      176 
## 6.546634 6.543765 6.551920 6.605859 6.767736 7.098074 7.051101 7.072806 
##      177      178      179      180      181      182      183      184 
## 7.074921 7.054479 7.063962 7.088113 7.091538 5.830807 5.767121 5.793898 
##      185      186      187      188      189      190      191      192 
## 5.790321 5.738083 5.763562 5.779139 5.794934 5.794501 5.805181 5.819156 
##      193      194      195      196      197      198      199      200 
## 6.995094 6.821479 6.855274 6.828933 6.802061 6.894175 6.924394 6.960861 
##      201      202      203      204      205      206      207      208 
## 6.979501 6.987143 6.443879 6.402149 6.426207 6.416851 6.379493 6.386145 
##      209      210      211      212      213      214      215      216 
## 6.391047 6.396799 6.406907 6.423642 6.434950 6.033607 5.859732 5.887493 
##      217      218      219      220      221      222      223      224 
## 5.905612 5.886489 5.921445 5.958506 5.990226 6.013111 6.019725 6.030392 
##      225      226      227      228      229      230      231      232 
## 5.995165 5.607520 5.678091 5.734543 5.730508 5.759425 5.825926 5.882232 
##      233      234      235      236      237      238      239      240 
## 5.918993 5.943108 5.971070 5.887973 5.803826 5.860152 5.882051 5.829155 
##      241      242      243      244      245      246      247      248 
## 5.893046 5.928559 5.913109 5.922976 5.896429 5.908930 6.275724 6.130862 
##      249      250      251      252      253      254      255      256 
## 6.214166 6.201422 6.212965 6.205967 6.202123 6.221221 6.258151 6.847351 
##      257      258      259      260      261      262      263      264 
## 7.042622 6.767148 6.722646 6.737168 6.750467 6.778280 6.804920 6.834788 
##      265      266      267      268      269      270      271      272 
## 5.945907 5.649982 5.695068 5.744037 5.772239 5.825429 5.860319 5.883680 
##      273      274      275      276      277      278      279      280 
## 5.914871 5.936016 5.936161 6.358952 6.179543 6.201732 6.208340 6.221530 
##      281      282      283      284      285      286      287      288 
## 6.244563 6.287641 6.338102 5.630437 5.410062 5.450513 5.467616 5.471315 
##      289      290      291      292      293      294      295      296 
## 5.492062 5.531564 5.553427 5.581473 5.606378 5.621936 6.419963 6.388974 
##      297      298      299      300      301      302      303      304 
## 6.401218 6.411247 6.385276 6.396054 6.407736 6.405499 6.405943 6.409382 
##      305      306      307      308      309      310      311      312 
## 6.414164 5.763082 5.564898 5.599996 5.608777 5.599895 5.650037 5.652705 
##      313      314      315      316      317      318      319      320 
## 5.701153 5.717568 5.721863 5.741335 6.628644 6.553035 6.546350 6.571384 
##      321      322      323      324      325      326      327      328 
## 6.535607 6.551121 6.600165 6.617309 6.615497 6.621775 6.633055 7.270499 
##      329      330      331      332      333      334      335      336 
## 7.253674 7.303178 7.327727 7.304134 6.321220 6.311843 6.343364 6.339773 
##      337      338      339      340      341      342      343      344 
## 6.306195 6.302883 6.292798 6.270266 6.259931 6.272319 6.297937 5.673574 
##      345      346      347      348      349      350      351      352 
## 5.615347 5.622219 5.631959 5.649860 5.201483 5.103597 5.132351 5.139912 
##      353      354      355      356      357      358      359      360 
## 5.127566 5.132452 5.146730 5.152627 5.163934 5.178867 5.193800 5.735475 
##      361      362      363      364      365      366      367      368 
## 6.859912 7.108348 6.988789 6.925292 6.947220 6.948736 6.914161 6.880850 
##      369      370      371      372      373      374      375      376 
## 6.855746 6.521485 6.469991 6.467313 6.459851 6.474409 6.504931 6.524782 
##      377      378      379      380      381      382      383      384 
## 6.526290 6.277299 6.237802 6.290080 6.267961 5.668299 5.726390 5.783754 
##      385      386      387      388      389      390      391      392 
## 5.860002 5.824191 5.801708 5.821026 5.850895 5.850325 5.810626 5.758203 
##      393      394      395      396      397      398      399      400 
## 6.223581 6.003395 6.112736 6.132409 6.143342 6.153525 6.172939 6.200268 
##      401      402      403      404      405      406      407      408 
## 5.180600 5.069297 5.079677 5.092032 5.073139 5.085308 5.109713 5.126877 
##      409      410      411      412      413      414      415      416 
## 5.140783 5.151725 5.165475 6.108077 5.914130 5.945894 5.967508 5.942783 
##      417      418      419      420      421      422      423      424 
## 5.982427 6.007033 6.032832 6.053352 6.083730 4.932847 4.722591 4.749612 
##      425      426      427      428      429      430      431      432 
## 4.765013 4.730668 4.753435 4.789877 4.827781 4.854855 4.881073 4.907294 
##      433      434      435      436      437      438      439      440 
## 5.053810 4.594779 4.706448 4.751724 4.791315 4.830566 4.878126 4.923646 
##      441      442      443      444      445      446      447      448 
## 4.966811 5.010978 6.350369 6.410974 6.430597 6.417845 6.372626 6.382754 
##      449      450      451      452      453      454      455      456 
## 6.385745 6.362525 6.340986 6.335021 6.342767 5.458912 5.336363 5.339902 
##      457      458      459      460      461      462      463      464 
## 5.373097 5.364876 5.378390 5.422634 5.451609 5.475886 5.492124 5.481685 
##      465      466      467      468      469      470      471      472 
## 5.262451 5.253416 6.424237 6.371539 6.392854 6.384335 6.343105 6.373443 
##      473      474      475      476      477      478      479      480 
## 6.373960 6.386158 6.401925 6.405685 6.416452 6.060438 5.845102 5.899882 
##      481      482      483      484      485      486      487      488 
## 5.914934 5.904218 5.946015 5.988369 6.012706 6.045264 6.064866 6.062872 
##      489      490      491      492      493      494      495      496 
## 4.908263 4.643939 4.667593 4.724741 4.679762 4.731404 4.780651 4.775536 
##      497      498      499      500      501      502      503      504 
## 4.842403 4.877646 4.875149 6.090508 5.977593 6.039639 6.077921 6.017266 
##      505      506      507      508      509      510      511      512 
## 6.049624 6.087261 6.112658 6.124209 6.116428 6.093538 6.138156 5.830240 
##      513      514      515      516      517      518      519      520 
## 5.926058 5.976977 6.005391 6.041319 6.053158 6.063864 6.088391 6.116880 
##      521      522      523      524      525      526      527      528 
## 6.358147 6.156765 6.192490 6.207558 6.208971 6.251983 6.273106 6.286025 
##      529      530      531      532      533      534      535      536 
## 6.303833 6.323562 6.340071 5.131777 4.889033 4.909622 4.941553 4.953874 
##      537      538      539      540      541      542      543      544 
## 4.971851 4.997615 5.022949 5.060143 5.088135 5.111997 6.193024 5.950527 
##      545      546      547      548      549      550      551      552 
## 6.037366 6.064248 5.953508 5.981139 6.041439 6.079260 6.112288 6.144466 
##      553      554      555      556      557      558      559      560 
## 6.166395 5.811874 5.588324 5.652950 5.727588 5.730725 5.787681 5.829082 
##      561      562      563      564      570      571      572      573 
## 5.842500 5.849943 5.861953 5.831794 6.241591 6.202374 6.203998 6.209891 
##      574      575      576      577      578      579      580      581 
## 6.213153 6.191514 6.182059 6.203113 6.219132 5.568437 5.268762 5.320380 
##      582      583      584      585      586      587      588      589 
## 5.376087 5.374918 5.424848 5.460677 5.495012 5.527277 5.534871 5.549014 
##      590      591      592      593      594      595      596      597 
## 5.760363 5.370136 5.513006 5.577788 5.636123 5.695175 5.728581 5.926218 
##      598      599      600      601      602      603      604      605 
## 5.802461 5.874730 5.693417 6.106733 5.721363 6.069755 5.934466 6.011110 
##      606      607      608      609      610      611      612      613 
## 5.992104 5.888960 5.933985 5.972540 5.998304 6.018955 6.046761 6.275547 
##      614      615      616      617      618      619      620      621 
## 6.349164 6.344610 6.334918 6.318364 6.284009 6.240339 6.238016 6.256783 
##      622      623      624      625      626      627      628      629 
## 5.339212 5.087421 5.116159 5.151906 5.112039 5.193474 5.215059 5.195802 
##      630      631      632      633      634      635      636      637 
## 5.283272 5.307613 5.319539 6.001977 5.708018 5.830130 5.862363 5.845607 
##      638      639      640      641      642      643      644      645 
## 5.864169 5.876604 5.905114 5.930378 5.962789 6.195032 6.116841 6.175605 
##      646      647      648      649      650      651      652      653 
## 6.136247 6.019479 6.094340 6.128290 6.145164 6.168258 6.180092 5.267228 
##      654      655      656      657      658      659      660      661 
## 5.316628 5.271632 5.264849 6.006389 5.998194 5.957515 5.948794 5.969775 
##      662      663      664      665      669      670      671      672 
## 5.955197 5.952439 5.954748 5.978081 5.386249 5.203641 5.217052 5.235484 
##      673      674      675      676      677      678      679      680 
## 5.253685 5.282190 5.297510 5.314816 5.324590 5.362560 6.070169 5.791079 
##      681      682      683      684      685      686      687      688 
## 5.860184 5.857498 5.812327 5.862575 5.929751 5.952833 6.001293 6.026601 
##      689      690      691      692      693      694      695      696 
## 6.058583 5.482874 5.174148 5.209694 5.243001 5.266650 5.301649 5.336400 
##      697      698      699      700      701      702      703      704 
## 5.370320 5.401123 5.428307 5.454874 5.297777 5.333182 5.389505 5.406605 
##      705      706      707      708      709      710      711      712 
## 5.409225 5.387885 5.367348 5.346941 5.329558 5.318069 5.306696 5.776914 
##      713      714      715      716      717      718      719      720 
## 5.479060 5.636525 5.696862 5.748196 5.774542 5.765362 5.771651 5.803867 
##      721      722      723      724      725      726      727      728 
## 5.809299 5.808578 5.187720 4.904997 4.940104 4.958275 4.954833 4.997394 
##      729      730      731      732      733      734      735      736 
## 5.011885 5.047624 5.086010 5.118149 5.149985 5.698714 5.098182 5.193042 
##      737      738      739      740      741      742      743      744 
## 5.257631 5.320607 5.392029 5.456066 5.508572 5.560352 5.608864 5.654608 
##      745      746      747      748      749      750      751      752 
## 5.238292 5.170868 5.201263 4.607588 4.374475 4.428230 4.481044 4.493200 
##      753      754      755      756      757      758      759      760 
## 4.480840 4.514744 4.501732 4.563881 4.578270 4.591208 5.662820 5.576006 
##      761      762      763      764      765      766      767      768 
## 5.597443 5.604751 5.620937 5.616965 5.639419 5.629188 5.638461 5.521235 
##      769      770      771      772      773      774      775      776 
## 5.372546 5.395753 5.407030 5.420741 5.422843 5.448915 5.465469 5.494235 
##      777      778      779      780      781      782      783      784 
## 5.764555 5.656394 5.660936 5.679595 5.702394 5.681277 5.706432 5.718831 
##      785      786      787      788      789      790      791      792 
## 5.743158 5.684108 5.405309 5.447937 5.461131 5.458081 5.507694 5.520972 
##      793      794      795      796      797      798      799      800 
## 5.531465 5.557613 5.603282 5.645033 5.193107 5.101901 5.129610 5.140943 
##      801      802      803      804      805      806      807      808 
## 5.162970 5.194229 6.127485 6.028287 6.061852 6.019956 6.026679 6.041013 
##      809      810      811      812      813      814      815      816 
## 6.032546 6.049984 6.082711 6.109051 4.892208 4.750614 4.799778 4.797126 
##      817      818      819      820      821      822      823      824 
## 4.802565 4.798960 4.803477 4.813344 4.829585 4.847995 4.867120 5.637907 
##      825      826      827      828      829      830      831      832 
## 5.579843 5.578298 5.708784 5.766974 5.797515 5.762509 5.731790 5.698702 
##      833      834      835      836      837      838      839      840 
## 5.668771 5.642636 6.168543 6.163974 6.181191 6.171664 6.159074 6.131571 
##      841      842      843      844      845      846      847      848 
## 6.127210 6.137810 6.154282 5.629638 5.462913 5.498474 5.522399 5.538974 
##      849      850      851      852      853      854      855      856 
## 5.534989 5.555776 5.581606 5.608932 5.028652 4.671936 4.716141 4.749973 
##      857      858      859      860      861      862      863      864 
## 4.781681 4.820230 4.857107 4.886683 4.917333 4.952014 4.991807 5.482539 
##      865      866      867      868      869      870      871      872 
## 5.442451 5.459773 5.436980 5.457484 5.469855 5.482919 5.482841 6.084254 
##      873      874      875      876      877      878      879      880 
## 6.232342 6.292929 6.253895 6.211125 6.141156 6.088915 6.069844 6.080256 
##      881      882      883      884      885      886      887      888 
## 6.082983 4.473467 4.150662 4.190475 4.230750 4.242052 4.272207 4.308445 
##      889      890      891      892      893      894      895      896 
## 4.345298 4.381504 4.413028 4.439952 5.522767 5.169223 5.222127 5.234956 
##      897      898      899      900      901      902      903      904 
## 5.340057 5.412239 5.479675 5.521960 5.526087 4.882511 4.611721 4.653423 
##      905      906      907      908      909      910      911      912 
## 4.696666 4.834731 4.975583 4.814504 4.843992 4.869464 4.899468 4.935672 
##      913      914      915      916      917      918      919      920 
## 4.962458 4.981611 5.007115 4.819995 4.720191 4.748536 4.763604 4.730188 
##      921      922      923      924      925      926      927      928 
## 4.742762 4.756626 4.773086 4.780361 4.789847 4.805146 5.884495 5.758839 
##      929      930      931      932      933      934      935      936 
## 5.836455 5.829972 5.872134 5.805330 5.794419 5.818525 5.799728 4.680615 
##      937      938      939      940      941      942      943      944 
## 4.430490 4.469771 4.504821 4.549359 4.618991 4.651031 4.665120 4.676613 
##      945      946      947      948      949      950      951      952 
## 4.675528 4.336719 4.122212 4.139302 4.175922 4.201423 4.228544 4.245210 
##      953      954      955      956      957      958      959      960 
## 4.271154 4.292231 4.326486 4.342069 4.872613 4.782376 4.750487 4.662447 
##      961      962      963      964      965      966      967      968 
## 4.782077 4.777713 4.811454 4.889859 4.835250 4.805156 4.870152 5.522463 
##      969      970      971      972      973      974      975      976 
## 5.329376 5.391938 5.422654 5.443337 5.455026 5.463775 5.478363 5.496809 
##      977      978      979      980      981      982      983      984 
## 4.609713 4.245277 4.286904 4.321882 4.350229 4.382155 4.420090 4.458271 
##      985      986      987      988      989      990      991      992 
## 4.492869 4.527949 4.566735 3.949681 3.769850 3.806502 3.827245 3.854690 
##      993      994      995      996      997      998      999     1000 
## 3.882762 4.093311 4.109726 3.922197 5.787996 5.576700 5.581661 5.606472 
##     1001     1002     1003     1004     1005     1006     1007     1008 
## 5.637555 5.710223 5.739940 5.720923 5.732557 5.399129 5.271484 4.615828 
##     1009     1010     1011     1012     1013     1014     1015     1016 
## 4.496252 4.511490 4.516581 4.512375 4.517084 4.526951 4.539874 4.559020 
##     1017     1018     1019     1020     1021     1022     1023     1024 
## 4.581696 4.602911 4.072013 3.873367 3.928651 3.981975 4.036485 5.580894 
##     1025     1026     1027     1028     1029     1030     1031     1032 
## 5.516269 5.547204 5.562746 5.543065 5.556403 5.570680 5.576566 5.584090 
##     1033     1034     1035     1036     1037     1038     1039     1040 
## 5.587089 5.586368 5.504163 5.155005 5.198515 5.236364 5.257378 5.310055 
##     1041     1042     1043     1044     1045     1046     1047     1048 
## 5.365668 5.426594 5.445584 5.474837 5.060756 4.631865 4.690029 4.707449 
##     1049     1050     1051     1052     1053     1054     1055     1056 
## 4.757310 4.819646 4.857606 4.887671 4.924560 4.968781 5.018288 4.957661 
##     1057     1058     1059     1060     1061     1062     1063     1064 
## 4.775213 4.828555 4.878772 4.922106 5.451747 5.262631 5.336458 5.374657 
##     1065     1066     1067     1068     1069     1070     1071     1072 
## 5.394830 5.417425 5.414888 5.414782 5.414161 5.419105 5.435140 5.279930 
##     1073     1074     1075     1076     1077     1078     1079     1080 
## 5.062519 5.164527 5.220350 5.112162 5.131211 5.165740 5.215699 5.236815 
##     1081     1082     1083     1084     1085     1086     1087     1088 
## 5.259806 5.280446 4.516249 4.338712 4.367462 4.348765 4.352551 4.392197 
##     1089     1090     1091     1092     1093     1094     1095     1096 
## 4.416070 4.429198 4.451788 4.470952 4.492929 5.231043 5.246369 5.307221 
##     1097     1098     1099     1100     1101     1102     1103     1104 
## 5.328113 5.212551 5.246029 5.288186 5.291789 5.293280 5.284737 5.211121 
##     1105     1106     1107     1108     1109     1110     1111     1112 
## 4.744924 4.437542 4.449683 4.495342 4.511419 4.549193 4.628499 4.676601 
##     1113     1114     1115     1116     1117     1118     1119     1120 
## 4.711497 4.723341 4.734404 3.558496 3.385059 3.435863 3.461896 3.497582 
##     1121     1122     1123     1124     1125     1126     1127     1128 
## 3.540096 3.565230 5.372369 4.975220 5.071346 5.097837 5.079881 5.134629 
##     1129     1130     1131     1132     1133     1134     1135     1136 
## 5.196073 5.251400 5.285686 5.328917 5.351962 4.950044 4.872527 4.944807 
##     1137     1138     1139     1140     1141     1142     1143     1144 
## 4.952907 4.959343 4.989558 4.990206 4.362679 4.270844 4.286547 4.293016 
##     1145     1146     1147     1148     1149     1150     1151     1152 
## 4.289980 4.299073 4.290250 4.300154 4.303128 4.310722 4.335492 5.855737 
##     1153     1154     1155     1156     1157     1158     1159     1160 
## 5.701917 5.742845 5.761679 5.766207 5.776730 5.790743 5.821849 4.664207 
##     1161     1162     1163     1164     1165     1166     1167     1168 
## 4.638070 4.625086 4.596114 4.609182 4.621389 4.641057 4.662801 4.681273 
##     1169     1170     1171     1172     1173     1174     1175     1176 
## 4.670275 4.187702 4.059973 4.020818 3.863927 3.934482 4.007751 4.098679 
##     1177     1178     1179     1180     1181     1182     1183     1184 
## 4.184433 4.207236 4.205455 4.200482 3.779119 3.602422 3.648038 3.716610 
##     1185     1186     1187     1188     1189     1190     1191     1192 
## 3.756445 3.748334 3.764155 3.783601 3.782467 4.782269 4.613921 4.620090 
##     1193     1194     1195     1196     1197     1198     1199     1200 
## 4.676441 4.765920 5.811143 5.771900 5.784224 5.799826 5.807679 5.814682 
##     1201     1202     1203     1204     1205     1206     1207     1208 
## 4.222957 4.148584 4.159235 4.168983 4.184678 4.185755 4.157614 4.152988 
##     1209     1210     1211     1212     1213     1214     1215     1216 
## 4.181968 4.203173 4.092885 4.055218 4.062907 4.021289 4.050472 4.061108 
##     1217     1218     1219     1220     1221     1222     1223     1224 
## 4.081669 4.092294 4.091563 5.764090 5.585484 5.665381 5.641606 5.671871 
##     1225     1226     1227     1228     1229     1230     1231     1232 
## 5.690611 5.756555 5.772885 5.746404 3.980777 3.977439 3.975685 3.976792 
##     1233     1234     1235     1236     1237     1238     1239     1240 
## 4.632956 4.456065 4.504316 4.548016 4.592127 4.641607 4.286855 4.347962 
##     1241     1242     1243     1244     1245     1246     1247     1248 
## 4.385050 4.374566 4.406126 4.445026 4.485305 4.525738 4.564778 4.603337 
##     1249     1250     1251     1252     1253     1254     1255     1256 
## 5.080152 5.037952 5.048998 5.071905 3.655216 3.533244 3.528595 3.568723 
##     1257     1258     1259     1260     1261     1262     1263     1264 
## 3.535425 3.566907 3.555300 3.609949 3.619530 3.644882 3.647928 4.054078 
##     1265     1266     1267     1268     1269     1270     1271     1272 
## 4.209584 4.186023 4.187208 4.131964 4.131056 4.129107 4.135573 4.205477 
##     1273     1274     1275     1276     1277     1278     1279     1280 
## 4.181444 4.219861 4.236386 4.261673 4.258253 4.087550 3.917468 3.935939 
##     1281     1282     1283     1284     1285     1286     1287     1288 
## 3.965738 3.981376 4.006662 4.030823 4.050485 4.059938 4.066475 4.107504 
##     1289     1290     1291     1292     1293     1294     1295     1296 
## 3.918885 3.953161 3.989533 4.012840 4.028092 4.069356 4.072080 4.073174 
##     1297     1298     1299     1300     1301     1302     1303     1304 
## 4.085266 4.098150 4.009896 4.782955 4.797087 4.832017 4.711086 4.708776 
##     1305     1306     1307     1308     1309     1310     1311     1312 
## 4.724143 4.703553 4.340259 3.967319 3.978190 4.031586 3.951680 3.953527 
##     1313     1314     1315     1316     1317     1318     1319     1320 
## 3.949944 3.954106 3.956885 4.423758 4.174949 4.212113 4.228893 4.244304 
##     1321     1322     1323     1324     1325     1326     1327     1328 
## 4.266635 4.299798 4.313819 4.342763 4.369708 4.396663 3.509433 3.407535 
##     1329     1330     1331     1332     1333     1334     1335     1336 
## 3.427720 3.454357 3.558179 3.540001 4.193527 4.079937 4.106215 4.118258 
##     1337     1338     1339     1340     1341     1342     1343     1344 
## 4.128174 4.138193 4.151551 3.799227 3.892967 3.917640 3.988376 4.030907 
##     1345     1346     1347     1348     1349     1350     1351     1352 
## 4.045933 4.081902 4.126593 4.237324 4.135928 4.172369 4.164144 4.178296 
##     1353     1354     1355     1356     1357     1358     1359     1360 
## 4.209112 4.234164 4.228978 4.156690 3.913033 4.035548 4.074758 4.095826 
##     1361     1362     1363     1364     1365     1366     1367     1368 
## 4.171596 4.175390 4.171470 4.159288 3.962964 3.852058 3.845113 3.875330 
##     1369     1370     1372     1373     1374     1375     1376     1377 
## 3.922799 3.942679 4.942962 4.945030 5.002227 5.002600 4.882319 4.757920 
##     1378     1379     1380     1381     1382     1383     1384     1385 
## 3.556751 3.515106 3.515811 3.526904 3.604956 3.625505 3.645009 3.391550 
##     1386     1387     1388     1389     1390     1391     1392     1393 
## 5.773945 4.401441 4.425443 4.438299 4.457947 4.958128 6.519399 6.570692 
##     1394     1395     1396     1397     1398     1399     1400     1401 
## 6.550618 6.593762 6.623667 6.627986 6.662677 6.685155 4.399357 4.466388 
##     1402     1403     1404     1405     1406     1407     1412     1413 
## 3.546288 3.577693 3.605343 3.685078 3.802321 6.495152 5.196976 6.400906 
##     1414     1415     1416     1417     1418     1419 
## 6.394645 6.456098 6.466165 6.474026 6.499538 6.533034</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="R_analysis.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lm_model1, <span class="fu">aes</span>(<span class="at">x =</span> lm_model1<span class="sc">$</span>fitted.values, <span class="at">y =</span> lm_model1<span class="sc">$</span>residuals)) <span class="sc">+</span></span>
<span id="cb288-2"><a href="R_analysis.html#cb288-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb288-3"><a href="R_analysis.html#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-83-1.png" width="672" />
Вспомним примеры диагностических графиков, которые мы разбирали в прошлом семестре Примеры диагностических графиков для остатков: <a href="https://gallery.shinyapps.io/slr_diag/" class="uri">https://gallery.shinyapps.io/slr_diag/</a> Хорошим счтается график, если при движении слева на право все точки распределены примерно равномерно. А вот есть у нас вылез веник, что с одной стороны данные скукожились в одну точку, а дальше пошли расходиться веником – это означает, что в данных наблюдается <em>гетероскедастичность</em>, они не однородны, и результаты такой модели будут не очень достоверны. В нашем случае графико выглядит хорошо и проходит проверку.</p>
<p>А теперь давайте возьмем антипример и посмотрим, что будет с распределением остатков.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="R_analysis.html#cb289-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb289-2"><a href="R_analysis.html#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(Life_Ladder <span class="sc">~</span> Perceptions_of_corruption, .) <span class="ot">-&gt;</span> lm_model2_anti</span>
<span id="cb289-3"><a href="R_analysis.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model2_anti, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>Тут что-то пошло не так, поэтому опираться на такую модель мы бы не стали.</p>
<p>Следующее допущение – остатки должны быть нормально распределены. Да, мы не проверяем на нормальность распределения ЗП, но вот остатки нужно проверить – иначе мы не сможем провести линия с расчетом метода нименьших квадратов, то есть пытаясь приблизиться ко всем нашим точкам сразу. Проверим это допущения, выведя второй график стандартной функции plot()</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="R_analysis.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model1, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-85-1.png" width="672" />
Или, как мы уже строили красивые графики для проверки нормальнсти через ggplot</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="R_analysis.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lm_model1, <span class="fu">aes</span>(<span class="at">x =</span> lm_model1<span class="sc">$</span>residuals)) <span class="sc">+</span></span>
<span id="cb291-2"><a href="R_analysis.html#cb291-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb291-3"><a href="R_analysis.html#cb291-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="R_analysis.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lm_model1, <span class="fu">aes</span>(<span class="at">sample =</span> lm_model1<span class="sc">$</span>residuals)) <span class="sc">+</span></span>
<span id="cb292-2"><a href="R_analysis.html#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-3"><a href="R_analysis.html#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb292-4"><a href="R_analysis.html#cb292-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-86-2.png" width="672" /></p>
<p>И так, мы соблюли все допущения для модели с одним предиктором! У нас осталось только допущения отсутствия мультиколлинеарности, но оно не применимо на модели с одним предиктором.</p>
<p>Теперь давайте еще раз посмотрим на результаты модели и вспомним, <a href="stats_criteria_linear.html#linreg_example">как их интерпретировать</a>. Ключевое, что нас интересует – это <a href="stats_criteria_linear.html#linreg_coef">коэффициенты линейной регрессии</a>, <span class="math inline">\(b_0\)</span>, интерцепт, место пересечения регрессионной прямой с осью y, и <span class="math inline">\(b_1\)</span>, слоуп, угол наклона прямой – так как <a href="stats_criteria_linear.html#linreg_null">нулевая гипотеза для линейной регрессии</a> заключается в равенстве их нулю. Еще одна не менее важная штука – <span class="math inline">\(R^2\)</span>, <a href="stats_criteria_linear.html#rsquared">коэффициент детерминации и процент объясненной дисперсии</a>.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="R_analysis.html#cb293-1" aria-hidden="true" tabindex="-1"></a>lm_model1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Life_Ladder ~ Log_GDP_per_capita, data = .)
## 
## Coefficients:
##        (Intercept)  Log_GDP_per_capita  
##            -1.4066              0.7421</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="R_analysis.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Life_Ladder ~ Log_GDP_per_capita, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.26515 -0.47805 -0.04913  0.54993  2.01866 
## 
## Coefficients:
##                    Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)         -1.4066     0.1467  -9.587 &lt;0.0000000000000002 ***
## Log_GDP_per_capita   0.7421     0.0158  46.973 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7016 on 1404 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.6111, Adjusted R-squared:  0.6109 
## F-statistic:  2206 on 1 and 1404 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>Как обычно, смотрим на p-value у каждого коэффициента (и еще можем посмотреть на p-value всей модели: тут та же итория, как и с ANOVA – вся модель значима, когда значим хотя бы один из коэффициентов, и не значима, когда все коэффициенты не отличаются статистически значимо от нуля). Если коэффициент значим, значит, мы можем сказать, что он значимо вкладывается в объяснение дисперсии. <span class="math inline">\(b_0\)</span>, интерцепт, значимо отличен от нуля, поэтому можем заявить, что наша прямая будет начинаться не в начале координат, а смещена на -1.4 по оси y. <span class="math inline">\(b_1\)</span> у Log_GDP_per_capita значимо отличен от нуля, пэтому наша прямая будет иметь наклон – а это значит, что с увеличением Log_GDP_per_capita на 1 зависимая переменная Life_Ladder будет увеличиваться на 0.74!</p>
<p>Чему равен <span class="math inline">\(R^2\)</span>? Он равен 0.61, что очень хороший результат. То есть, 61% изменчивости наших данных по уровню стастья Life_Ladder определяются уровнем покупапательской способнсти Log_GDP_per_capita!</p>
<p>Уравнение регрессионной прямой я теперь могу записать так:</p>
<p align="center">
<span class="math inline">\(\hat Life\_Ladder = -1.4 + 0.74 \times Log\_GDP\_per\_capita\)</span>
</p>
<p>Давайте теперь визуалзируем нашу регрессионную прямую</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="R_analysis.html#cb297-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span> </span>
<span id="cb297-2"><a href="R_analysis.html#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Log_GDP_per_capita, <span class="at">y =</span> Life_Ladder)) <span class="sc">+</span></span>
<span id="cb297-3"><a href="R_analysis.html#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#355C7D&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb297-4"><a href="R_analysis.html#cb297-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&quot;violet&quot;</span>) <span class="sc">+</span></span>
<span id="cb297-5"><a href="R_analysis.html#cb297-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 15 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 15 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>Красота!</p>
</div>
<div id="линейная-регрессия-с-несколькими-предикторами-факторами" class="section level3 hasAnchor" number="13.15.2">
<h3><span class="header-section-number">13.15.2</span> Линейная регрессия с несколькими предикторами (факторами)<a href="R_analysis.html#линейная-регрессия-с-несколькими-предикторами-факторами" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Все то же самое, но теперь возьмем в модель второй предиктор – Freedom_to_make_life_choices.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="R_analysis.html#cb300-1" aria-hidden="true" tabindex="-1"></a>whr_tests_hw <span class="sc">%&gt;%</span></span>
<span id="cb300-2"><a href="R_analysis.html#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(Life_Ladder <span class="sc">~</span> Log_GDP_per_capita <span class="sc">+</span> Freedom_to_make_life_choices, .) <span class="ot">-&gt;</span> lm_model3_multy</span>
<span id="cb300-3"><a href="R_analysis.html#cb300-3" aria-hidden="true" tabindex="-1"></a>lm_model3_multy</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Life_Ladder ~ Log_GDP_per_capita + Freedom_to_make_life_choices, 
##     data = .)
## 
## Coefficients:
##                  (Intercept)            Log_GDP_per_capita  
##                      -2.0948                        0.6478  
## Freedom_to_make_life_choices  
##                       2.1544</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="R_analysis.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model3_multy)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Life_Ladder ~ Log_GDP_per_capita + Freedom_to_make_life_choices, 
##     data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.50100 -0.43131  0.02093  0.44158  1.83176 
## 
## Coefficients:
##                              Estimate Std. Error t value            Pr(&gt;|t|)
## (Intercept)                  -2.09478    0.14063  -14.90 &lt;0.0000000000000002
## Log_GDP_per_capita            0.64781    0.01562   41.46 &lt;0.0000000000000002
## Freedom_to_make_life_choices  2.15438    0.12663   17.01 &lt;0.0000000000000002
##                                 
## (Intercept)                  ***
## Log_GDP_per_capita           ***
## Freedom_to_make_life_choices ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6403 on 1375 degrees of freedom
##   (43 observations deleted due to missingness)
## Multiple R-squared:  0.6791, Adjusted R-squared:  0.6787 
## F-statistic:  1455 on 2 and 1375 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>Проверка допущений</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="R_analysis.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model3_multy, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="R_analysis.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model3_multy, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-90-2.png" width="672" /></p>
<p>Теперь нужно проверить еще допущение об отсутствии мультиколлинеарности – что среди предикторов (НП) нет сильной корреляции друг с другом, иначе наша модель будет немного бессмысленна. Проверять будем с помощью функции vif(), коэффициента вздутия дисперсии. Показатели довольно условные, но считается, если значения больше 5 – то это очень сильная корреляция между переменными, и нужно удалить сильно коррелирующую переменную.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="R_analysis.html#cb306-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(lm_model3_multy)</span></code></pre></div>
<pre><code>##           Log_GDP_per_capita Freedom_to_make_life_choices 
##                     1.153419                     1.153419</code></pre>
<p>У нас показания vif довольно низкие, поэтому ничего не будем менять.</p>
<p>Далее можем проинтерпретировать результаты (все коэффициенты значимы) и записать уравнение регрессионной прямой.</p>
<p align="center">
<span class="math inline">\(\hat Life\_Ladder = -2.09 + 0.64 \times Log\_GDP\_per\_capita + 2.15 \times Freedom\_to\_make\_life\_choices\)</span>
</p>
</div>
</div>
<div id="tasks_sem7" class="section level2 hasAnchor" number="13.16">
<h2><span class="header-section-number">13.16</span> Задания после семинара 7<a href="R_analysis.html#tasks_sem7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Отберите переменные, подходящие для построения линейной регрессии, в данных <code>whr_tests_hw.csv</code></li>
<li>Постройте линейную регрессию на этих переменных, с одним фактором (НП)</li>
<li>Постройте линейную регрессию на этих переменных, но уже хотя бы с двумя факторами (НП)</li>
<li>Постройте диагностические графики для каждой модели: насколько равной получилась дисперсия остатков для этих моделей? Можно ли доверять результатом этих моделей?</li>
<li>Определеите, какая модель лучше объясняет данные (то есть вариативность ЗП)?</li>
<li>Запишите уравнение линейной регрессии для обеих моделей.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stats_criteria_categ.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StatsForDA.pdf", "StatsForDA.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
