<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Статистические критерии | Статистика для анализа данных</title>
  <meta name="description" content="Семинарские занятия по статистике для анализа данных" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Статистические критерии | Статистика для анализа данных" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Семинарские занятия по статистике для анализа данных" />
  <meta name="github-repo" content="elenary/StatsForDA" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Статистические критерии | Статистика для анализа данных" />
  
  <meta name="twitter:description" content="Семинарские занятия по статистике для анализа данных" />
  

<meta name="author" content="Елена Рыбина" />


<meta name="date" content="2022-11-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inference.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Статистика для анализа данных</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Статистика и ее место в жизни</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#вероятности-формулировки-и-выводы"><i class="fa fa-check"></i><b>1.1</b> Вероятности, формулировки и выводы</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#определение-статистики"><i class="fa fa-check"></i><b>1.2</b> Определение статистики</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#применение-статистики"><i class="fa fa-check"></i><b>1.2.1</b> Применение статистики</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#виды-статистики"><i class="fa fa-check"></i><b>1.3</b> Виды статистики</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sample.html"><a href="sample.html"><i class="fa fa-check"></i><b>2</b> Выборка</a><ul>
<li class="chapter" data-level="2.1" data-path="sample.html"><a href="sample.html#выборочные-оценки"><i class="fa fa-check"></i><b>2.1</b> Выборочные оценки</a></li>
<li class="chapter" data-level="2.2" data-path="sample.html"><a href="sample.html#репрезентативность-выборки"><i class="fa fa-check"></i><b>2.2</b> Репрезентативность выборки</a></li>
<li class="chapter" data-level="2.3" data-path="sample.html"><a href="sample.html#dependent_samples"><i class="fa fa-check"></i><b>2.3</b> Зависимые и независимые выборки</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scales.html"><a href="scales.html"><i class="fa fa-check"></i><b>3</b> Данные и типы шкал</a><ul>
<li class="chapter" data-level="3.1" data-path="scales.html"><a href="scales.html#измерение-и-переменная"><i class="fa fa-check"></i><b>3.1</b> Измерение и переменная</a></li>
<li class="chapter" data-level="3.2" data-path="scales.html"><a href="scales.html#количественные-и-неколичественные-данные"><i class="fa fa-check"></i><b>3.2</b> Количественные и неколичественные данные</a></li>
<li class="chapter" data-level="3.3" data-path="scales.html"><a href="scales.html#типы-шкал"><i class="fa fa-check"></i><b>3.3</b> Типы шкал</a></li>
<li class="chapter" data-level="3.4" data-path="scales.html"><a href="scales.html#непрерывные-и-дискретные-данные"><i class="fa fa-check"></i><b>3.4</b> Непрерывные и дискретные данные</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Вероятность и случайные величины</a><ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#random-variable"><i class="fa fa-check"></i><b>4.1</b> Случайная величина</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#вероятность"><i class="fa fa-check"></i><b>4.2</b> Вероятность</a></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#дискретные-св-и-статистическое-определение-вероятности"><i class="fa fa-check"></i><b>4.3</b> Дискретные СВ и статистическое определение вероятности</a></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#столбчатая-диаграмма"><i class="fa fa-check"></i><b>4.4</b> Столбчатая диаграмма</a></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#непрерывные-св-и-геометрическое-определение-вероятности"><i class="fa fa-check"></i><b>4.5</b> Непрерывные СВ и геометрическое определение вероятности</a></li>
<li class="chapter" data-level="4.6" data-path="probability.html"><a href="probability.html#график-плотности-вероятности-и-гистограмма"><i class="fa fa-check"></i><b>4.6</b> График плотности вероятности и гистограмма</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>5</b> Распределения</a><ul>
<li class="chapter" data-level="5.1" data-path="distributions.html"><a href="distributions.html#виды-распределений"><i class="fa fa-check"></i><b>5.1</b> Виды распределений</a></li>
<li class="chapter" data-level="5.2" data-path="distributions.html"><a href="distributions.html#функции-распределения"><i class="fa fa-check"></i><b>5.2</b> Функции распределения</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>6</b> Описательная статистика</a><ul>
<li class="chapter" data-level="6.1" data-path="descriptives.html"><a href="descriptives.html#descriptive_vis"><i class="fa fa-check"></i><b>6.1</b> Описательные визуализации</a></li>
<li class="chapter" data-level="6.2" data-path="descriptives.html"><a href="descriptives.html#ctm"><i class="fa fa-check"></i><b>6.2</b> Меры центральной тенденции</a><ul>
<li class="chapter" data-level="6.2.1" data-path="descriptives.html"><a href="descriptives.html#среднее-медиана-мода"><i class="fa fa-check"></i><b>6.2.1</b> Среднее, медиана, мода</a></li>
<li class="chapter" data-level="6.2.2" data-path="descriptives.html"><a href="descriptives.html#особенности-использования"><i class="fa fa-check"></i><b>6.2.2</b> Особенности использования</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="descriptives.html"><a href="descriptives.html#квантили-квартили-и-перцентили"><i class="fa fa-check"></i><b>6.3</b> Квантили, квартили и перцентили</a></li>
<li class="chapter" data-level="6.4" data-path="descriptives.html"><a href="descriptives.html#varm"><i class="fa fa-check"></i><b>6.4</b> Меры вариативности</a><ul>
<li class="chapter" data-level="6.4.1" data-path="descriptives.html"><a href="descriptives.html#размах-стандартное-отклонение-и-дисперсия"><i class="fa fa-check"></i><b>6.4.1</b> Размах, стандартное отклонение и дисперсия</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="descriptives.html"><a href="descriptives.html#боксплот-и-вайолинплот"><i class="fa fa-check"></i><b>6.5</b> Боксплот и вайолинплот</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="normdist.html"><a href="normdist.html"><i class="fa fa-check"></i><b>7</b> Нормальное распределение и оценки</a><ul>
<li class="chapter" data-level="7.1" data-path="normdist.html"><a href="normdist.html#ctt"><i class="fa fa-check"></i><b>7.1</b> Центральная предельная теорема</a></li>
<li class="chapter" data-level="7.2" data-path="normdist.html"><a href="normdist.html#standart_error"><i class="fa fa-check"></i><b>7.2</b> Стандартная ошибка среднего</a></li>
<li class="chapter" data-level="7.3" data-path="normdist.html"><a href="normdist.html#нормальное-распределение-и-его-свойства"><i class="fa fa-check"></i><b>7.3</b> Нормальное распределение и его свойства</a></li>
<li class="chapter" data-level="7.4" data-path="normdist.html"><a href="normdist.html#стандартное-нормальное-распределение"><i class="fa fa-check"></i><b>7.4</b> Стандартное нормальное распределение</a></li>
<li class="chapter" data-level="7.5" data-path="normdist.html"><a href="normdist.html#z-преобразование-и-стандартизация"><i class="fa fa-check"></i><b>7.5</b> Z-преобразование и стандартизация</a></li>
<li class="chapter" data-level="7.6" data-path="normdist.html"><a href="normdist.html#доверительный-интервал"><i class="fa fa-check"></i><b>7.6</b> Доверительный интервал</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>8</b> Статистический вывод</a><ul>
<li class="chapter" data-level="8.1" data-path="inference.html"><a href="inference.html#идея-статистического-вывода"><i class="fa fa-check"></i><b>8.1</b> Идея статистического вывода</a></li>
<li class="chapter" data-level="8.2" data-path="inference.html"><a href="inference.html#nhst"><i class="fa fa-check"></i><b>8.2</b> NHST: алгоритм проверки гипотезы и анализа данных</a></li>
<li class="chapter" data-level="8.3" data-path="inference.html"><a href="inference.html#эмпирические-гипотезы-и-переменные"><i class="fa fa-check"></i><b>8.3</b> Эмпирические гипотезы и переменные</a><ul>
<li class="chapter" data-level="8.3.1" data-path="inference.html"><a href="inference.html#variables"><i class="fa fa-check"></i><b>8.3.1</b> Зависимые и независимые переменные</a></li>
<li class="chapter" data-level="8.3.2" data-path="inference.html"><a href="inference.html#уровни-нп-в-категориальных-переменных"><i class="fa fa-check"></i><b>8.3.2</b> Уровни НП в категориальных переменных</a></li>
<li class="chapter" data-level="8.3.3" data-path="inference.html"><a href="inference.html#связь-между-зп-и-нп"><i class="fa fa-check"></i><b>8.3.3</b> Связь между ЗП и НП</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="inference.html"><a href="inference.html#нулевая-и-альтернативные-статистические-гипотезы"><i class="fa fa-check"></i><b>8.4</b> Нулевая и альтернативные статистические гипотезы</a><ul>
<li class="chapter" data-level="8.4.1" data-path="inference.html"><a href="inference.html#направленные-и-ненаправленные-гипотезы"><i class="fa fa-check"></i><b>8.4.1</b> Направленные и ненаправленные гипотезы</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="inference.html"><a href="inference.html#уровень-значимости-и-статистическая-мощность"><i class="fa fa-check"></i><b>8.5</b> Уровень значимости и статистическая мощность</a></li>
<li class="chapter" data-level="8.6" data-path="inference.html"><a href="inference.html#выбор-статистического-критерия"><i class="fa fa-check"></i><b>8.6</b> Выбор статистического критерия</a></li>
<li class="chapter" data-level="8.7" data-path="inference.html"><a href="inference.html#sample_size"><i class="fa fa-check"></i><b>8.7</b> Размер выборки</a></li>
<li class="chapter" data-level="8.8" data-path="inference.html"><a href="inference.html#stat_test_example"><i class="fa fa-check"></i><b>8.8</b> Расчет статического критерия и проверка значимости</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="stats_criteria.html"><a href="stats_criteria.html"><i class="fa fa-check"></i><b>9</b> Статистические критерии</a><ul>
<li class="chapter" data-level="9.1" data-path="stats_criteria.html"><a href="stats_criteria.html#степени-свободы"><i class="fa fa-check"></i><b>9.1</b> Степени свободы</a></li>
<li class="chapter" data-level="9.2" data-path="stats_criteria.html"><a href="stats_criteria.html#ключевые-распределения-и-статистики-критериев-z-t-f"><i class="fa fa-check"></i><b>9.2</b> Ключевые распределения и статистики критериев (Z, T, F)</a></li>
<li class="chapter" data-level="9.3" data-path="stats_criteria.html"><a href="stats_criteria.html#выбор-статистического-критерия-1"><i class="fa fa-check"></i><b>9.3</b> Выбор статистического критерия</a><ul>
<li class="chapter" data-level="9.3.1" data-path="stats_criteria.html"><a href="stats_criteria.html#param_nonparam"><i class="fa fa-check"></i><b>9.3.1</b> Параметрические и непараметрические критерии</a></li>
<li class="chapter" data-level="9.3.2" data-path="stats_criteria.html"><a href="stats_criteria.html#зависимые-и-независимые-выборки"><i class="fa fa-check"></i><b>9.3.2</b> Зависимые и независимые выборки</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="stats_criteria.html"><a href="stats_criteria.html#ttest"><i class="fa fa-check"></i><b>9.4</b> T-тест (сравнение средних двух групп)</a><ul>
<li class="chapter" data-level="9.4.1" data-path="stats_criteria.html"><a href="stats_criteria.html#допущения-для-т-теста"><i class="fa fa-check"></i><b>9.4.1</b> Допущения для т-теста</a></li>
<li class="chapter" data-level="9.4.2" data-path="stats_criteria.html"><a href="stats_criteria.html#непараметрические-аналоги"><i class="fa fa-check"></i><b>9.4.2</b> Непараметрические аналоги</a></li>
<li class="chapter" data-level="9.4.3" data-path="stats_criteria.html"><a href="stats_criteria.html#независимые-и-парные-тесты"><i class="fa fa-check"></i><b>9.4.3</b> Независимые и парные тесты</a></li>
<li class="chapter" data-level="9.4.4" data-path="stats_criteria.html"><a href="stats_criteria.html#вычисление-т-теста-и-непараметрических-аналогов"><i class="fa fa-check"></i><b>9.4.4</b> Вычисление т-теста и непараметрических аналогов</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="stats_criteria.html"><a href="stats_criteria.html#anova-дисперсионный-анализ"><i class="fa fa-check"></i><b>9.5</b> ANOVA (дисперсионный анализ)</a><ul>
<li class="chapter" data-level="9.5.1" data-path="stats_criteria.html"><a href="stats_criteria.html#levels"><i class="fa fa-check"></i><b>9.5.1</b> Факторы и уровни</a></li>
<li class="chapter" data-level="9.5.2" data-path="stats_criteria.html"><a href="stats_criteria.html#почему-он-дисперсионный"><i class="fa fa-check"></i><b>9.5.2</b> Почему он дисперсионный</a></li>
<li class="chapter" data-level="9.5.3" data-path="stats_criteria.html"><a href="stats_criteria.html#f-распределение-фишера"><i class="fa fa-check"></i><b>9.5.3</b> F-распределение (Фишера)</a></li>
<li class="chapter" data-level="9.5.4" data-path="stats_criteria.html"><a href="stats_criteria.html#допущения-для-anova"><i class="fa fa-check"></i><b>9.5.4</b> Допущения для ANOVA</a></li>
<li class="chapter" data-level="9.5.5" data-path="stats_criteria.html"><a href="stats_criteria.html#непараметрические-аналоги-1"><i class="fa fa-check"></i><b>9.5.5</b> Непараметрические аналоги</a></li>
<li class="chapter" data-level="9.5.6" data-path="stats_criteria.html"><a href="stats_criteria.html#просто-anova-и-с-повторными-измерениями"><i class="fa fa-check"></i><b>9.5.6</b> Просто ANOVA и с повторными измерениями</a></li>
<li class="chapter" data-level="9.5.7" data-path="stats_criteria.html"><a href="stats_criteria.html#нелинейные-эффекты"><i class="fa fa-check"></i><b>9.5.7</b> Нелинейные эффекты</a></li>
<li class="chapter" data-level="9.5.8" data-path="stats_criteria.html"><a href="stats_criteria.html#multiple_anova"><i class="fa fa-check"></i><b>9.5.8</b> Многофкторый ANOVA и взаимодействие факторов</a></li>
<li class="chapter" data-level="9.5.9" data-path="stats_criteria.html"><a href="stats_criteria.html#пост-хоки-и-множественные-сравнения"><i class="fa fa-check"></i><b>9.5.9</b> Пост-хоки и множественные сравнения</a></li>
<li class="chapter" data-level="9.5.10" data-path="stats_criteria.html"><a href="stats_criteria.html#вычисление-anova-и-непараметрических-аналогов"><i class="fa fa-check"></i><b>9.5.10</b> Вычисление ANOVA и непараметрических аналогов</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Статистика для анализа данных</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stats_criteria" class="section level1 hasAnchor">
<h1><span class="header-section-number">9</span> Статистические критерии<a href="stats_criteria.html#stats_criteria" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Статистическим критерием называется правило, по которому мы будем пытаться отвергнуть нулевую гипотезу. Разным гипотезам и данным подходят разные критерии.</p>
<p>Статистический критерий включает:</p>
<ul>
<li><strong>Теоретическое распределение</strong>, на графике плотности вероятности которого мы будем располагать сравниваемые средние: вид кривой и математическая формула этого вероятностного закона (Т-распределение, F-распределение, <span class="math inline">\(\chi^2\)</span>-распределение и другие)</li>
<li><strong>Формулу</strong>, по которой мы будем рассчитывать искомое <strong>значение критерия</strong> (как уже рассчитывали <span class="math inline">\(Z_{Mмаленькие}\)</span>) исходя из наших данных на выборке для Z-оценки)</li>
<li>Cоответствие каждого посчитанного по этой формуле значения (например, Z-значения или Т-значения) проценту данных, расположенных за этим значением на графике плотности вероятности этого распределения (<em>мы не будем пользоваться такими таблицами соответствий, за нас все считают бесдушные машины</em>)</li>
<li><strong>Формулу для рассчета числа степеней свободы</strong> для этого критерия</li>
</ul>
<div id="степени-свободы" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.1</span> Степени свободы<a href="stats_criteria.html#степени-свободы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Число степененй свободы (Degrees of Freedom, df) – количество направления для изменения признака. Формула для расчета степеней свободы своя для каждого статистического критерия (нам не нужно рассчитывать самостоятельно) и зависит, собственно, от вида статистического критерия, дизайна нашего исследования (сколько сравнений мы проводим) и числа наблюдений в выборке.</p>
<p>Для t-критерия число степеней свободы высчитывается очень просто: <span class="math inline">\(df = n_1 -1 + n_2 - 1 = n_1 + n_2 - 2\)</span></p>
</div>
<div id="ключевые-распределения-и-статистики-критериев-z-t-f" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.2</span> Ключевые распределения и статистики критериев (Z, T, F)<a href="stats_criteria.html#ключевые-распределения-и-статистики-критериев-z-t-f" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Z-распределение</strong></p>
<p>В прошлый раз мы рассмотрели пример, когда сравнивали среднее время, которое проводят родители с детьми, в больших и маленьких городах, и сравнивали эти значения на примере [Z-распределения] {stat_test_example): мы получали Z-статистику и находили соответствующий распределению Z-оценок процент данных для найденной точки.</p>
<p align="center">
<p><img src="docs/images/z-dist_2.png" width="100%" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(Z = \frac{M - \mu}{\frac{\sigma}{\sqrt{n}}} = \frac{M - \mu}{\frac{sd}{\sqrt{n}}}\)</span></p>
</p>
<p>Это самый простой вариант критерия для проверки статистических гипотез – но не единственный. На самом деле, в качестве распределения, на которое мы помещаем точки (средние) и сравниваем их друг с другом, могут быть и другие, в зависимости от характера наших данных. Рассмотрим основные из них.</p>
<p><a href="https://gallery.shinyapps.io/dist_calc/" class="uri">https://gallery.shinyapps.io/dist_calc/</a></p>
<p><strong>T-распределение Стьюдента</strong></p>
<p align="center">
<img src="docs/images/t-dist.png" width="70%" style="display: block; margin: auto;" />
</p>
<p>Как мы видим, оно очень похоже на Z-распределение, но у него чуть более приподнятые хвосты.</p>
<p>Формула, которой задается вероятностный закон Т-распределения Стьюдента:</p>
<p align="center">
<img src="docs/images/t-dist-pdf.png" width="50%" style="display: block; margin: auto;" />
</p>
<p>Негласно считается, что при объеме выборки от n=30 t-распределение считается близким к Z-распределению, которе является нормальным, и можем использовать его. Но в реальности это не совсем так.</p>
<p>Формула для расчета T-значения исходя из наших данных:</p>
<p align="center">
<span class="math inline">\(t = \frac{M_1 - M_2}{\frac{sd_{1;2}}{\sqrt{n_{1;2}}}} = \frac{M_1 - M_2}{\sqrt{\frac{sd_1^2}{n_1} + \frac{sd_2^2}{n_2}}}\)</span>
</p>
<p><strong>F-распределение</strong></p>
<p align="center">
<img src="docs/images/F-dist.png" width="100%" style="display: block; margin: auto;" />
</p>
<p><span class="math inline">\(\chi^2\)</span><strong>-распределение</strong></p>
<p align="center">
<img src="docs/images/chisq_dist.png" width="100%" style="display: block; margin: auto;" />
</p>
</div>
<div id="выбор-статистического-критерия-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.3</span> Выбор статистического критерия<a href="stats_criteria.html#выбор-статистического-критерия-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Вопросы, которые влияют на выбор статистического теста:</strong></p>
<ol style="list-style-type: decimal">
<li>Зависимая переменная: количественная (интервальная шкала или шкала отношений) или категориальная (номинативная или порядковая шкала)?</li>
<li>Если ЗП количественная – она описывается параметрическим (чаще всего нормальным) распределением? <em>(определяется чаще “на глаз” по графику плотности вероятности или QQ-графиками, тесты на нормальность почти всегда будут давать негативный результат из-за чувствительности и поэтому в современном анализе данных используются мало – <a href="stats_criteria.html#param_nonparam">подробнее чуть ниже</a>)</em></li>
<li>Сколько независимых переменных?</li>
<li>НП количественные (интервальная и шкала отношений) или категориальные (номинативная и порядковая)?</li>
<li>Если НП категориальные и мы сравниваем группы – данные в группах зависимы или нет? Если нет, как сильно отличаются данные в группах, можем ли сказать, что дисперсия ЗП примерно одинакова в группах или нет? (<em>равенство дисперсий называется Homogeneity of Variance, проверяется с помощью Levene’s test</em>)</li>
</ol>
<p>Есть большое количество схем, но обычно они сильно перегруженны и сложны в использовании, больше путают, чем помогают.</p>
<p>Но я зачем-то все равно решила попробовать нарисовать свою, и вот результат:
<a href="https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470" class="uri">https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470</a> (будет обновляться)</p>
<p align="center">
<img src="docs/images/stats_cr_scheme.png" width="100%" style="display: block; margin: auto;" />
</p>
<div id="param_nonparam" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.3.1</span> Параметрические и непараметрические критерии<a href="stats_criteria.html#param_nonparam" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>В списке вопросов, которые влияют на выбор статистического критерия, вторым пунктом идет вопрос о параметрике. Что это значит?</p>
<p>Под <strong>параметрическими</strong> распределением имеется в виду любое распределение, которое можно описать законом. Вспоминаем: закон распределения – это формула, по которой можем привести любому числу вероятность встретить такое значение в природе (разбирали это в теме про <a href="distributions.html#distributions">распределения</a> ). В этой формуле есть параметры – неизвестные переменные, которые мы стремимся узнать. Для нормально распределения это среднее генерально совокупности (математическое ожидание) и стандартное отлокнение генеральной совокупности. Посмотрим еще раз на формулу нормального распределения и найдем их:
<span class="math inline">\(P(x) = \frac{e^{-(x - \mu)^{2}/(2\sigma^{2}) }} {\sigma\sqrt{2\pi}}\)</span></p>
<p>Вспомним еще, что признаки, которые мы исследуем в психологических исследованиях, являются в основном <a href="probability.html#random-variable">случайными величинами</a>, а при большом объеме данных случайные величины, согласно <a href="normdist.html#ctt">центральной предельной теореме</a>, распределены нормально. Поэтому в исследования психологических признаков под параметрическим распределением обычно имеется в виду одно конкретное распределение – <strong>нормальное</strong>.</p>
<p>Если переменная, которая выражает исследуемый признак, распределена нормально, то мы можем применять для ее изучения параметрические статистические критерии, предполагающие нормальное распределение данных: т-тест, ANOVA. Если переменная распределна не нормально, то нужно использовать их непараметрические аналоги: тест Манна-Уитни или Вилкоксона, тест Краскела-Уоллиса.</p>
<p>Проверка на нормальность – довольно устоявшаяся в алгоритме проверки гипотез рутина. Но есть один нюанс.</p>
<ol style="list-style-type: decimal">
<li>При малом объеме данных сложно понять, как распределены данные, нормально или нет.</li>
<li>При большой объеме данных любое, даже малейшее отклонение от нормального распределения будет значимым.</li>
</ol>
<p>Поэтому в современной культуре исследований проверке на нормальность уже не отводится такое сакральное значение. Важнее, например, оперировать размером выборки: если она достаточно большая (можем вернуться к эмприческому правилу к n &gt;= 30), то достаточно взлянуть на распределение данных и QQ-plot, и если они не вызывают подозрений, смело использовать параметрические методы. Если выборка маленькая или если данные при большой выборке явно сильно отличаются от колоколообразной гауссианы, то лучше использовать a) непараметрические аналоги б) обобщенные линейные модели (про них поговорим позже).</p>
<p>Итак, я бы не рекомендовала делать тщательную проверку на нормальность вроде теста Колмогорова-Смирноова или Шапиро-Улика (хотя можно их считать, это не возбраняется), а оценить принадлежность к параметрическому (в данном случае нормальному) распределению следующим образом:</p>
<ol style="list-style-type: decimal">
<li>График плотности вероятности или гистограмма: симметричность и эксцесс <a href="descriptives.html#descriptive_vis">обсуждали их тут</a></li>
<li>QQ-plot</li>
</ol>
<p align="center">
<img src="docs/images/parametric_assumptions.png" width="70%" style="display: block; margin: auto;" />
Графики из книжки Энди Филда “Discovering Statistics Using R”
</p>
<p>Верхняя строка графиков показывает, как могут выглядить графики в случае близкого к норрмальному распределению: гистограмма или график плотности вероятности зависимой переменной похож на колоколообразную гауссиану, на QQ-плоте теоретические квартили почти соответствую фактическим на данных – чем больше этот график похож на прямую линию y = x, тем лучше.</p>
<p>Нижняя строка графиков показывает обратную историю, как могут выглядить визуализации распределения ЗП, которую мы НЕ будем считать нормально распределенной: график плотности и вероятности и гистограмма сильно скошенны влево, QQ-плот уже мало похож на прямую.</p>
</div>
<div id="зависимые-и-независимые-выборки" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.3.2</span> Зависимые и независимые выборки<a href="stats_criteria.html#зависимые-и-независимые-выборки" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Еще один пункт при выборе статистического критерия – это зависимые у нас наблюдения или нет. Мы обсуждали <a href="sample.html#dependent_samples">зависимые и независимые выборки вначале</a>. Теперь это знание пригодится нам, чтобы правильно подбирать статистический метод.</p>
<p align="center">
<img src="docs/images/samples.png" width="100%" style="display: block; margin: auto;" />
</p>
</div>
</div>
<div id="ttest" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.4</span> T-тест (сравнение средних двух групп)<a href="stats_criteria.html#ttest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Первым из статистических критериев мы рассмотрим один из самых простых вариантов – т-тест.</p>
<p>Это статистический критерий, распределение которого относится к семейству Т-распределений – очень похоже на нормальное, но с более приподнятыми хвостами. Используется для сравнения средних двух групп, измеренных в метрической (количественной) шкале. Для остальных шкал т-тест не подходит <em>(хотя признаки, измеренные по шкале Лайкерта, например, по шкале от 1 до 5, иногда могут приписываться к количественным измерениям, но в рамках этого курса мы не будем это затрагивать)</em></p>
<p>Нулевая и альтернативная гипотезы:</p>
<p align="center">
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2\)</span>
</p>
<p align="center">
<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu_1 \neq \mu_2\)</span>
</p>
<p>Вернемся к данным про студентов и нашим вопросам и разберем теперь следующий вопрос:</p>
<blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Отличается ли статистически значимо средний балл по математике у тех, кто чаще или реже пропускает занятия?</li>
</ol>
</blockquote>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table>
<thead>
<tr>
<th style="text-align:left;">
student
</th>
<th style="text-align:left;">
school
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
address
</th>
<th style="text-align:left;">
famsize
</th>
<th style="text-align:left;">
Pstatus
</th>
<th style="text-align:right;">
Medu
</th>
<th style="text-align:right;">
Fedu
</th>
<th style="text-align:left;">
Mjob
</th>
<th style="text-align:left;">
Fjob
</th>
<th style="text-align:left;">
reason
</th>
<th style="text-align:left;">
guardian
</th>
<th style="text-align:right;">
traveltime
</th>
<th style="text-align:right;">
studytime
</th>
<th style="text-align:right;">
failures
</th>
<th style="text-align:left;">
schoolsup
</th>
<th style="text-align:left;">
famsup
</th>
<th style="text-align:left;">
paid_mat
</th>
<th style="text-align:left;">
activities
</th>
<th style="text-align:left;">
nursery
</th>
<th style="text-align:left;">
higher
</th>
<th style="text-align:left;">
internet
</th>
<th style="text-align:left;">
romantic
</th>
<th style="text-align:right;">
famrel
</th>
<th style="text-align:right;">
freetime
</th>
<th style="text-align:right;">
goout
</th>
<th style="text-align:right;">
Dalc
</th>
<th style="text-align:right;">
Walc
</th>
<th style="text-align:right;">
health
</th>
<th style="text-align:right;">
absences_mat
</th>
<th style="text-align:right;">
G1_mat
</th>
<th style="text-align:right;">
G2_mat
</th>
<th style="text-align:right;">
G3_mat
</th>
<th style="text-align:left;">
paid_por
</th>
<th style="text-align:right;">
absences_por
</th>
<th style="text-align:right;">
G1_por
</th>
<th style="text-align:right;">
G2_por
</th>
<th style="text-align:right;">
G3_por
</th>
<th style="text-align:right;">
G_mat
</th>
<th style="text-align:right;">
G_por
</th>
<th style="text-align:left;">
absences_mat_groups
</th>
<th style="text-align:left;">
absences_por_groups
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
id1
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
at_home
</td>
<td style="text-align:left;">
teacher
</td>
<td style="text-align:left;">
course
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.666667
</td>
<td style="text-align:right;">
7.333333
</td>
<td style="text-align:left;">
middle
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id2
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
at_home
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
course
</td>
<td style="text-align:left;">
father
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.333333
</td>
<td style="text-align:right;">
10.333333
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id4
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
health
</td>
<td style="text-align:left;">
services
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14.666667
</td>
<td style="text-align:right;">
14.000000
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id5
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
father
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
8.666667
</td>
<td style="text-align:right;">
12.333333
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id6
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
LE3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
services
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
reputation
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
15.000000
</td>
<td style="text-align:right;">
12.333333
</td>
<td style="text-align:left;">
middle
</td>
<td style="text-align:left;">
middle
</td>
</tr>
<tr>
<td style="text-align:left;">
id7
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
LE3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
11.666667
</td>
<td style="text-align:right;">
12.666667
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id8
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
teacher
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
5.666667
</td>
<td style="text-align:right;">
12.000000
</td>
<td style="text-align:left;">
middle
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id9
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
LE3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
services
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
17.666667
</td>
<td style="text-align:right;">
16.000000
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id10
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
14.666667
</td>
<td style="text-align:right;">
12.333333
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id11
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
teacher
</td>
<td style="text-align:left;">
health
</td>
<td style="text-align:left;">
reputation
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
9.000000
</td>
<td style="text-align:right;">
14.000000
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
</tbody>
</table>
</div>
<p>Мы уже <a href="inference.html#variables">обсуждали в предыдущей главе</a>, что ЗП здесь – средний балл по математике (колонка <code>G_mat</code>), НП – количество пропусков занятий по этом предмету (<code>absences_mat</code>). И ЗП, и НП – количественные, закодированы в шкале отношений. Значит, можем пользоваться той веткой статистических тестов, которая подходит для количественных ЗП.</p>
<p>Пройдем по алгоритму выбора статистического теста: <a href="https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470" class="uri">https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470</a></p>
<p>Помимо основных отраженных ответвлений, видим, что для каждого критерия существует ряд допущений.</p>
<p><strong>Допущения (assumptions)</strong> – это утверждения про характер наших данных, без соблюдения которых параметрические тесты будут работать некорректно (поэтому их никто и не любит).</p>
<div id="допущения-для-т-теста" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.4.1</span> Допущения для т-теста<a href="stats_criteria.html#допущения-для-т-теста" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Данные распределены нормально (или, если измеряемый признак является случайной велиичной, в группах больше 30 наблюдений) – обсуждали эту проверку <a href="stats_criteria.html#param_nonparam">здесь</a></li>
<li>Дисперсии однородны (гомогенны) – проверяется с помощью теста Ливеня (Homogeneity of Variance test, он же Levene’s test).</li>
</ol>
</div>
<div id="непараметрические-аналоги" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.4.2</span> Непараметрические аналоги<a href="stats_criteria.html#непараметрические-аналоги" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>В случае, если допущения нормальности и однородности дисперсий нарушаются, мы не можем использовать т-тест.</p>
<p align="center">
<img src="docs/images/scheme-t-tests.png" width="70%" style="display: block; margin: auto;" />
</p>
</div>
<div id="независимые-и-парные-тесты" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.4.3</span> Независимые и парные тесты<a href="stats_criteria.html#независимые-и-парные-тесты" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Тут тоже все довольно просто:</p>
<ul>
<li>Если у нас независимые выборки, то мы используем независмый т-тест или его непараметрический аналог – тест Манна-Уитни.</li>
<li>Если выборки зависимые, то мы используем парный т-тест или его непараметрический аналог – тест Вилкоксона.</li>
</ul>
<p>Обилие наименований может быть пугающим, но по сути, это один и тот же тест с небольшими поправками – просто в разных названиях увековечено больше статистиков!</p>
</div>
<div id="вычисление-т-теста-и-непараметрических-аналогов" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.4.4</span> Вычисление т-теста и непараметрических аналогов<a href="stats_criteria.html#вычисление-т-теста-и-непараметрических-аналогов" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Средний балл и стандартное отклонение в группах тех, кто прогуливает меньше всего (на паре мы назвали их прихожанами):</p>
<pre><code>## # A tibble: 1 x 3
##    mean    sd     n
##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1  11.2  3.70   207</code></pre>
<p>Средний балл в группах прогулищиков:</p>
<pre><code>## # A tibble: 1 x 3
##    mean    sd     n
##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1  10.2  3.52    22</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="stats_criteria.html#cb3-1"></a>students <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-2"><a href="stats_criteria.html#cb3-2"></a><span class="st">  </span><span class="kw">filter</span>(absences_mat_groups <span class="op">!=</span><span class="st"> &quot;middle&quot;</span>) -&gt;<span class="st"> </span>students_<span class="dv">2</span></span>
<span id="cb3-3"><a href="stats_criteria.html#cb3-3"></a></span>
<span id="cb3-4"><a href="stats_criteria.html#cb3-4"></a><span class="kw">t.test</span>(students_<span class="dv">2</span><span class="op">$</span>G_mat <span class="op">~</span><span class="st"> </span>students_<span class="dv">2</span><span class="op">$</span>absences_mat_groups, <span class="dt">paired =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  students_2$G_mat by students_2$absences_mat_groups
## t = 1.2839, df = 26.204, p-value = 0.2104
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.6112609  2.6475660
## sample estimates:
## mean in group less mean in group more 
##           11.23027           10.21212</code></pre>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="anova-дисперсионный-анализ" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.5</span> ANOVA (дисперсионный анализ)<a href="stats_criteria.html#anova-дисперсионный-анализ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>ANOVA (ANalysis Of VAriance)</strong> – статистический критерий, распределение и ключевая статистика которого относятся к семейству F-распределений. Это то чуть скошенное влево распределение, уже сильно отличающееся от нормального. На этом распределении мы (точнее специально обученные программы) будут располагать F-значение, которое будет вычисляться. Этот критерий используется, когда зависимая переменная (ЗП) измерена в метрической (количественной) шкале, а независимые переменные (НП) – категориальные (порядковые или номинативные). ANOVA применяется, когда число проводимых сравниваемых становится больше двух – то есть, либо это одна НП, которая может принимать три значения (уровня), либо число НП больше или равно двум.</p>
<p><strong>ANOVA используется тогда, когда число сравнений, которые нам нужно сделать, становится больше двух</strong>. Можно сделать и два сравнения с помощью ANOVA, но это будет бессмысленно, так как по сути это старый добрый т-тест.</p>
<p>Нулевая и альтернативные гипотеза для ANOVA:</p>
<p align="center">
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2 = ... =\mu_n\)</span>
</p>
<p align="center">
<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu_1 \neq \mu_2 \neq ... \neq \mu_n\)</span>
</p>
<p>Как вообще получается, что нам нужно сделать больше двух сравнений?</p>
<div id="levels" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.1</span> Факторы и уровни<a href="stats_criteria.html#levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Фактором</strong> или <strong>предиктором</strong> в линейных моделях и дисперсионном анализе называется независимая переменная.</p>
<p>Как правило, мы применяем ANOVA для сравнения групп, поэтому эта независимая переменная – категориальная, она принимает конечное число значений. Значений НП – это те группы, которые мы сравниваем между собой, они называются <strong>уровнями НП или уровнями фактора</strong>.</p>
<p align="center">
<img src="docs/images/levels.png" width="70%" style="display: block; margin: auto;" />
</p>
<p>В зависимости от числа НП и уровней НП можно конкретизировать экспериментальный план и план для ANOVA:</p>
<p align="center">
<img src="docs/images/factors_levels.png" width="100%" style="display: block; margin: auto;" />
</p>
</div>
<div id="почему-он-дисперсионный" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.2</span> Почему он дисперсионный<a href="stats_criteria.html#почему-он-дисперсионный" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Чтобы перейти к непосредственно анализу, надо немного разобраться, что это воообще за метод, и почему он называется дисперсионным, хотя предположения мы строим, как и в большинстве статистических критериев, относительно средних значений по группам. Дело в том, что этот метод действительно учитывает дисперсию, а точнее, разницу дисперсий. Математика ANOVA основана на том, что при объединении нескольких выборок с примерно одинаковой дисперсией, но разными средним, дисперсия увеличивается пропорционально средним этих значений. Это связано с тем, что всю дисперсию можно разделить на межгрупповую и внутригрупповую. Если окажется, что дисперсия между группами больше, чем внутри, то можно сделать вывод в пользу различий между группами. Для того, чтобы зафиксировать различия между группами, внутригрупповая дисперсия здесь должна быть как можно меньше: чем она меньше внутри групп и больше между групп, тем более серьезный вывод об отличиях групп мы сможем сделать.</p>
<p>F-значение считается, по сути, как отношение дисперсий двух групп.</p>
<p>В качесте дисперсии для математики ANOVA обычно берется только ее числитель, без деления на число элементов в группе (<a href="descriptives.html#varm">а саму дисперсию мы считали здесь</a>. Числитель дисперсии без знаменателя – <strong>это сумма квадратов (Sum of Squares)</strong></p>
<p align="center">
<span class="math inline">\(D = \frac{\sum_{i=1}^{n} (x_i - \overline{x})^2}{n}\)</span>
</p>
<p>Заодно вспомним, что стандартное отклонение – это корень из дисперсии:</p>
<p align="center">
<span class="math inline">\(\sigma = \frac{\sum_{i=1}^{n} (x_i - \overline{x})}{\sqrt{n}}\)</span>
</p>
<p>А сумма кавдратов – это числитель дисперсии, SST (Sum of Squares Total):</p>
<p align="center">
<span class="math inline">\(SST = \sum_{i=1}^{n} (x_i - \overline{x})^2\)</span>
</p>
<p>Общая сумма квадратов SST складывается из <strong>межгрупповой</strong> суммы квадратов (SSE, Sum of Squares Explained или SSB, Sum of Squares Between groups) и <strong>внутригрупповой</strong> (SSR, Sum of Squares Random или SSW, Sum of Squares Within groups)</p>
<p align="center">
<img src="docs/images/anova_SS.jpg" width="70%" style="display: block; margin: auto;" />
</p>
<p align="center">
<span class="math inline">\(SST = SSE + SSR\)</span>
</p>
<p>Предположим, что у нас есть m групп по n наблюдений в каждой из них (для простоты возьмем равные по численности группы).
Тогда общая сумма квадратов (дисперсия без знаменателя) равна:</p>
<p align="center">
<span class="math inline">\(SST = \sum_{i=1}^{m \times n} (x_i - \bar x)^2\)</span>
</p>
<p>Как вычислить межгрупповую и внутригрупповую сумму квадратов?</p>
<p align="center">
<span class="math inline">\(SSE = \sum_{j=1}^m (\bar x_j - \bar x)^2\)</span>
</p>
<p align="center">
<span class="math inline">\(df_{SSE} = m-1\)</span>, m – количество групп
</p>
<p align="center">
<span class="math inline">\(SSR = \sum_{j=1}^m\sum_{i=1}^n (x_{ij} - \bar x_j)^2\)</span>
</p>
<p align="center">
<span class="math inline">\(df_{SSR} = m \times n - m\)</span>, n – количество элементов во группе, m – число групп
</p>
<p>Желаемый результат здесь – наименьшее значение SSR (внутригрупповой) и наибольшее SSE (межгрупповой).</p>
<p>Отсюда логически вытекает один из важных показателей для интпреретации результатов ANOVA:</p>
<p align="center">
<span class="math inline">\(R^2 = \frac{SSE}{SST}\)</span> – процент объясненной факторами дисперсии (коэффициент детерминации), то есть то, насколько хорошо наши факторы объясняют изменчивость данных.
</p>
<p>А до подсчета F-значения остается один шаг – посчитать средние суммы квадратов, то есть поделить их на число степененй свобооды для каждой суммы квадратов (точно так же, как мы делили дисперсию на число наблюдений! Возвращаемся к ее смыслу)</p>
<p align="center">
<span class="math inline">\(MSE = \frac{SSE}{df_{SSE}} = \frac{SSE}{m-1}\)</span>
</p>
<p align="center">
<span class="math inline">\(MSR = \frac{SSR}{df_{SSR}} = \frac{SSR}{m \times n - m}\)</span>
</p>
<p>И можем посчитать F-значение, которое будем располагать на F-распределении (напомню, что за нас обычно это делают специально обученные машины)</p>
<p align="center">
<span class="math inline">\(F = \frac{MSE}{MSR} = \frac{SSE \times (m \times n - m)}{(m-1) \times SSR}\)</span>
</p>
</div>
<div id="f-распределение-фишера" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.3</span> F-распределение (Фишера)<a href="stats_criteria.html#f-распределение-фишера" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p align="center">
<img src="docs/images/F-dist.png" width="70%" style="display: block; margin: auto;" />
</p>
<p>F-распределение или распределение Фишера – это распределение величины, которая высчитывается как отношение средних квадратов внутригрупповой и межгрупповой изменчивости (очень похоже на дисперсию) и включает туда рассчитанное количество степеней свободы для внутригрупповой и межгрупповой изменчивости. При очень большой выборке, большом значении степеней свободы, оно тоже будет походить на нормальное!</p>
<p>При малом числе степеней свободы (малой выборке) F-распределение визуально отличается от нормального – но для проверки допущения это не имеет никакого значения, так как это распределение F-статистик, а не зависимой переменной – к ним все еще действует допущение о нормальности или большог ообъема выборки.</p>
</div>
<div id="допущения-для-anova" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.4</span> Допущения для ANOVA<a href="stats_criteria.html#допущения-для-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Пройдем по алгоритму выбора статистического теста: <a href="https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470" class="uri">https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470</a></p>
<p>Помимо основных отраженных ответвлений, для каждого критерия существует ряд допущений.</p>
<p>Допущения (assumptions) – это утверждения про характер наших данных, без соблюдения которых параметрические тесты будут работать некорректно (поэтому их никто и не любит).</p>
<ol style="list-style-type: decimal">
<li>Данные распределены нормально (или, если измеряемый признак является случайной велиичной, в группах больше 30 наблюдений) – обсуждали эту проверку <a href="stats_criteria.html#param_nonparam">здесь</a></li>
<li>Если независимые – дисперсии однородны (гомогенны), проверяется с помощью теста Левеня (Levene’s Test of Homogeneity of Variance), если зависимые группы – сферичность дисперсий, проверяется с помощью теста на сферичноость (Sphericity test, Mauchly test)</li>
</ol>
</div>
<div id="непараметрические-аналоги-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.5</span> Непараметрические аналоги<a href="stats_criteria.html#непараметрические-аналоги-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>В случае, если допущения нормальности (помним, что это скорее про большое число наблюдений в выборке и визуально значительное отличие от гауссианы) и однородности дисперсий нарушаются, мы не можем использовать ANOVA, и нужно использовать непараметрические аналоги .</p>
<p align="center">
<img src="docs/images/anova-tests.png" width="70%" style="display: block; margin: auto;" />
</p>
</div>
<div id="просто-anova-и-с-повторными-измерениями" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.6</span> Просто ANOVA и с повторными измерениями<a href="stats_criteria.html#просто-anova-и-с-повторными-измерениями" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Тут тоже все довольно просто:</p>
<ul>
<li>Если у нас независимые выборки, то мы используем ANOVA или его непараметрический аналог – тест Краскелла-Уоллиса.</li>
<li>Если выборки зависимые, то мы используем ANOVA c повторными измерениями (repeated measures) или его непараметрический аналог – тест Фридмана.</li>
</ul>
<p>Обилие наименований может быть пугающим, но по сути, это один и тот же тест с небольшими поправками – просто в разных названиях увековечено больше статистиков!</p>
</div>
<div id="нелинейные-эффекты" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.7</span> Нелинейные эффекты<a href="stats_criteria.html#нелинейные-эффекты" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Большое преимущество в сравнении трех и более групп – такие сравнения позволяют выявить нелинейные эффекты.</p>
<p align="center">
<img src="docs/images/nonlinear.png" width="80%" style="display: block; margin: auto;" />
</p>
</div>
<div id="multiple_anova" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.8</span> Многофкторый ANOVA и взаимодействие факторов<a href="stats_criteria.html#multiple_anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Многофакторный ANOVA – тот же ANOVA, только когда у нас больше одной <a href="stats_criteria.html#levels">независимой переменной (фактора)</a>. Многофакторный ANOVA обычно обозначается примерно так: <span class="math inline">\(ANOVA \ 2 \times 3\)</span> – это значит, что у нас два фактора, 2 уровня в первом фактора и 3 уровня во втором.</p>
<p>Многофакторный ANOVA интересен тем, что позволяет изучать еще и взаимодействие этих НП. Нелийность одного фактора может накладываться на нелинейность другого, или эффект фактора может проявиться только в определенных специальных условиях – за этим нужен многофакторный дизайн. Например, мы исследуем ту же концентрацию кофеина на внимание, даем испытуемым выпить 1 или 2 кружки кофе, а еще хотим поизучать этот эффект в зависимости от времени суток, в которое испытуемые выписывают кофе. Может оказаться, что эффект кофеина на внимание растет с увеличением концентрации кофе, но это происходит только в утренние часы – а в вечернее время не обнаруживается разница во внимании, 1 и 2 кружки кофе действует абсолютно оодинаково. Это назвается взаимодействием фактором и проявляется, когда у нас в исследовании 2 и более НП.</p>
<p>Визуально взаимодействие проявляется так: если нарисовать график зависимой переменной от одного из факторов и поместить на этот график линию, соответствующую другому фактору, то если линии окажутся не параллельны – то можно говорить о наличии взаимодействия.</p>
<p align="center">
<img src="docs/images/anova_interaction1.jpg" width="80%" style="display: block; margin: auto;" />
Картинка <embed src="https://angelgardt.github.io/SFDA2022/book/twoway-anova.html#factor_interaction" />
</p>
<p>В случае нескольких факторов (независимых переменных), расчет и логика применения ANOVA точно такие же, добавляется только еще один фактор и взаимодействие первогоо фактора со вторым:</p>
<p align="center">
<span class="math inline">\(SST = SSE_{factor1} + SSE_{factor2} + SSE_{factor1} \times SSE_{factor2} +SSR\)</span>
</p>
</div>
<div id="пост-хоки-и-множественные-сравнения" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.9</span> Пост-хоки и множественные сравнения<a href="stats_criteria.html#пост-хоки-и-множественные-сравнения" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Допустим, мы провели ANOVA (любой из его видов), сравнили полученное p-значение с <span class="math inline">\(\alpha\)</span>, и оказалось, что p-значение &lt; <span class="math inline">\(\alpha\)</span>, и мы можем отвергнуть нулевую гипотезу <span class="math inline">\(H_0\)</span> в пользу альтернативной <span class="math inline">\(H_1\)</span>. Значит ли это, что отличаются средние во всех группах? Или может быть так, что <span class="math inline">\(\mu_1 = \mu_2\)</span> и <span class="math inline">\(\mu_1 \neq \mu_3\)</span>? Может.</p>
<p>ANOVA говорит, что в каких-то группах есть значимые отличия между средними, но не говорит, в каких именно. А чтобы узнать, в каких группах есть значимые отличия, нужно провести серию пост-хок (post hoc), апостериорных тестов. Это просто попарные т-тесты (<a href="stats_criteria.html#ttest">разбирали их здесь</a>) для сравнения каждого уровня НП с каждым, но уже с <strong>поправкой на множественные сравнения</strong>.</p>
<p>Что это за поправки? Они нужны нам, чтобы ибежать увеличения ошибки первого рода. Оказывается, что если мы на оодних и тех же данных будем тестировать несколько гипотез, то вероятность случайно получить статистически значимые различия будет увеличиваться пропорционально количеству тестируемых гипотез, то есть сделанных сравнений! Это происхоодит потому, что нарушается важное предположение о независимости наших выводов.</p>
<p>И вероятность сделать ложноположительный вывод будет уже никак не 0.05, а гораздо больше. Чтобы этого избежать, вводятся поправки на множественные сравнения, которые корректируют уровень <span class="math inline">\(\alpha\)</span> и занижают его.</p>
<p>Самые популярные поправки:</p>
<ul>
<li>Бонферонни</li>
<li>Тьюки</li>
<li>FDR</li>
</ul>
<p>Попарные пост-хок тесты нужны, когда результаты ANOVA оказались значимыми – это следующий шаг, чтобы разобраться, какие именно уровни факторов или их взаимодействия внесли значимость. Если ANOVA не значим, то последующие попарные сравнения не нужны – у нас совсем ничего не значимо (вспоминаем, что нулевой гипотезой для ANOVA является наличие хотя бы одного отличающегося среднего), так что и сравнивать нечего.</p>
</div>
<div id="вычисление-anova-и-непараметрических-аналогов" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.5.10</span> Вычисление ANOVA и непараметрических аналогов<a href="stats_criteria.html#вычисление-anova-и-непараметрических-аналогов" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Посмотрим опять на данные и поисследуем зависимость балла по математике от того, живут ли студенты в городах (переменная <code>address</code> значение U (urban)) или деревнях (переменная <code>address</code> значение R).</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table>
<thead>
<tr>
<th style="text-align:left;">
student
</th>
<th style="text-align:left;">
school
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
address
</th>
<th style="text-align:left;">
famsize
</th>
<th style="text-align:left;">
Pstatus
</th>
<th style="text-align:right;">
Medu
</th>
<th style="text-align:right;">
Fedu
</th>
<th style="text-align:left;">
Mjob
</th>
<th style="text-align:left;">
Fjob
</th>
<th style="text-align:left;">
reason
</th>
<th style="text-align:left;">
guardian
</th>
<th style="text-align:right;">
traveltime
</th>
<th style="text-align:right;">
studytime
</th>
<th style="text-align:right;">
failures
</th>
<th style="text-align:left;">
schoolsup
</th>
<th style="text-align:left;">
famsup
</th>
<th style="text-align:left;">
paid_mat
</th>
<th style="text-align:left;">
activities
</th>
<th style="text-align:left;">
nursery
</th>
<th style="text-align:left;">
higher
</th>
<th style="text-align:left;">
internet
</th>
<th style="text-align:left;">
romantic
</th>
<th style="text-align:right;">
famrel
</th>
<th style="text-align:right;">
freetime
</th>
<th style="text-align:right;">
goout
</th>
<th style="text-align:right;">
Dalc
</th>
<th style="text-align:right;">
Walc
</th>
<th style="text-align:right;">
health
</th>
<th style="text-align:right;">
absences_mat
</th>
<th style="text-align:right;">
G1_mat
</th>
<th style="text-align:right;">
G2_mat
</th>
<th style="text-align:right;">
G3_mat
</th>
<th style="text-align:left;">
paid_por
</th>
<th style="text-align:right;">
absences_por
</th>
<th style="text-align:right;">
G1_por
</th>
<th style="text-align:right;">
G2_por
</th>
<th style="text-align:right;">
G3_por
</th>
<th style="text-align:right;">
G_mat
</th>
<th style="text-align:right;">
G_por
</th>
<th style="text-align:left;">
absences_mat_groups
</th>
<th style="text-align:left;">
absences_por_groups
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
id1
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
at_home
</td>
<td style="text-align:left;">
teacher
</td>
<td style="text-align:left;">
course
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.666667
</td>
<td style="text-align:right;">
7.333333
</td>
<td style="text-align:left;">
middle
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id2
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
at_home
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
course
</td>
<td style="text-align:left;">
father
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.333333
</td>
<td style="text-align:right;">
10.333333
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id4
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
health
</td>
<td style="text-align:left;">
services
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14.666667
</td>
<td style="text-align:right;">
14.000000
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id5
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
father
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
8.666667
</td>
<td style="text-align:right;">
12.333333
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id6
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
LE3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
services
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
reputation
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
15.000000
</td>
<td style="text-align:right;">
12.333333
</td>
<td style="text-align:left;">
middle
</td>
<td style="text-align:left;">
middle
</td>
</tr>
<tr>
<td style="text-align:left;">
id7
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
LE3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
11.666667
</td>
<td style="text-align:right;">
12.666667
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id8
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
teacher
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
5.666667
</td>
<td style="text-align:right;">
12.000000
</td>
<td style="text-align:left;">
middle
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id9
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
LE3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
services
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
17.666667
</td>
<td style="text-align:right;">
16.000000
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id10
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
home
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
14.666667
</td>
<td style="text-align:right;">
12.333333
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
<tr>
<td style="text-align:left;">
id11
</td>
<td style="text-align:left;">
GP
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
GT3
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
teacher
</td>
<td style="text-align:left;">
health
</td>
<td style="text-align:left;">
reputation
</td>
<td style="text-align:left;">
mother
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
9.000000
</td>
<td style="text-align:right;">
14.000000
</td>
<td style="text-align:left;">
less
</td>
<td style="text-align:left;">
less
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="stats_criteria.html#cb5-1"></a><span class="kw">library</span>(<span class="st">&quot;ez&quot;</span>)</span>
<span id="cb5-2"><a href="stats_criteria.html#cb5-2"></a>model_abs_mat_ez =<span class="st"> </span><span class="kw">ezANOVA</span>(<span class="dt">data =</span> students, <span class="dt">dv =</span> G_mat, <span class="dt">wid =</span> student,</span>
<span id="cb5-3"><a href="stats_criteria.html#cb5-3"></a>                           <span class="dt">between =</span> absences_mat_groups)</span>
<span id="cb5-4"><a href="stats_criteria.html#cb5-4"></a>model_abs_mat_ez</span></code></pre></div>
<pre><code>## $ANOVA
##                Effect DFn DFd         F         p p&lt;.05         ges
## 1 absences_mat_groups   2 317 0.8568567 0.4254751       0.005376968
## 
## $`Levene&#39;s Test for Homogeneity of Variance`
##   DFn DFd      SSn      SSd        F         p p&lt;.05
## 1   2 317 11.28622 1450.235 1.233501 0.2926653</code></pre>
<p>Еще хорошую и более поробную главу (даже две) про ANOVA написал мой друг и коллега Антон Ангельгардт, если интересно углубиться, можно почитать его материал.
<a href="https://angelgardt.github.io/SFDA2022/book/oneway-anova.html" class="uri">https://angelgardt.github.io/SFDA2022/book/oneway-anova.html</a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="stats_criteria.html#cb7-1"></a>model_address_mat_ez =<span class="st"> </span><span class="kw">ezANOVA</span>(<span class="dt">data =</span> students, <span class="dt">dv =</span> G_mat, <span class="dt">wid =</span> student,</span>
<span id="cb7-2"><a href="stats_criteria.html#cb7-2"></a>                           <span class="dt">between =</span> address)</span>
<span id="cb7-3"><a href="stats_criteria.html#cb7-3"></a>model_address_mat_ez</span></code></pre></div>
<pre><code>## $ANOVA
##    Effect DFn DFd        F          p p&lt;.05        ges
## 1 address   1 318 6.013395 0.01473483     * 0.01855909
## 
## $`Levene&#39;s Test for Homogeneity of Variance`
##   DFn DFd       SSn      SSd         F         p p&lt;.05
## 1   1 318 0.8014323 1412.745 0.1803973 0.6713193</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="stats_criteria.html#cb9-1"></a>students <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="stats_criteria.html#cb9-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>absences_mat_groups, <span class="dt">y =</span> G_mat)) <span class="op">+</span></span>
<span id="cb9-3"><a href="stats_criteria.html#cb9-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> absences_mat_groups)) <span class="op">+</span></span>
<span id="cb9-4"><a href="stats_criteria.html#cb9-4"></a><span class="st">  </span><span class="co"># scale_fill_viridis(discrete=TRUE) +</span></span>
<span id="cb9-5"><a href="stats_criteria.html#cb9-5"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="stats_criteria.html#cb10-1"></a>students <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="stats_criteria.html#cb10-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>absences_mat_groups, <span class="dt">y =</span> G_mat)) <span class="op">+</span></span>
<span id="cb10-3"><a href="stats_criteria.html#cb10-3"></a><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> absences_mat_groups)) <span class="op">+</span></span>
<span id="cb10-4"><a href="stats_criteria.html#cb10-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> absences_mat_groups), <span class="dt">width=</span>.<span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb10-5"><a href="stats_criteria.html#cb10-5"></a><span class="st">  </span><span class="co"># scale_fill_viridis(discrete=TRUE) +</span></span>
<span id="cb10-6"><a href="stats_criteria.html#cb10-6"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="StatsForDA_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StatsForDA.pdf", "StatsForDA.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
